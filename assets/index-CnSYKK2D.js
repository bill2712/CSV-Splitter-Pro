(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Vi={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Hi,qi;function zi(){return{geminiUrl:Hi,vertexUrl:qi}}function Oi(t,e,n,o){var i,s;if(!(t!=null&&t.baseUrl)){const l=zi();return e?(i=l.vertexUrl)!==null&&i!==void 0?i:n:(s=l.geminiUrl)!==null&&s!==void 0?s:o}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ue{}function ee(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(o,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function a(t,e,n){for(let s=0;s<e.length-1;s++){const l=e[s];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[u])){const d=t[u];if(Array.isArray(n))for(let c=0;c<d.length;c++){const f=d[c];a(f,e.slice(s+1),n[c])}else for(const c of d)a(c,e.slice(s+1),n)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in t||(t[u]=[{}]);const d=t[u];a(d[0],e.slice(s+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const o=e[e.length-1],i=t[o];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${o}`)}else o==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[o]=n}function r(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let o=0;o<e.length;o++){if(typeof t!="object"||t===null)return n;const i=e[o];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const l=t[s];return Array.isArray(l)?l.map(u=>r(u,e.slice(o+1),n)):n}else return n}else t=t[i]}return t}catch(o){if(o instanceof TypeError)return n;throw o}}function Ji(t,e){for(const[n,o]of Object.entries(e)){const i=n.split("."),s=o.split("."),l=new Set;let u=-1;for(let d=0;d<i.length;d++)if(i[d]==="*"){u=d;break}if(u!==-1&&s.length>u)for(let d=u;d<s.length;d++){const c=s[d];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&l.add(c)}Pt(t,i,s,0,l)}}function Pt(t,e,n,o,i){if(o>=e.length||typeof t!="object"||t===null)return;const s=e[o];if(s.endsWith("[]")){const l=s.slice(0,-2),u=t;if(l in u&&Array.isArray(u[l]))for(const d of u[l])Pt(d,e,n,o+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const l=t,u=Object.keys(l).filter(c=>!c.startsWith("_")&&!i.has(c)),d={};for(const c of u)d[c]=l[c];for(const[c,f]of Object.entries(d)){const h=[];for(const p of n.slice(o))p==="*"?h.push(c):h.push(p);a(l,h,f)}for(const c of u)delete l[c]}}else{const l=t;s in l&&Pt(l[s],e,n,o+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ot(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $i(t){const e={},n=r(t,["operationName"]);n!=null&&a(e,["operationName"],n);const o=r(t,["resourceName"]);return o!=null&&a(e,["_url","resourceName"],o),e}function Wi(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["metadata"]);o!=null&&a(e,["metadata"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);s!=null&&a(e,["error"],s);const l=r(t,["response","generateVideoResponse"]);return l!=null&&a(e,["response"],Yi(l)),e}function Ki(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["metadata"]);o!=null&&a(e,["metadata"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);s!=null&&a(e,["error"],s);const l=r(t,["response"]);return l!=null&&a(e,["response"],Zi(l)),e}function Yi(t){const e={},n=r(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Xi(l))),a(e,["generatedVideos"],s)}const o=r(t,["raiMediaFilteredCount"]);o!=null&&a(e,["raiMediaFilteredCount"],o);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function Zi(t){const e={},n=r(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Qi(l))),a(e,["generatedVideos"],s)}const o=r(t,["raiMediaFilteredCount"]);o!=null&&a(e,["raiMediaFilteredCount"],o);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function Xi(t){const e={},n=r(t,["video"]);return n!=null&&a(e,["video"],ir(n)),e}function Qi(t){const e={},n=r(t,["_self"]);return n!=null&&a(e,["video"],rr(n)),e}function ji(t){const e={},n=r(t,["operationName"]);return n!=null&&a(e,["_url","operationName"],n),e}function er(t){const e={},n=r(t,["operationName"]);return n!=null&&a(e,["_url","operationName"],n),e}function tr(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["metadata"]);o!=null&&a(e,["metadata"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);s!=null&&a(e,["error"],s);const l=r(t,["response"]);return l!=null&&a(e,["response"],nr(l)),e}function nr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["parent"]);o!=null&&a(e,["parent"],o);const i=r(t,["documentName"]);return i!=null&&a(e,["documentName"],i),e}function Ho(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["metadata"]);o!=null&&a(e,["metadata"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);s!=null&&a(e,["error"],s);const l=r(t,["response"]);return l!=null&&a(e,["response"],or(l)),e}function or(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["parent"]);o!=null&&a(e,["parent"],o);const i=r(t,["documentName"]);return i!=null&&a(e,["documentName"],i),e}function ir(t){const e={},n=r(t,["uri"]);n!=null&&a(e,["uri"],n);const o=r(t,["encodedVideo"]);o!=null&&a(e,["videoBytes"],Ot(o));const i=r(t,["encoding"]);return i!=null&&a(e,["mimeType"],i),e}function rr(t){const e={},n=r(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const o=r(t,["bytesBase64Encoded"]);o!=null&&a(e,["videoBytes"],Ot(o));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var on;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(on||(on={}));var rn;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(rn||(rn={}));var sn;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(sn||(sn={}));var Fe;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Fe||(Fe={}));var an;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(an||(an={}));var ln;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(ln||(ln={}));var un;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(un||(un={}));var dn;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(dn||(dn={}));var cn;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(cn||(cn={}));var fn;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(fn||(fn={}));var pn;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(pn||(pn={}));var hn;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(hn||(hn={}));var mn;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(mn||(mn={}));var gn;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(gn||(gn={}));var vn;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(vn||(vn={}));var yn;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(yn||(yn={}));var _n;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(_n||(_n={}));var En;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(En||(En={}));var Tn;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Tn||(Tn={}));var Cn;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Cn||(Cn={}));var Sn;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Sn||(Sn={}));var pt;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(pt||(pt={}));var In;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(In||(In={}));var wn;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(wn||(wn={}));var An;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(An||(An={}));var xt;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(xt||(xt={}));var Rn;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Rn||(Rn={}));var kn;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(kn||(kn={}));var Mt;(function(t){t.COLLECTION="COLLECTION"})(Mt||(Mt={}));var Pn;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Pn||(Pn={}));var xn;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(xn||(xn={}));var Mn;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Mn||(Mn={}));var Nn;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Nn||(Nn={}));var bn;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(bn||(bn={}));var Dn;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Dn||(Dn={}));var Un;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Un||(Un={}));var Ln;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ln||(Ln={}));var Fn;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Fn||(Fn={}));var Gn;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Gn||(Gn={}));var Bn;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Bn||(Bn={}));var Vn;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Vn||(Vn={}));var Hn;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Hn||(Hn={}));var qn;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(qn||(qn={}));var zn;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(zn||(zn={}));var On;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(On||(On={}));var Jn;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(Jn||(Jn={}));var $n;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})($n||($n={}));var Wn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Wn||(Wn={}));var Kn;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Kn||(Kn={}));var Yn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.ACTIVITY_START="ACTIVITY_START",t.ACTIVITY_END="ACTIVITY_END"})(Yn||(Yn={}));var Zn;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Zn||(Zn={}));var Xn;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Xn||(Xn={}));var Qn;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Qn||(Qn={}));var jn;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(jn||(jn={}));var eo;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(eo||(eo={}));var to;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(to||(to={}));var Oe;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Oe||(Oe={}));class Nt{constructor(e){const n={};for(const o of e.headers.entries())n[o[0]]=o[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Qe{get text(){var e,n,o,i,s,l,u,d;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1;const h=[];for(const p of(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[m,T]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(T!==null||T!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,c+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var e,n,o,i,s,l,u,d;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const f=[];for(const h of(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&f.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,n,o,i,s,l,u,d;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,n,o,i,s,l,u,d,c;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,n,o,i,s,l,u,d,c;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(d=(u=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.output}}class no{}class oo{}class sr{}class ar{}class lr{}class ur{}class io{}class ro{}class so{}class dr{}class ht{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new ht;let i;const s=e;return n?i=Ki(s):i=Wi(s),Object.assign(o,i),o}}class ao{}class lo{}class uo{}class co{}class cr{}class fr{}class pr{}class Jt{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new Jt,s=tr(e);return Object.assign(o,s),o}}class hr{}class mr{}class gr{}class fo{}class vr{get text(){var e,n,o;let i="",s=!1;const l=[];for(const u of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[d,c]of Object.entries(u))d!=="text"&&d!=="thought"&&c!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;s=!0,i+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,o;let i="";const s=[];for(const l of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&s.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class yr{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class $t{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new $t,s=Ho(e);return Object.assign(o,s),o}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function me(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function qo(t,e){const n=me(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function zo(t){return Array.isArray(t)?t.map(e=>mt(e)):[mt(t)]}function mt(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Oo(t){const e=mt(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Jo(t){const e=mt(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function po(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function $o(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>po(e)):[po(t)]}function bt(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function ho(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function mo(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Ie(t){if(t==null)throw new Error("ContentUnion is required");return bt(t)?t:{role:"user",parts:$o(t)}}function Wt(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const o=Ie(n);return o.parts&&o.parts.length>0&&o.parts[0].text!==void 0?[o.parts[0].text]:[]});if(t.isVertexAI()){const n=Ie(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Ie(n)):[Ie(e)]}function Pe(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(ho(t)||mo(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ie(t)]}const e=[],n=[],o=bt(t[0]);for(const i of t){const s=bt(i);if(s!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(ho(i)||mo(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return o||e.push({role:"user",parts:$o(n)}),e}function _r(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(o=>o!=="null");if(n.length===1)e.type=Object.values(Fe).includes(n[0].toUpperCase())?n[0].toUpperCase():Fe.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const o of n)e.anyOf.push({type:Object.values(Fe).includes(o.toUpperCase())?o.toUpperCase():Fe.TYPE_UNSPECIFIED})}}function $e(t){const e={},n=["items"],o=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&_r(t.type,e);for(const[l,u]of Object.entries(t))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(Fe).includes(u.toUpperCase())?u.toUpperCase():Fe.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=$e(u);else if(o.includes(l)){const d=[];for(const c of u){if(c.type=="null"){e.nullable=!0;continue}d.push($e(c))}e[l]=d}else if(i.includes(l)){const d={};for(const[c,f]of Object.entries(u))d[c]=$e(f);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=u}return e}function Kt(t){return $e(t)}function Yt(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Zt(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ke(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=$e(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=$e(e.response));return t}function Ye(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Er(t,e,n,o=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===o;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function Le(t,e){if(typeof e!="string")throw new Error("name must be a string");return Er(t,e,"cachedContents")}function Wo(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Be(t){return Ot(t)}function Tr(t){return t!=null&&typeof t=="object"&&"name"in t}function Cr(t){return t!=null&&typeof t=="object"&&"video"in t}function Sr(t){return t!=null&&typeof t=="object"&&"uri"in t}function Ko(t){var e;let n;if(Tr(t)&&(n=t.name),!(Sr(t)&&(n=t.uri,n===void 0))&&!(Cr(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Yo(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function Zo(t){for(const e of["models","tunedModels","publisherModels"])if(Ir(t,e))return t[e];return[]}function Ir(t,e){return t!==null&&typeof t=="object"&&e in t}function wr(t,e={}){const n=t,o={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(o.responseJsonSchema=n.outputSchema),e.behavior&&(o.behavior=e.behavior),{functionDeclarations:[o]}}function Ar(t,e={}){const n=[],o=new Set;for(const i of t){const s=i.name;if(o.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);o.add(s);const l=wr(i,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function Xo(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const o=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||o!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Rr(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Qo(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const l of i){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Ze(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function jo(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kr(t){const e={},n=r(t,["responsesFile"]);n!=null&&a(e,["fileName"],n);const o=r(t,["inlinedResponses","inlinedResponses"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>ls(l))),a(e,["inlinedResponses"],s)}const i=r(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),a(e,["inlinedEmbedContentResponses"],s)}return e}function Pr(t){const e={},n=r(t,["predictionsFormat"]);n!=null&&a(e,["format"],n);const o=r(t,["gcsDestination","outputUriPrefix"]);o!=null&&a(e,["gcsUri"],o);const i=r(t,["bigqueryDestination","outputUri"]);return i!=null&&a(e,["bigqueryUri"],i),e}function xr(t){const e={},n=r(t,["format"]);n!=null&&a(e,["predictionsFormat"],n);const o=r(t,["gcsUri"]);o!=null&&a(e,["gcsDestination","outputUriPrefix"],o);const i=r(t,["bigqueryUri"]);if(i!=null&&a(e,["bigqueryDestination","outputUri"],i),r(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(r(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(r(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ut(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["metadata","displayName"]);o!=null&&a(e,["displayName"],o);const i=r(t,["metadata","state"]);i!=null&&a(e,["state"],jo(i));const s=r(t,["metadata","createTime"]);s!=null&&a(e,["createTime"],s);const l=r(t,["metadata","endTime"]);l!=null&&a(e,["endTime"],l);const u=r(t,["metadata","updateTime"]);u!=null&&a(e,["updateTime"],u);const d=r(t,["metadata","model"]);d!=null&&a(e,["model"],d);const c=r(t,["metadata","output"]);return c!=null&&a(e,["dest"],kr(Qo(c))),e}function Dt(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["displayName"]);o!=null&&a(e,["displayName"],o);const i=r(t,["state"]);i!=null&&a(e,["state"],jo(i));const s=r(t,["error"]);s!=null&&a(e,["error"],s);const l=r(t,["createTime"]);l!=null&&a(e,["createTime"],l);const u=r(t,["startTime"]);u!=null&&a(e,["startTime"],u);const d=r(t,["endTime"]);d!=null&&a(e,["endTime"],d);const c=r(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const f=r(t,["model"]);f!=null&&a(e,["model"],f);const h=r(t,["inputConfig"]);h!=null&&a(e,["src"],Mr(h));const p=r(t,["outputConfig"]);p!=null&&a(e,["dest"],Pr(Qo(p)));const m=r(t,["completionStats"]);return m!=null&&a(e,["completionStats"],m),e}function Mr(t){const e={},n=r(t,["instancesFormat"]);n!=null&&a(e,["format"],n);const o=r(t,["gcsSource","uris"]);o!=null&&a(e,["gcsUri"],o);const i=r(t,["bigquerySource","inputUri"]);return i!=null&&a(e,["bigqueryUri"],i),e}function Nr(t,e){const n={};if(r(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(r(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(r(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=r(e,["fileName"]);o!=null&&a(n,["fileName"],o);const i=r(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>as(t,l))),a(n,["requests","requests"],s)}return n}function br(t){const e={},n=r(t,["format"]);n!=null&&a(e,["instancesFormat"],n);const o=r(t,["gcsUri"]);o!=null&&a(e,["gcsSource","uris"],o);const i=r(t,["bigqueryUri"]);if(i!=null&&a(e,["bigquerySource","inputUri"],i),r(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(r(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Dr(t){const e={},n=r(t,["data"]);if(n!=null&&a(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Ur(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Ze(t,o)),n}function Lr(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Ze(t,o)),n}function Fr(t){const e={},n=r(t,["content"]);n!=null&&a(e,["content"],n);const o=r(t,["citationMetadata"]);o!=null&&a(e,["citationMetadata"],Gr(o));const i=r(t,["tokenCount"]);i!=null&&a(e,["tokenCount"],i);const s=r(t,["finishReason"]);s!=null&&a(e,["finishReason"],s);const l=r(t,["avgLogprobs"]);l!=null&&a(e,["avgLogprobs"],l);const u=r(t,["groundingMetadata"]);u!=null&&a(e,["groundingMetadata"],u);const d=r(t,["index"]);d!=null&&a(e,["index"],d);const c=r(t,["logprobsResult"]);c!=null&&a(e,["logprobsResult"],c);const f=r(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),a(e,["safetyRatings"],p)}const h=r(t,["urlContextMetadata"]);return h!=null&&a(e,["urlContextMetadata"],h),e}function Gr(t){const e={},n=r(t,["citationSources"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>i)),a(e,["citations"],o)}return e}function ei(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ms(s))),a(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&a(e,["role"],o),e}function Br(t,e){const n={},o=r(t,["displayName"]);if(e!==void 0&&o!=null&&a(e,["batch","displayName"],o),r(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function Vr(t,e){const n={},o=r(t,["displayName"]);e!==void 0&&o!=null&&a(e,["displayName"],o);const i=r(t,["dest"]);return e!==void 0&&i!=null&&a(e,["outputConfig"],xr(Rr(i))),n}function go(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["src"]);i!=null&&a(n,["batch","inputConfig"],Nr(t,Xo(t,i)));const s=r(e,["config"]);return s!=null&&Br(s,n),n}function Hr(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["model"],me(t,o));const i=r(e,["src"]);i!=null&&a(n,["inputConfig"],br(Xo(t,i)));const s=r(e,["config"]);return s!=null&&Vr(s,n),n}function qr(t,e){const n={},o=r(t,["displayName"]);return e!==void 0&&o!=null&&a(e,["batch","displayName"],o),n}function zr(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["src"]);i!=null&&a(n,["batch","inputConfig"],Zr(t,i));const s=r(e,["config"]);return s!=null&&qr(s,n),n}function Or(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Ze(t,o)),n}function Jr(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Ze(t,o)),n}function $r(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["name"]);o!=null&&a(e,["name"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);return s!=null&&a(e,["error"],s),e}function Wr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["name"]);o!=null&&a(e,["name"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);return s!=null&&a(e,["error"],s),e}function Kr(t,e){const n={},o=r(e,["contents"]);if(o!=null){let s=Wt(t,o);Array.isArray(s)&&(s=s.map(l=>l)),a(n,["requests[]","request","content"],s)}const i=r(e,["config"]);return i!=null&&(a(n,["_self"],Yr(i,n)),Ji(n,{"requests[].*":"requests[].request.*"})),n}function Yr(t,e){const n={},o=r(t,["taskType"]);e!==void 0&&o!=null&&a(e,["requests[]","taskType"],o);const i=r(t,["title"]);e!==void 0&&i!=null&&a(e,["requests[]","title"],i);const s=r(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&a(e,["requests[]","outputDimensionality"],s),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Zr(t,e){const n={},o=r(e,["fileName"]);o!=null&&a(n,["file_name"],o);const i=r(e,["inlinedRequests"]);return i!=null&&a(n,["requests"],Kr(t,i)),n}function Xr(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Qr(t){const e={},n=r(t,["id"]);n!=null&&a(e,["id"],n);const o=r(t,["args"]);o!=null&&a(e,["args"],o);const i=r(t,["name"]);if(i!=null&&a(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function jr(t){const e={},n=r(t,["allowedFunctionNames"]);n!=null&&a(e,["allowedFunctionNames"],n);const o=r(t,["mode"]);if(o!=null&&a(e,["mode"],o),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function es(t,e,n){const o={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],ei(Ie(i)));const s=r(e,["temperature"]);s!=null&&a(o,["temperature"],s);const l=r(e,["topP"]);l!=null&&a(o,["topP"],l);const u=r(e,["topK"]);u!=null&&a(o,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&a(o,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&a(o,["maxOutputTokens"],c);const f=r(e,["stopSequences"]);f!=null&&a(o,["stopSequences"],f);const h=r(e,["responseLogprobs"]);h!=null&&a(o,["responseLogprobs"],h);const p=r(e,["logprobs"]);p!=null&&a(o,["logprobs"],p);const m=r(e,["presencePenalty"]);m!=null&&a(o,["presencePenalty"],m);const T=r(e,["frequencyPenalty"]);T!=null&&a(o,["frequencyPenalty"],T);const v=r(e,["seed"]);v!=null&&a(o,["seed"],v);const _=r(e,["responseMimeType"]);_!=null&&a(o,["responseMimeType"],_);const E=r(e,["responseSchema"]);E!=null&&a(o,["responseSchema"],Kt(E));const S=r(e,["responseJsonSchema"]);if(S!=null&&a(o,["responseJsonSchema"],S),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=r(e,["safetySettings"]);if(n!==void 0&&R!=null){let D=R;Array.isArray(D)&&(D=D.map(y=>gs(y))),a(n,["safetySettings"],D)}const P=r(e,["tools"]);if(n!==void 0&&P!=null){let D=Ye(P);Array.isArray(D)&&(D=D.map(y=>ys(Ke(y)))),a(n,["tools"],D)}const x=r(e,["toolConfig"]);if(n!==void 0&&x!=null&&a(n,["toolConfig"],vs(x)),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=r(e,["cachedContent"]);n!==void 0&&B!=null&&a(n,["cachedContent"],Le(t,B));const U=r(e,["responseModalities"]);U!=null&&a(o,["responseModalities"],U);const A=r(e,["mediaResolution"]);A!=null&&a(o,["mediaResolution"],A);const C=r(e,["speechConfig"]);if(C!=null&&a(o,["speechConfig"],Yt(C)),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=r(e,["thinkingConfig"]);M!=null&&a(o,["thinkingConfig"],M);const z=r(e,["imageConfig"]);z!=null&&a(o,["imageConfig"],ss(z));const w=r(e,["enableEnhancedCivicAnswers"]);if(w!=null&&a(o,["enableEnhancedCivicAnswers"],w),r(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return o}function ts(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["candidates"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(c=>Fr(c))),a(e,["candidates"],d)}const i=r(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const s=r(t,["promptFeedback"]);s!=null&&a(e,["promptFeedback"],s);const l=r(t,["responseId"]);l!=null&&a(e,["responseId"],l);const u=r(t,["usageMetadata"]);return u!=null&&a(e,["usageMetadata"],u),e}function ns(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Ze(t,o)),n}function os(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Ze(t,o)),n}function is(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function rs(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],n),e}function ss(t){const e={},n=r(t,["aspectRatio"]);n!=null&&a(e,["aspectRatio"],n);const o=r(t,["imageSize"]);if(o!=null&&a(e,["imageSize"],o),r(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(r(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(r(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function as(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["request","model"],me(t,o));const i=r(e,["contents"]);if(i!=null){let u=Pe(i);Array.isArray(u)&&(u=u.map(d=>ei(d))),a(n,["request","contents"],u)}const s=r(e,["metadata"]);s!=null&&a(n,["metadata"],s);const l=r(e,["config"]);return l!=null&&a(n,["request","generationConfig"],es(t,l,r(n,["request"],{}))),n}function ls(t){const e={},n=r(t,["response"]);n!=null&&a(e,["response"],ts(n));const o=r(t,["error"]);return o!=null&&a(e,["error"],o),e}function us(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&a(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);if(e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),r(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function ds(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&a(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const s=r(t,["filter"]);return e!==void 0&&s!=null&&a(e,["_query","filter"],s),n}function cs(t){const e={},n=r(t,["config"]);return n!=null&&us(n,e),e}function fs(t){const e={},n=r(t,["config"]);return n!=null&&ds(n,e),e}function ps(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>ut(l))),a(e,["batchJobs"],s)}return e}function hs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>Dt(l))),a(e,["batchJobs"],s)}return e}function ms(t){const e={},n=r(t,["mediaResolution"]);n!=null&&a(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&a(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&a(e,["executableCode"],i);const s=r(t,["fileData"]);s!=null&&a(e,["fileData"],Xr(s));const l=r(t,["functionCall"]);l!=null&&a(e,["functionCall"],Qr(l));const u=r(t,["functionResponse"]);u!=null&&a(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&a(e,["inlineData"],Dr(d));const c=r(t,["text"]);c!=null&&a(e,["text"],c);const f=r(t,["thought"]);f!=null&&a(e,["thought"],f);const h=r(t,["thoughtSignature"]);h!=null&&a(e,["thoughtSignature"],h);const p=r(t,["videoMetadata"]);return p!=null&&a(e,["videoMetadata"],p),e}function gs(t){const e={},n=r(t,["category"]);if(n!=null&&a(e,["category"],n),r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=r(t,["threshold"]);return o!=null&&a(e,["threshold"],o),e}function vs(t){const e={},n=r(t,["retrievalConfig"]);n!=null&&a(e,["retrievalConfig"],n);const o=r(t,["functionCallingConfig"]);return o!=null&&a(e,["functionCallingConfig"],jr(o)),e}function ys(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&a(e,["computerUse"],n);const o=r(t,["fileSearch"]);o!=null&&a(e,["fileSearch"],o);const i=r(t,["codeExecution"]);if(i!=null&&a(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=r(t,["functionDeclarations"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(h=>h)),a(e,["functionDeclarations"],f)}const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],is(l));const u=r(t,["googleSearch"]);u!=null&&a(e,["googleSearch"],rs(u));const d=r(t,["googleSearchRetrieval"]);d!=null&&a(e,["googleSearchRetrieval"],d);const c=r(t,["urlContext"]);return c!=null&&a(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var De;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(De||(De={}));class He{constructor(e,n,o,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,o,i)}init(e,n,o){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!o||Object.keys(o).length===0?l={config:{}}:typeof o=="object"?l=Object.assign({},o):l=o,l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _s extends Ue{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new He(De.PAGED_ITEM_BATCH_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=go(this.apiClient,e),o=n._url,i=ee("{model}:batchGenerateContent",o),u=n.batch.inputConfig.requests,d=u.requests,c=[];for(const f of d){const h=Object.assign({},f);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const m=h.request;m.systemInstruction=p,h.request=m}c.push(h)}return u.requests=c,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const o=n?Object.assign({},n):{},i=Date.now().toString();if(o.displayName||(o.displayName=`genaiBatchJob_${i}`),o.dest===void 0){const s=this.getGcsUri(e),l=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?o.dest=`${s.slice(0,-6)}/dest`:o.dest=`${s}_dest_${i}`;else if(l)o.dest=`${l}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return o}async createInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Hr(this.apiClient,e);return u=ee("batchPredictionJobs",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>Dt(f))}else{const c=go(this.apiClient,e);return u=ee("{model}:batchGenerateContent",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>ut(f))}}async createEmbeddingsInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=zr(this.apiClient,e);return s=ee("{model}:asyncBatchEmbedContent",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>ut(d))}}async get(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=os(this.apiClient,e);return u=ee("batchPredictionJobs/{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>Dt(f))}else{const c=ns(this.apiClient,e);return u=ee("batches/{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>ut(f))}}async cancel(e){var n,o,i,s;let l="",u={};if(this.apiClient.isVertexAI()){const d=Lr(this.apiClient,e);l=ee("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}else{const d=Ur(this.apiClient,e);l=ee("batches/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=fs(e);return u=ee("batchPredictionJobs",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=hs(f),p=new fo;return Object.assign(p,h),p})}else{const c=cs(e);return u=ee("batches",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=ps(f),p=new fo;return Object.assign(p,h),p})}}async delete(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Jr(this.apiClient,e);return u=ee("batchPredictionJobs/{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>Wr(f))}else{const c=Or(this.apiClient,e);return u=ee("batches/{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>$r(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Es(t){const e={},n=r(t,["data"]);if(n!=null&&a(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function vo(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>zs(s))),a(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&a(e,["role"],o),e}function Ts(t,e){const n={},o=r(t,["ttl"]);e!==void 0&&o!=null&&a(e,["ttl"],o);const i=r(t,["expireTime"]);e!==void 0&&i!=null&&a(e,["expireTime"],i);const s=r(t,["displayName"]);e!==void 0&&s!=null&&a(e,["displayName"],s);const l=r(t,["contents"]);if(e!==void 0&&l!=null){let f=Pe(l);Array.isArray(f)&&(f=f.map(h=>vo(h))),a(e,["contents"],f)}const u=r(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],vo(Ie(u)));const d=r(t,["tools"]);if(e!==void 0&&d!=null){let f=d;Array.isArray(f)&&(f=f.map(h=>Js(h))),a(e,["tools"],f)}const c=r(t,["toolConfig"]);if(e!==void 0&&c!=null&&a(e,["toolConfig"],Os(c)),r(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Cs(t,e){const n={},o=r(t,["ttl"]);e!==void 0&&o!=null&&a(e,["ttl"],o);const i=r(t,["expireTime"]);e!==void 0&&i!=null&&a(e,["expireTime"],i);const s=r(t,["displayName"]);e!==void 0&&s!=null&&a(e,["displayName"],s);const l=r(t,["contents"]);if(e!==void 0&&l!=null){let h=Pe(l);Array.isArray(h)&&(h=h.map(p=>p)),a(e,["contents"],h)}const u=r(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],Ie(u));const d=r(t,["tools"]);if(e!==void 0&&d!=null){let h=d;Array.isArray(h)&&(h=h.map(p=>$s(p))),a(e,["tools"],h)}const c=r(t,["toolConfig"]);e!==void 0&&c!=null&&a(e,["toolConfig"],c);const f=r(t,["kmsKeyName"]);return e!==void 0&&f!=null&&a(e,["encryption_spec","kmsKeyName"],f),n}function Ss(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["model"],qo(t,o));const i=r(e,["config"]);return i!=null&&Ts(i,n),n}function Is(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["model"],qo(t,o));const i=r(e,["config"]);return i!=null&&Cs(i,n),n}function ws(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Le(t,o)),n}function As(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Le(t,o)),n}function Rs(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function ks(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function Ps(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function xs(t){const e={},n=r(t,["id"]);n!=null&&a(e,["id"],n);const o=r(t,["args"]);o!=null&&a(e,["args"],o);const i=r(t,["name"]);if(i!=null&&a(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Ms(t){const e={},n=r(t,["allowedFunctionNames"]);n!=null&&a(e,["allowedFunctionNames"],n);const o=r(t,["mode"]);if(o!=null&&a(e,["mode"],o),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Ns(t){const e={},n=r(t,["description"]);n!=null&&a(e,["description"],n);const o=r(t,["name"]);o!=null&&a(e,["name"],o);const i=r(t,["parameters"]);i!=null&&a(e,["parameters"],i);const s=r(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const l=r(t,["response"]);l!=null&&a(e,["response"],l);const u=r(t,["responseJsonSchema"]);if(u!=null&&a(e,["responseJsonSchema"],u),r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function bs(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Le(t,o)),n}function Ds(t,e){const n={},o=r(e,["name"]);return o!=null&&a(n,["_url","name"],Le(t,o)),n}function Us(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function Ls(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],n),e}function Fs(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&a(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function Gs(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&a(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function Bs(t){const e={},n=r(t,["config"]);return n!=null&&Fs(n,e),e}function Vs(t){const e={},n=r(t,["config"]);return n!=null&&Gs(n,e),e}function Hs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),a(e,["cachedContents"],s)}return e}function qs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),a(e,["cachedContents"],s)}return e}function zs(t){const e={},n=r(t,["mediaResolution"]);n!=null&&a(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&a(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&a(e,["executableCode"],i);const s=r(t,["fileData"]);s!=null&&a(e,["fileData"],Ps(s));const l=r(t,["functionCall"]);l!=null&&a(e,["functionCall"],xs(l));const u=r(t,["functionResponse"]);u!=null&&a(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&a(e,["inlineData"],Es(d));const c=r(t,["text"]);c!=null&&a(e,["text"],c);const f=r(t,["thought"]);f!=null&&a(e,["thought"],f);const h=r(t,["thoughtSignature"]);h!=null&&a(e,["thoughtSignature"],h);const p=r(t,["videoMetadata"]);return p!=null&&a(e,["videoMetadata"],p),e}function Os(t){const e={},n=r(t,["retrievalConfig"]);n!=null&&a(e,["retrievalConfig"],n);const o=r(t,["functionCallingConfig"]);return o!=null&&a(e,["functionCallingConfig"],Ms(o)),e}function Js(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&a(e,["computerUse"],n);const o=r(t,["fileSearch"]);o!=null&&a(e,["fileSearch"],o);const i=r(t,["codeExecution"]);if(i!=null&&a(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=r(t,["functionDeclarations"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(h=>h)),a(e,["functionDeclarations"],f)}const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],Us(l));const u=r(t,["googleSearch"]);u!=null&&a(e,["googleSearch"],Ls(u));const d=r(t,["googleSearchRetrieval"]);d!=null&&a(e,["googleSearchRetrieval"],d);const c=r(t,["urlContext"]);return c!=null&&a(e,["urlContext"],c),e}function $s(t){const e={},n=r(t,["retrieval"]);n!=null&&a(e,["retrieval"],n);const o=r(t,["computerUse"]);if(o!=null&&a(e,["computerUse"],o),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(t,["codeExecution"]);i!=null&&a(e,["codeExecution"],i);const s=r(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],s);const l=r(t,["functionDeclarations"]);if(l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>Ns(p))),a(e,["functionDeclarations"],h)}const u=r(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],u);const d=r(t,["googleSearch"]);d!=null&&a(e,["googleSearch"],d);const c=r(t,["googleSearchRetrieval"]);c!=null&&a(e,["googleSearchRetrieval"],c);const f=r(t,["urlContext"]);return f!=null&&a(e,["urlContext"],f),e}function Ws(t,e){const n={},o=r(t,["ttl"]);e!==void 0&&o!=null&&a(e,["ttl"],o);const i=r(t,["expireTime"]);return e!==void 0&&i!=null&&a(e,["expireTime"],i),n}function Ks(t,e){const n={},o=r(t,["ttl"]);e!==void 0&&o!=null&&a(e,["ttl"],o);const i=r(t,["expireTime"]);return e!==void 0&&i!=null&&a(e,["expireTime"],i),n}function Ys(t,e){const n={},o=r(e,["name"]);o!=null&&a(n,["_url","name"],Le(t,o));const i=r(e,["config"]);return i!=null&&Ws(i,n),n}function Zs(t,e){const n={},o=r(e,["name"]);o!=null&&a(n,["_url","name"],Le(t,o));const i=r(e,["config"]);return i!=null&&Ks(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xs extends Ue{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new He(De.PAGED_ITEM_CACHED_CONTENTS,o=>this.listInternal(o),await this.listInternal(n),n)}async create(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Is(this.apiClient,e);return u=ee("cachedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>f)}else{const c=Ss(this.apiClient,e);return u=ee("cachedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>f)}}async get(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ds(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>f)}else{const c=bs(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>f)}}async delete(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=As(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=ks(f),p=new uo;return Object.assign(p,h),p})}else{const c=ws(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=Rs(f),p=new uo;return Object.assign(p,h),p})}}async update(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Zs(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>f)}else{const c=Ys(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>f)}}async listInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Vs(e);return u=ee("cachedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=qs(f),p=new co;return Object.assign(p,h),p})}else{const c=Bs(e);return u=ee("cachedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=Hs(f),p=new co;return Object.assign(p,h),p})}}}function gt(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]]);return n}function yo(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ue(t){return this instanceof ue?(this.v=t,this):new ue(t)}function Me(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(m){return function(T){return Promise.resolve(T).then(m,h)}}function u(m,T){o[m]&&(i[m]=function(v){return new Promise(function(_,E){s.push([m,v,_,E])>1||d(m,v)})},T&&(i[m]=T(i[m])))}function d(m,T){try{c(o[m](T))}catch(v){p(s[0][3],v)}}function c(m){m.value instanceof ue?Promise.resolve(m.value.v).then(f,h):p(s[0][2],m)}function f(m){d("next",m)}function h(m){d("throw",m)}function p(m,T){m(T),s.shift(),s.length&&d(s[0][0],s[0][1])}}function Ne(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof yo=="function"?yo(t):t[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(s){n[s]=t[s]&&function(l){return new Promise(function(u,d){l=t[s](l),i(u,d,l.done,l.value)})}}function i(s,l,u,d){Promise.resolve(d).then(function(c){s({value:c,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qs(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:ti(n)}function ti(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function js(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function _o(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let o=0;for(;o<n;)if(t[o].role==="user")e.push(t[o]),o++;else{const i=[];let s=!0;for(;o<n&&t[o].role==="model";)i.push(t[o]),s&&!ti(t[o])&&(s=!1),o++;s?e.push(...i):e.pop()}return e}class ea{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new ta(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class ta{constructor(e,n,o,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=o,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),js(s)}async sendMessage(e){var n;await this.sendPromise;const o=Ie(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,l,u;const d=await i,c=(l=(s=d.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,f=d.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];f!=null&&(p=(u=f.slice(h))!==null&&u!==void 0?u:[]);const m=c?[c]:[];this.recordHistory(o,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const o=Ie(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,o)}getHistory(e=!1){const n=e?_o(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Me(this,arguments,function*(){var i,s,l,u,d,c;const f=[];try{for(var h=!0,p=Ne(e),m;m=yield ue(p.next()),i=m.done,!i;h=!0){u=m.value,h=!1;const T=u;if(Qs(T)){const v=(c=(d=T.candidates)===null||d===void 0?void 0:d[0])===null||c===void 0?void 0:c.content;v!==void 0&&f.push(v)}yield yield ue(T)}}catch(T){s={error:T}}finally{try{!h&&!i&&(l=p.return)&&(yield ue(l.call(p)))}finally{if(s)throw s.error}}this.recordHistory(n,f)})}recordHistory(e,n,o){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(..._o(o)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tt extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,tt.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function na(t){const e={},n=r(t,["file"]);return n!=null&&a(e,["file"],n),e}function oa(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function ia(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","file"],Ko(n)),e}function ra(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function sa(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","file"],Ko(n)),e}function aa(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&a(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function la(t){const e={},n=r(t,["config"]);return n!=null&&aa(n,e),e}function ua(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),a(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class da extends Ue{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new He(De.PAGED_ITEM_FILES,o=>this.listInternal(o),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=la(e);return s=ee("files",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:d.headers},f})),i.then(d=>{const c=ua(d),f=new hr;return Object.assign(f,c),f})}}async createInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=na(e);return s=ee("upload/v1beta/files",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=oa(d),f=new mr;return Object.assign(f,c),f})}}async get(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=sa(e);return s=ee("files/{file}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ia(e);return s=ee("files/{file}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:d.headers},f})),i.then(d=>{const c=ra(d),f=new gr;return Object.assign(f,c),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dt(t){const e={},n=r(t,["data"]);if(n!=null&&a(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function ca(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Ra(s))),a(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&a(e,["role"],o),e}function fa(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function pa(t){const e={},n=r(t,["id"]);n!=null&&a(e,["id"],n);const o=r(t,["args"]);o!=null&&a(e,["args"],o);const i=r(t,["name"]);if(i!=null&&a(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ha(t){const e={},n=r(t,["description"]);n!=null&&a(e,["description"],n);const o=r(t,["name"]);o!=null&&a(e,["name"],o);const i=r(t,["parameters"]);i!=null&&a(e,["parameters"],i);const s=r(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const l=r(t,["response"]);l!=null&&a(e,["response"],l);const u=r(t,["responseJsonSchema"]);if(u!=null&&a(e,["responseJsonSchema"],u),r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function ma(t){const e={},n=r(t,["modelSelectionConfig"]);n!=null&&a(e,["modelConfig"],n);const o=r(t,["responseJsonSchema"]);o!=null&&a(e,["responseJsonSchema"],o);const i=r(t,["audioTimestamp"]);i!=null&&a(e,["audioTimestamp"],i);const s=r(t,["candidateCount"]);s!=null&&a(e,["candidateCount"],s);const l=r(t,["enableAffectiveDialog"]);l!=null&&a(e,["enableAffectiveDialog"],l);const u=r(t,["frequencyPenalty"]);u!=null&&a(e,["frequencyPenalty"],u);const d=r(t,["logprobs"]);d!=null&&a(e,["logprobs"],d);const c=r(t,["maxOutputTokens"]);c!=null&&a(e,["maxOutputTokens"],c);const f=r(t,["mediaResolution"]);f!=null&&a(e,["mediaResolution"],f);const h=r(t,["presencePenalty"]);h!=null&&a(e,["presencePenalty"],h);const p=r(t,["responseLogprobs"]);p!=null&&a(e,["responseLogprobs"],p);const m=r(t,["responseMimeType"]);m!=null&&a(e,["responseMimeType"],m);const T=r(t,["responseModalities"]);T!=null&&a(e,["responseModalities"],T);const v=r(t,["responseSchema"]);v!=null&&a(e,["responseSchema"],v);const _=r(t,["routingConfig"]);_!=null&&a(e,["routingConfig"],_);const E=r(t,["seed"]);E!=null&&a(e,["seed"],E);const S=r(t,["speechConfig"]);S!=null&&a(e,["speechConfig"],S);const R=r(t,["stopSequences"]);R!=null&&a(e,["stopSequences"],R);const P=r(t,["temperature"]);P!=null&&a(e,["temperature"],P);const x=r(t,["thinkingConfig"]);x!=null&&a(e,["thinkingConfig"],x);const B=r(t,["topK"]);B!=null&&a(e,["topK"],B);const U=r(t,["topP"]);if(U!=null&&a(e,["topP"],U),r(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function ga(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function va(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],n),e}function ya(t,e){const n={},o=r(t,["generationConfig"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig"],o);const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const s=r(t,["temperature"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","temperature"],s);const l=r(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=r(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=r(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=r(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=r(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=r(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],Zt(h));const p=r(t,["thinkingConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","thinkingConfig"],p);const m=r(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const T=r(t,["systemInstruction"]);e!==void 0&&T!=null&&a(e,["setup","systemInstruction"],ca(Ie(T)));const v=r(t,["tools"]);if(e!==void 0&&v!=null){let B=Ye(v);Array.isArray(B)&&(B=B.map(U=>Pa(Ke(U)))),a(e,["setup","tools"],B)}const _=r(t,["sessionResumption"]);e!==void 0&&_!=null&&a(e,["setup","sessionResumption"],ka(_));const E=r(t,["inputAudioTranscription"]);e!==void 0&&E!=null&&a(e,["setup","inputAudioTranscription"],E);const S=r(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&a(e,["setup","outputAudioTranscription"],S);const R=r(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&a(e,["setup","realtimeInputConfig"],R);const P=r(t,["contextWindowCompression"]);e!==void 0&&P!=null&&a(e,["setup","contextWindowCompression"],P);const x=r(t,["proactivity"]);if(e!==void 0&&x!=null&&a(e,["setup","proactivity"],x),r(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function _a(t,e){const n={},o=r(t,["generationConfig"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig"],ma(o));const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const s=r(t,["temperature"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","temperature"],s);const l=r(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=r(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=r(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=r(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=r(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=r(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],Zt(h));const p=r(t,["thinkingConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","thinkingConfig"],p);const m=r(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const T=r(t,["systemInstruction"]);e!==void 0&&T!=null&&a(e,["setup","systemInstruction"],Ie(T));const v=r(t,["tools"]);if(e!==void 0&&v!=null){let U=Ye(v);Array.isArray(U)&&(U=U.map(A=>xa(Ke(A)))),a(e,["setup","tools"],U)}const _=r(t,["sessionResumption"]);e!==void 0&&_!=null&&a(e,["setup","sessionResumption"],_);const E=r(t,["inputAudioTranscription"]);e!==void 0&&E!=null&&a(e,["setup","inputAudioTranscription"],E);const S=r(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&a(e,["setup","outputAudioTranscription"],S);const R=r(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&a(e,["setup","realtimeInputConfig"],R);const P=r(t,["contextWindowCompression"]);e!==void 0&&P!=null&&a(e,["setup","contextWindowCompression"],P);const x=r(t,["proactivity"]);e!==void 0&&x!=null&&a(e,["setup","proactivity"],x);const B=r(t,["explicitVadSignal"]);return e!==void 0&&B!=null&&a(e,["setup","explicitVadSignal"],B),n}function Ea(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["setup","model"],me(t,o));const i=r(e,["config"]);return i!=null&&a(n,["config"],ya(i,n)),n}function Ta(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["setup","model"],me(t,o));const i=r(e,["config"]);return i!=null&&a(n,["config"],_a(i,n)),n}function Ca(t){const e={},n=r(t,["musicGenerationConfig"]);return n!=null&&a(e,["musicGenerationConfig"],n),e}function Sa(t){const e={},n=r(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>i)),a(e,["weightedPrompts"],o)}return e}function Ia(t){const e={},n=r(t,["media"]);if(n!=null){let c=zo(n);Array.isArray(c)&&(c=c.map(f=>dt(f))),a(e,["mediaChunks"],c)}const o=r(t,["audio"]);o!=null&&a(e,["audio"],dt(Jo(o)));const i=r(t,["audioStreamEnd"]);i!=null&&a(e,["audioStreamEnd"],i);const s=r(t,["video"]);s!=null&&a(e,["video"],dt(Oo(s)));const l=r(t,["text"]);l!=null&&a(e,["text"],l);const u=r(t,["activityStart"]);u!=null&&a(e,["activityStart"],u);const d=r(t,["activityEnd"]);return d!=null&&a(e,["activityEnd"],d),e}function wa(t){const e={},n=r(t,["media"]);if(n!=null){let c=zo(n);Array.isArray(c)&&(c=c.map(f=>f)),a(e,["mediaChunks"],c)}const o=r(t,["audio"]);o!=null&&a(e,["audio"],Jo(o));const i=r(t,["audioStreamEnd"]);i!=null&&a(e,["audioStreamEnd"],i);const s=r(t,["video"]);s!=null&&a(e,["video"],Oo(s));const l=r(t,["text"]);l!=null&&a(e,["text"],l);const u=r(t,["activityStart"]);u!=null&&a(e,["activityStart"],u);const d=r(t,["activityEnd"]);return d!=null&&a(e,["activityEnd"],d),e}function Aa(t){const e={},n=r(t,["setupComplete"]);n!=null&&a(e,["setupComplete"],n);const o=r(t,["serverContent"]);o!=null&&a(e,["serverContent"],o);const i=r(t,["toolCall"]);i!=null&&a(e,["toolCall"],i);const s=r(t,["toolCallCancellation"]);s!=null&&a(e,["toolCallCancellation"],s);const l=r(t,["usageMetadata"]);l!=null&&a(e,["usageMetadata"],Ma(l));const u=r(t,["goAway"]);u!=null&&a(e,["goAway"],u);const d=r(t,["sessionResumptionUpdate"]);d!=null&&a(e,["sessionResumptionUpdate"],d);const c=r(t,["voiceActivityDetectionSignal"]);c!=null&&a(e,["voiceActivityDetectionSignal"],c);const f=r(t,["voiceActivity"]);return f!=null&&a(e,["voiceActivity"],Na(f)),e}function Ra(t){const e={},n=r(t,["mediaResolution"]);n!=null&&a(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&a(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&a(e,["executableCode"],i);const s=r(t,["fileData"]);s!=null&&a(e,["fileData"],fa(s));const l=r(t,["functionCall"]);l!=null&&a(e,["functionCall"],pa(l));const u=r(t,["functionResponse"]);u!=null&&a(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&a(e,["inlineData"],dt(d));const c=r(t,["text"]);c!=null&&a(e,["text"],c);const f=r(t,["thought"]);f!=null&&a(e,["thought"],f);const h=r(t,["thoughtSignature"]);h!=null&&a(e,["thoughtSignature"],h);const p=r(t,["videoMetadata"]);return p!=null&&a(e,["videoMetadata"],p),e}function ka(t){const e={},n=r(t,["handle"]);if(n!=null&&a(e,["handle"],n),r(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Pa(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&a(e,["computerUse"],n);const o=r(t,["fileSearch"]);o!=null&&a(e,["fileSearch"],o);const i=r(t,["codeExecution"]);if(i!=null&&a(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=r(t,["functionDeclarations"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(h=>h)),a(e,["functionDeclarations"],f)}const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],ga(l));const u=r(t,["googleSearch"]);u!=null&&a(e,["googleSearch"],va(u));const d=r(t,["googleSearchRetrieval"]);d!=null&&a(e,["googleSearchRetrieval"],d);const c=r(t,["urlContext"]);return c!=null&&a(e,["urlContext"],c),e}function xa(t){const e={},n=r(t,["retrieval"]);n!=null&&a(e,["retrieval"],n);const o=r(t,["computerUse"]);if(o!=null&&a(e,["computerUse"],o),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(t,["codeExecution"]);i!=null&&a(e,["codeExecution"],i);const s=r(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],s);const l=r(t,["functionDeclarations"]);if(l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>ha(p))),a(e,["functionDeclarations"],h)}const u=r(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],u);const d=r(t,["googleSearch"]);d!=null&&a(e,["googleSearch"],d);const c=r(t,["googleSearchRetrieval"]);c!=null&&a(e,["googleSearchRetrieval"],c);const f=r(t,["urlContext"]);return f!=null&&a(e,["urlContext"],f),e}function Ma(t){const e={},n=r(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const o=r(t,["cachedContentTokenCount"]);o!=null&&a(e,["cachedContentTokenCount"],o);const i=r(t,["candidatesTokenCount"]);i!=null&&a(e,["responseTokenCount"],i);const s=r(t,["toolUsePromptTokenCount"]);s!=null&&a(e,["toolUsePromptTokenCount"],s);const l=r(t,["thoughtsTokenCount"]);l!=null&&a(e,["thoughtsTokenCount"],l);const u=r(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const d=r(t,["promptTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(T=>T)),a(e,["promptTokensDetails"],m)}const c=r(t,["cacheTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(T=>T)),a(e,["cacheTokensDetails"],m)}const f=r(t,["candidatesTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(T=>T)),a(e,["responseTokensDetails"],m)}const h=r(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(T=>T)),a(e,["toolUsePromptTokensDetails"],m)}const p=r(t,["trafficType"]);return p!=null&&a(e,["trafficType"],p),e}function Na(t){const e={},n=r(t,["type"]);return n!=null&&a(e,["voiceActivityType"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ba(t){const e={},n=r(t,["data"]);if(n!=null&&a(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function Da(t){const e={},n=r(t,["content"]);n!=null&&a(e,["content"],n);const o=r(t,["citationMetadata"]);o!=null&&a(e,["citationMetadata"],Ua(o));const i=r(t,["tokenCount"]);i!=null&&a(e,["tokenCount"],i);const s=r(t,["finishReason"]);s!=null&&a(e,["finishReason"],s);const l=r(t,["avgLogprobs"]);l!=null&&a(e,["avgLogprobs"],l);const u=r(t,["groundingMetadata"]);u!=null&&a(e,["groundingMetadata"],u);const d=r(t,["index"]);d!=null&&a(e,["index"],d);const c=r(t,["logprobsResult"]);c!=null&&a(e,["logprobsResult"],c);const f=r(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),a(e,["safetyRatings"],p)}const h=r(t,["urlContextMetadata"]);return h!=null&&a(e,["urlContextMetadata"],h),e}function Ua(t){const e={},n=r(t,["citationSources"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>i)),a(e,["citations"],o)}return e}function La(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["contents"]);if(i!=null){let s=Pe(i);Array.isArray(s)&&(s=s.map(l=>l)),a(n,["contents"],s)}return n}function Fa(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["tokensInfo"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),a(e,["tokensInfo"],i)}return e}function Ga(t){const e={},n=r(t,["values"]);n!=null&&a(e,["values"],n);const o=r(t,["statistics"]);return o!=null&&a(e,["statistics"],Ba(o)),e}function Ba(t){const e={},n=r(t,["truncated"]);n!=null&&a(e,["truncated"],n);const o=r(t,["token_count"]);return o!=null&&a(e,["tokenCount"],o),e}function _t(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Kl(s))),a(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&a(e,["role"],o),e}function Va(t){const e={},n=r(t,["controlType"]);n!=null&&a(e,["controlType"],n);const o=r(t,["enableControlImageComputation"]);return o!=null&&a(e,["computeControl"],o),e}function Ha(t){const e={};if(r(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(r(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(r(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function qa(t,e){const n={},o=r(t,["systemInstruction"]);e!==void 0&&o!=null&&a(e,["systemInstruction"],Ie(o));const i=r(t,["tools"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>ri(u))),a(e,["tools"],l)}const s=r(t,["generationConfig"]);return e!==void 0&&s!=null&&a(e,["generationConfig"],bl(s)),n}function za(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["contents"]);if(i!=null){let l=Pe(i);Array.isArray(l)&&(l=l.map(u=>_t(u))),a(n,["contents"],l)}const s=r(e,["config"]);return s!=null&&Ha(s),n}function Oa(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["contents"]);if(i!=null){let l=Pe(i);Array.isArray(l)&&(l=l.map(u=>u)),a(n,["contents"],l)}const s=r(e,["config"]);return s!=null&&qa(s,n),n}function Ja(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["totalTokens"]);o!=null&&a(e,["totalTokens"],o);const i=r(t,["cachedContentTokenCount"]);return i!=null&&a(e,["cachedContentTokenCount"],i),e}function $a(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["totalTokens"]);return o!=null&&a(e,["totalTokens"],o),e}function Wa(t,e){const n={},o=r(e,["model"]);return o!=null&&a(n,["_url","name"],me(t,o)),n}function Ka(t,e){const n={},o=r(e,["model"]);return o!=null&&a(n,["_url","name"],me(t,o)),n}function Ya(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function Za(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function Xa(t,e){const n={},o=r(t,["outputGcsUri"]);e!==void 0&&o!=null&&a(e,["parameters","storageUri"],o);const i=r(t,["negativePrompt"]);e!==void 0&&i!=null&&a(e,["parameters","negativePrompt"],i);const s=r(t,["numberOfImages"]);e!==void 0&&s!=null&&a(e,["parameters","sampleCount"],s);const l=r(t,["aspectRatio"]);e!==void 0&&l!=null&&a(e,["parameters","aspectRatio"],l);const u=r(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const d=r(t,["seed"]);e!==void 0&&d!=null&&a(e,["parameters","seed"],d);const c=r(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&a(e,["parameters","safetySetting"],c);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=r(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&a(e,["parameters","includeSafetyAttributes"],h);const p=r(t,["includeRaiReason"]);e!==void 0&&p!=null&&a(e,["parameters","includeRaiReason"],p);const m=r(t,["language"]);e!==void 0&&m!=null&&a(e,["parameters","language"],m);const T=r(t,["outputMimeType"]);e!==void 0&&T!=null&&a(e,["parameters","outputOptions","mimeType"],T);const v=r(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&a(e,["parameters","outputOptions","compressionQuality"],v);const _=r(t,["addWatermark"]);e!==void 0&&_!=null&&a(e,["parameters","addWatermark"],_);const E=r(t,["labels"]);e!==void 0&&E!=null&&a(e,["labels"],E);const S=r(t,["editMode"]);e!==void 0&&S!=null&&a(e,["parameters","editMode"],S);const R=r(t,["baseSteps"]);return e!==void 0&&R!=null&&a(e,["parameters","editConfig","baseSteps"],R),n}function Qa(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const s=r(e,["referenceImages"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>eu(d))),a(n,["instances[0]","referenceImages"],u)}const l=r(e,["config"]);return l!=null&&Xa(l,n),n}function ja(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>Et(s))),a(e,["generatedImages"],i)}return e}function el(t,e){const n={},o=r(t,["taskType"]);e!==void 0&&o!=null&&a(e,["requests[]","taskType"],o);const i=r(t,["title"]);e!==void 0&&i!=null&&a(e,["requests[]","title"],i);const s=r(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&a(e,["requests[]","outputDimensionality"],s),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function tl(t,e){const n={},o=r(t,["taskType"]);e!==void 0&&o!=null&&a(e,["instances[]","task_type"],o);const i=r(t,["title"]);e!==void 0&&i!=null&&a(e,["instances[]","title"],i);const s=r(t,["outputDimensionality"]);e!==void 0&&s!=null&&a(e,["parameters","outputDimensionality"],s);const l=r(t,["mimeType"]);e!==void 0&&l!=null&&a(e,["instances[]","mimeType"],l);const u=r(t,["autoTruncate"]);return e!==void 0&&u!=null&&a(e,["parameters","autoTruncate"],u),n}function nl(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["contents"]);if(i!=null){let u=Wt(t,i);Array.isArray(u)&&(u=u.map(d=>d)),a(n,["requests[]","content"],u)}const s=r(e,["config"]);s!=null&&el(s,n);const l=r(e,["model"]);return l!==void 0&&a(n,["requests[]","model"],me(t,l)),n}function ol(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["contents"]);if(i!=null){let l=Wt(t,i);Array.isArray(l)&&(l=l.map(u=>u)),a(n,["instances[]","content"],l)}const s=r(e,["config"]);return s!=null&&tl(s,n),n}function il(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["embeddings"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>l)),a(e,["embeddings"],s)}const i=r(t,["metadata"]);return i!=null&&a(e,["metadata"],i),e}function rl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["predictions[]","embeddings"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>Ga(l))),a(e,["embeddings"],s)}const i=r(t,["metadata"]);return i!=null&&a(e,["metadata"],i),e}function sl(t){const e={},n=r(t,["endpoint"]);n!=null&&a(e,["name"],n);const o=r(t,["deployedModelId"]);return o!=null&&a(e,["deployedModelId"],o),e}function al(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function ll(t){const e={},n=r(t,["id"]);n!=null&&a(e,["id"],n);const o=r(t,["args"]);o!=null&&a(e,["args"],o);const i=r(t,["name"]);if(i!=null&&a(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ul(t){const e={},n=r(t,["allowedFunctionNames"]);n!=null&&a(e,["allowedFunctionNames"],n);const o=r(t,["mode"]);if(o!=null&&a(e,["mode"],o),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function dl(t){const e={},n=r(t,["description"]);n!=null&&a(e,["description"],n);const o=r(t,["name"]);o!=null&&a(e,["name"],o);const i=r(t,["parameters"]);i!=null&&a(e,["parameters"],i);const s=r(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const l=r(t,["response"]);l!=null&&a(e,["response"],l);const u=r(t,["responseJsonSchema"]);if(u!=null&&a(e,["responseJsonSchema"],u),r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function cl(t,e,n){const o={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],_t(Ie(i)));const s=r(e,["temperature"]);s!=null&&a(o,["temperature"],s);const l=r(e,["topP"]);l!=null&&a(o,["topP"],l);const u=r(e,["topK"]);u!=null&&a(o,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&a(o,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&a(o,["maxOutputTokens"],c);const f=r(e,["stopSequences"]);f!=null&&a(o,["stopSequences"],f);const h=r(e,["responseLogprobs"]);h!=null&&a(o,["responseLogprobs"],h);const p=r(e,["logprobs"]);p!=null&&a(o,["logprobs"],p);const m=r(e,["presencePenalty"]);m!=null&&a(o,["presencePenalty"],m);const T=r(e,["frequencyPenalty"]);T!=null&&a(o,["frequencyPenalty"],T);const v=r(e,["seed"]);v!=null&&a(o,["seed"],v);const _=r(e,["responseMimeType"]);_!=null&&a(o,["responseMimeType"],_);const E=r(e,["responseSchema"]);E!=null&&a(o,["responseSchema"],Kt(E));const S=r(e,["responseJsonSchema"]);if(S!=null&&a(o,["responseJsonSchema"],S),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=r(e,["safetySettings"]);if(n!==void 0&&R!=null){let D=R;Array.isArray(D)&&(D=D.map(y=>tu(y))),a(n,["safetySettings"],D)}const P=r(e,["tools"]);if(n!==void 0&&P!=null){let D=Ye(P);Array.isArray(D)&&(D=D.map(y=>lu(Ke(y)))),a(n,["tools"],D)}const x=r(e,["toolConfig"]);if(n!==void 0&&x!=null&&a(n,["toolConfig"],au(x)),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=r(e,["cachedContent"]);n!==void 0&&B!=null&&a(n,["cachedContent"],Le(t,B));const U=r(e,["responseModalities"]);U!=null&&a(o,["responseModalities"],U);const A=r(e,["mediaResolution"]);A!=null&&a(o,["mediaResolution"],A);const C=r(e,["speechConfig"]);if(C!=null&&a(o,["speechConfig"],Yt(C)),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=r(e,["thinkingConfig"]);M!=null&&a(o,["thinkingConfig"],M);const z=r(e,["imageConfig"]);z!=null&&a(o,["imageConfig"],Gl(z));const w=r(e,["enableEnhancedCivicAnswers"]);if(w!=null&&a(o,["enableEnhancedCivicAnswers"],w),r(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return o}function fl(t,e,n){const o={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],Ie(i));const s=r(e,["temperature"]);s!=null&&a(o,["temperature"],s);const l=r(e,["topP"]);l!=null&&a(o,["topP"],l);const u=r(e,["topK"]);u!=null&&a(o,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&a(o,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&a(o,["maxOutputTokens"],c);const f=r(e,["stopSequences"]);f!=null&&a(o,["stopSequences"],f);const h=r(e,["responseLogprobs"]);h!=null&&a(o,["responseLogprobs"],h);const p=r(e,["logprobs"]);p!=null&&a(o,["logprobs"],p);const m=r(e,["presencePenalty"]);m!=null&&a(o,["presencePenalty"],m);const T=r(e,["frequencyPenalty"]);T!=null&&a(o,["frequencyPenalty"],T);const v=r(e,["seed"]);v!=null&&a(o,["seed"],v);const _=r(e,["responseMimeType"]);_!=null&&a(o,["responseMimeType"],_);const E=r(e,["responseSchema"]);E!=null&&a(o,["responseSchema"],Kt(E));const S=r(e,["responseJsonSchema"]);S!=null&&a(o,["responseJsonSchema"],S);const R=r(e,["routingConfig"]);R!=null&&a(o,["routingConfig"],R);const P=r(e,["modelSelectionConfig"]);P!=null&&a(o,["modelConfig"],P);const x=r(e,["safetySettings"]);if(n!==void 0&&x!=null){let F=x;Array.isArray(F)&&(F=F.map(ne=>ne)),a(n,["safetySettings"],F)}const B=r(e,["tools"]);if(n!==void 0&&B!=null){let F=Ye(B);Array.isArray(F)&&(F=F.map(ne=>ri(Ke(ne)))),a(n,["tools"],F)}const U=r(e,["toolConfig"]);n!==void 0&&U!=null&&a(n,["toolConfig"],U);const A=r(e,["labels"]);n!==void 0&&A!=null&&a(n,["labels"],A);const C=r(e,["cachedContent"]);n!==void 0&&C!=null&&a(n,["cachedContent"],Le(t,C));const M=r(e,["responseModalities"]);M!=null&&a(o,["responseModalities"],M);const z=r(e,["mediaResolution"]);z!=null&&a(o,["mediaResolution"],z);const w=r(e,["speechConfig"]);w!=null&&a(o,["speechConfig"],Yt(w));const D=r(e,["audioTimestamp"]);D!=null&&a(o,["audioTimestamp"],D);const y=r(e,["thinkingConfig"]);y!=null&&a(o,["thinkingConfig"],y);const O=r(e,["imageConfig"]);if(O!=null&&a(o,["imageConfig"],Bl(O)),r(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const te=r(e,["modelArmorConfig"]);return n!==void 0&&te!=null&&a(n,["modelArmorConfig"],te),o}function Eo(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["contents"]);if(i!=null){let l=Pe(i);Array.isArray(l)&&(l=l.map(u=>_t(u))),a(n,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(n,["generationConfig"],cl(t,s,n)),n}function To(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["contents"]);if(i!=null){let l=Pe(i);Array.isArray(l)&&(l=l.map(u=>u)),a(n,["contents"],l)}const s=r(e,["config"]);return s!=null&&a(n,["generationConfig"],fl(t,s,n)),n}function Co(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["candidates"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(c=>Da(c))),a(e,["candidates"],d)}const i=r(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const s=r(t,["promptFeedback"]);s!=null&&a(e,["promptFeedback"],s);const l=r(t,["responseId"]);l!=null&&a(e,["responseId"],l);const u=r(t,["usageMetadata"]);return u!=null&&a(e,["usageMetadata"],u),e}function So(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>f)),a(e,["candidates"],c)}const i=r(t,["createTime"]);i!=null&&a(e,["createTime"],i);const s=r(t,["modelVersion"]);s!=null&&a(e,["modelVersion"],s);const l=r(t,["promptFeedback"]);l!=null&&a(e,["promptFeedback"],l);const u=r(t,["responseId"]);u!=null&&a(e,["responseId"],u);const d=r(t,["usageMetadata"]);return d!=null&&a(e,["usageMetadata"],d),e}function pl(t,e){const n={};if(r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=r(t,["numberOfImages"]);e!==void 0&&o!=null&&a(e,["parameters","sampleCount"],o);const i=r(t,["aspectRatio"]);e!==void 0&&i!=null&&a(e,["parameters","aspectRatio"],i);const s=r(t,["guidanceScale"]);if(e!==void 0&&s!=null&&a(e,["parameters","guidanceScale"],s),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=r(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&a(e,["parameters","safetySetting"],l);const u=r(t,["personGeneration"]);e!==void 0&&u!=null&&a(e,["parameters","personGeneration"],u);const d=r(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&a(e,["parameters","includeSafetyAttributes"],d);const c=r(t,["includeRaiReason"]);e!==void 0&&c!=null&&a(e,["parameters","includeRaiReason"],c);const f=r(t,["language"]);e!==void 0&&f!=null&&a(e,["parameters","language"],f);const h=r(t,["outputMimeType"]);e!==void 0&&h!=null&&a(e,["parameters","outputOptions","mimeType"],h);const p=r(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&a(e,["parameters","outputOptions","compressionQuality"],p),r(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=r(t,["imageSize"]);if(e!==void 0&&m!=null&&a(e,["parameters","sampleImageSize"],m),r(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function hl(t,e){const n={},o=r(t,["outputGcsUri"]);e!==void 0&&o!=null&&a(e,["parameters","storageUri"],o);const i=r(t,["negativePrompt"]);e!==void 0&&i!=null&&a(e,["parameters","negativePrompt"],i);const s=r(t,["numberOfImages"]);e!==void 0&&s!=null&&a(e,["parameters","sampleCount"],s);const l=r(t,["aspectRatio"]);e!==void 0&&l!=null&&a(e,["parameters","aspectRatio"],l);const u=r(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const d=r(t,["seed"]);e!==void 0&&d!=null&&a(e,["parameters","seed"],d);const c=r(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&a(e,["parameters","safetySetting"],c);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=r(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&a(e,["parameters","includeSafetyAttributes"],h);const p=r(t,["includeRaiReason"]);e!==void 0&&p!=null&&a(e,["parameters","includeRaiReason"],p);const m=r(t,["language"]);e!==void 0&&m!=null&&a(e,["parameters","language"],m);const T=r(t,["outputMimeType"]);e!==void 0&&T!=null&&a(e,["parameters","outputOptions","mimeType"],T);const v=r(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&a(e,["parameters","outputOptions","compressionQuality"],v);const _=r(t,["addWatermark"]);e!==void 0&&_!=null&&a(e,["parameters","addWatermark"],_);const E=r(t,["labels"]);e!==void 0&&E!=null&&a(e,["labels"],E);const S=r(t,["imageSize"]);e!==void 0&&S!=null&&a(e,["parameters","sampleImageSize"],S);const R=r(t,["enhancePrompt"]);return e!==void 0&&R!=null&&a(e,["parameters","enhancePrompt"],R),n}function ml(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const s=r(e,["config"]);return s!=null&&pl(s,n),n}function gl(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const s=r(e,["config"]);return s!=null&&hl(s,n),n}function vl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>Pl(l))),a(e,["generatedImages"],s)}const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],oi(i)),e}function yl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>Et(l))),a(e,["generatedImages"],s)}const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],ii(i)),e}function _l(t,e){const n={},o=r(t,["numberOfVideos"]);if(e!==void 0&&o!=null&&a(e,["parameters","sampleCount"],o),r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=r(t,["durationSeconds"]);if(e!==void 0&&i!=null&&a(e,["parameters","durationSeconds"],i),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=r(t,["aspectRatio"]);e!==void 0&&s!=null&&a(e,["parameters","aspectRatio"],s);const l=r(t,["resolution"]);e!==void 0&&l!=null&&a(e,["parameters","resolution"],l);const u=r(t,["personGeneration"]);if(e!==void 0&&u!=null&&a(e,["parameters","personGeneration"],u),r(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=r(t,["negativePrompt"]);e!==void 0&&d!=null&&a(e,["parameters","negativePrompt"],d);const c=r(t,["enhancePrompt"]);if(e!==void 0&&c!=null&&a(e,["parameters","enhancePrompt"],c),r(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=r(t,["lastFrame"]);e!==void 0&&f!=null&&a(e,["instances[0]","lastFrame"],Tt(f));const h=r(t,["referenceImages"]);if(e!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>Tu(m))),a(e,["instances[0]","referenceImages"],p)}if(r(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(r(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function El(t,e){const n={},o=r(t,["numberOfVideos"]);e!==void 0&&o!=null&&a(e,["parameters","sampleCount"],o);const i=r(t,["outputGcsUri"]);e!==void 0&&i!=null&&a(e,["parameters","storageUri"],i);const s=r(t,["fps"]);e!==void 0&&s!=null&&a(e,["parameters","fps"],s);const l=r(t,["durationSeconds"]);e!==void 0&&l!=null&&a(e,["parameters","durationSeconds"],l);const u=r(t,["seed"]);e!==void 0&&u!=null&&a(e,["parameters","seed"],u);const d=r(t,["aspectRatio"]);e!==void 0&&d!=null&&a(e,["parameters","aspectRatio"],d);const c=r(t,["resolution"]);e!==void 0&&c!=null&&a(e,["parameters","resolution"],c);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const h=r(t,["pubsubTopic"]);e!==void 0&&h!=null&&a(e,["parameters","pubsubTopic"],h);const p=r(t,["negativePrompt"]);e!==void 0&&p!=null&&a(e,["parameters","negativePrompt"],p);const m=r(t,["enhancePrompt"]);e!==void 0&&m!=null&&a(e,["parameters","enhancePrompt"],m);const T=r(t,["generateAudio"]);e!==void 0&&T!=null&&a(e,["parameters","generateAudio"],T);const v=r(t,["lastFrame"]);e!==void 0&&v!=null&&a(e,["instances[0]","lastFrame"],be(v));const _=r(t,["referenceImages"]);if(e!==void 0&&_!=null){let R=_;Array.isArray(R)&&(R=R.map(P=>Cu(P))),a(e,["instances[0]","referenceImages"],R)}const E=r(t,["mask"]);e!==void 0&&E!=null&&a(e,["instances[0]","mask"],Eu(E));const S=r(t,["compressionQuality"]);return e!==void 0&&S!=null&&a(e,["parameters","compressionQuality"],S),n}function Tl(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["metadata"]);o!=null&&a(e,["metadata"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);s!=null&&a(e,["error"],s);const l=r(t,["response","generateVideoResponse"]);return l!=null&&a(e,["response"],wl(l)),e}function Cl(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["metadata"]);o!=null&&a(e,["metadata"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);s!=null&&a(e,["error"],s);const l=r(t,["response"]);return l!=null&&a(e,["response"],Al(l)),e}function Sl(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const s=r(e,["image"]);s!=null&&a(n,["instances[0]","image"],Tt(s));const l=r(e,["video"]);l!=null&&a(n,["instances[0]","video"],si(l));const u=r(e,["source"]);u!=null&&Rl(u,n);const d=r(e,["config"]);return d!=null&&_l(d,n),n}function Il(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const s=r(e,["image"]);s!=null&&a(n,["instances[0]","image"],be(s));const l=r(e,["video"]);l!=null&&a(n,["instances[0]","video"],ai(l));const u=r(e,["source"]);u!=null&&kl(u,n);const d=r(e,["config"]);return d!=null&&El(d,n),n}function wl(t){const e={},n=r(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Ml(l))),a(e,["generatedVideos"],s)}const o=r(t,["raiMediaFilteredCount"]);o!=null&&a(e,["raiMediaFilteredCount"],o);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function Al(t){const e={},n=r(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Nl(l))),a(e,["generatedVideos"],s)}const o=r(t,["raiMediaFilteredCount"]);o!=null&&a(e,["raiMediaFilteredCount"],o);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function Rl(t,e){const n={},o=r(t,["prompt"]);e!==void 0&&o!=null&&a(e,["instances[0]","prompt"],o);const i=r(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],Tt(i));const s=r(t,["video"]);return e!==void 0&&s!=null&&a(e,["instances[0]","video"],si(s)),n}function kl(t,e){const n={},o=r(t,["prompt"]);e!==void 0&&o!=null&&a(e,["instances[0]","prompt"],o);const i=r(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],be(i));const s=r(t,["video"]);return e!==void 0&&s!=null&&a(e,["instances[0]","video"],ai(s)),n}function Pl(t){const e={},n=r(t,["_self"]);n!=null&&a(e,["image"],Vl(n));const o=r(t,["raiFilteredReason"]);o!=null&&a(e,["raiFilteredReason"],o);const i=r(t,["_self"]);return i!=null&&a(e,["safetyAttributes"],oi(i)),e}function Et(t){const e={},n=r(t,["_self"]);n!=null&&a(e,["image"],ni(n));const o=r(t,["raiFilteredReason"]);o!=null&&a(e,["raiFilteredReason"],o);const i=r(t,["_self"]);i!=null&&a(e,["safetyAttributes"],ii(i));const s=r(t,["prompt"]);return s!=null&&a(e,["enhancedPrompt"],s),e}function xl(t){const e={},n=r(t,["_self"]);n!=null&&a(e,["mask"],ni(n));const o=r(t,["labels"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),a(e,["labels"],i)}return e}function Ml(t){const e={},n=r(t,["video"]);return n!=null&&a(e,["video"],yu(n)),e}function Nl(t){const e={},n=r(t,["_self"]);return n!=null&&a(e,["video"],_u(n)),e}function bl(t){const e={},n=r(t,["modelSelectionConfig"]);n!=null&&a(e,["modelConfig"],n);const o=r(t,["responseJsonSchema"]);o!=null&&a(e,["responseJsonSchema"],o);const i=r(t,["audioTimestamp"]);i!=null&&a(e,["audioTimestamp"],i);const s=r(t,["candidateCount"]);s!=null&&a(e,["candidateCount"],s);const l=r(t,["enableAffectiveDialog"]);l!=null&&a(e,["enableAffectiveDialog"],l);const u=r(t,["frequencyPenalty"]);u!=null&&a(e,["frequencyPenalty"],u);const d=r(t,["logprobs"]);d!=null&&a(e,["logprobs"],d);const c=r(t,["maxOutputTokens"]);c!=null&&a(e,["maxOutputTokens"],c);const f=r(t,["mediaResolution"]);f!=null&&a(e,["mediaResolution"],f);const h=r(t,["presencePenalty"]);h!=null&&a(e,["presencePenalty"],h);const p=r(t,["responseLogprobs"]);p!=null&&a(e,["responseLogprobs"],p);const m=r(t,["responseMimeType"]);m!=null&&a(e,["responseMimeType"],m);const T=r(t,["responseModalities"]);T!=null&&a(e,["responseModalities"],T);const v=r(t,["responseSchema"]);v!=null&&a(e,["responseSchema"],v);const _=r(t,["routingConfig"]);_!=null&&a(e,["routingConfig"],_);const E=r(t,["seed"]);E!=null&&a(e,["seed"],E);const S=r(t,["speechConfig"]);S!=null&&a(e,["speechConfig"],S);const R=r(t,["stopSequences"]);R!=null&&a(e,["stopSequences"],R);const P=r(t,["temperature"]);P!=null&&a(e,["temperature"],P);const x=r(t,["thinkingConfig"]);x!=null&&a(e,["thinkingConfig"],x);const B=r(t,["topK"]);B!=null&&a(e,["topK"],B);const U=r(t,["topP"]);if(U!=null&&a(e,["topP"],U),r(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Dl(t,e){const n={},o=r(e,["model"]);return o!=null&&a(n,["_url","name"],me(t,o)),n}function Ul(t,e){const n={},o=r(e,["model"]);return o!=null&&a(n,["_url","name"],me(t,o)),n}function Ll(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function Fl(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],n),e}function Gl(t){const e={},n=r(t,["aspectRatio"]);n!=null&&a(e,["aspectRatio"],n);const o=r(t,["imageSize"]);if(o!=null&&a(e,["imageSize"],o),r(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(r(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(r(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Bl(t){const e={},n=r(t,["aspectRatio"]);n!=null&&a(e,["aspectRatio"],n);const o=r(t,["imageSize"]);o!=null&&a(e,["imageSize"],o);const i=r(t,["personGeneration"]);i!=null&&a(e,["personGeneration"],i);const s=r(t,["outputMimeType"]);s!=null&&a(e,["imageOutputOptions","mimeType"],s);const l=r(t,["outputCompressionQuality"]);return l!=null&&a(e,["imageOutputOptions","compressionQuality"],l),e}function Vl(t){const e={},n=r(t,["bytesBase64Encoded"]);n!=null&&a(e,["imageBytes"],Be(n));const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function ni(t){const e={},n=r(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const o=r(t,["bytesBase64Encoded"]);o!=null&&a(e,["imageBytes"],Be(o));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Tt(t){const e={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(t,["imageBytes"]);n!=null&&a(e,["bytesBase64Encoded"],Be(n));const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function be(t){const e={},n=r(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const o=r(t,["imageBytes"]);o!=null&&a(e,["bytesBase64Encoded"],Be(o));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Hl(t,e,n){const o={},i=r(e,["pageSize"]);n!==void 0&&i!=null&&a(n,["_query","pageSize"],i);const s=r(e,["pageToken"]);n!==void 0&&s!=null&&a(n,["_query","pageToken"],s);const l=r(e,["filter"]);n!==void 0&&l!=null&&a(n,["_query","filter"],l);const u=r(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],Yo(t,u)),o}function ql(t,e,n){const o={},i=r(e,["pageSize"]);n!==void 0&&i!=null&&a(n,["_query","pageSize"],i);const s=r(e,["pageToken"]);n!==void 0&&s!=null&&a(n,["_query","pageToken"],s);const l=r(e,["filter"]);n!==void 0&&l!=null&&a(n,["_query","filter"],l);const u=r(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],Yo(t,u)),o}function zl(t,e){const n={},o=r(e,["config"]);return o!=null&&Hl(t,o,n),n}function Ol(t,e){const n={},o=r(e,["config"]);return o!=null&&ql(t,o,n),n}function Jl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["_self"]);if(i!=null){let s=Zo(i);Array.isArray(s)&&(s=s.map(l=>Ut(l))),a(e,["models"],s)}return e}function $l(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["_self"]);if(i!=null){let s=Zo(i);Array.isArray(s)&&(s=s.map(l=>Lt(l))),a(e,["models"],s)}return e}function Wl(t){const e={},n=r(t,["maskMode"]);n!=null&&a(e,["maskMode"],n);const o=r(t,["segmentationClasses"]);o!=null&&a(e,["maskClasses"],o);const i=r(t,["maskDilation"]);return i!=null&&a(e,["dilation"],i),e}function Ut(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["displayName"]);o!=null&&a(e,["displayName"],o);const i=r(t,["description"]);i!=null&&a(e,["description"],i);const s=r(t,["version"]);s!=null&&a(e,["version"],s);const l=r(t,["_self"]);l!=null&&a(e,["tunedModelInfo"],uu(l));const u=r(t,["inputTokenLimit"]);u!=null&&a(e,["inputTokenLimit"],u);const d=r(t,["outputTokenLimit"]);d!=null&&a(e,["outputTokenLimit"],d);const c=r(t,["supportedGenerationMethods"]);c!=null&&a(e,["supportedActions"],c);const f=r(t,["temperature"]);f!=null&&a(e,["temperature"],f);const h=r(t,["maxTemperature"]);h!=null&&a(e,["maxTemperature"],h);const p=r(t,["topP"]);p!=null&&a(e,["topP"],p);const m=r(t,["topK"]);m!=null&&a(e,["topK"],m);const T=r(t,["thinking"]);return T!=null&&a(e,["thinking"],T),e}function Lt(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["displayName"]);o!=null&&a(e,["displayName"],o);const i=r(t,["description"]);i!=null&&a(e,["description"],i);const s=r(t,["versionId"]);s!=null&&a(e,["version"],s);const l=r(t,["deployedModels"]);if(l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>sl(p))),a(e,["endpoints"],h)}const u=r(t,["labels"]);u!=null&&a(e,["labels"],u);const d=r(t,["_self"]);d!=null&&a(e,["tunedModelInfo"],du(d));const c=r(t,["defaultCheckpointId"]);c!=null&&a(e,["defaultCheckpointId"],c);const f=r(t,["checkpoints"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(p=>p)),a(e,["checkpoints"],h)}return e}function Kl(t){const e={},n=r(t,["mediaResolution"]);n!=null&&a(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&a(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&a(e,["executableCode"],i);const s=r(t,["fileData"]);s!=null&&a(e,["fileData"],al(s));const l=r(t,["functionCall"]);l!=null&&a(e,["functionCall"],ll(l));const u=r(t,["functionResponse"]);u!=null&&a(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&a(e,["inlineData"],ba(d));const c=r(t,["text"]);c!=null&&a(e,["text"],c);const f=r(t,["thought"]);f!=null&&a(e,["thought"],f);const h=r(t,["thoughtSignature"]);h!=null&&a(e,["thoughtSignature"],h);const p=r(t,["videoMetadata"]);return p!=null&&a(e,["videoMetadata"],p),e}function Yl(t){const e={},n=r(t,["productImage"]);return n!=null&&a(e,["image"],be(n)),e}function Zl(t,e){const n={},o=r(t,["numberOfImages"]);e!==void 0&&o!=null&&a(e,["parameters","sampleCount"],o);const i=r(t,["baseSteps"]);e!==void 0&&i!=null&&a(e,["parameters","baseSteps"],i);const s=r(t,["outputGcsUri"]);e!==void 0&&s!=null&&a(e,["parameters","storageUri"],s);const l=r(t,["seed"]);e!==void 0&&l!=null&&a(e,["parameters","seed"],l);const u=r(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&a(e,["parameters","safetySetting"],u);const d=r(t,["personGeneration"]);e!==void 0&&d!=null&&a(e,["parameters","personGeneration"],d);const c=r(t,["addWatermark"]);e!==void 0&&c!=null&&a(e,["parameters","addWatermark"],c);const f=r(t,["outputMimeType"]);e!==void 0&&f!=null&&a(e,["parameters","outputOptions","mimeType"],f);const h=r(t,["outputCompressionQuality"]);e!==void 0&&h!=null&&a(e,["parameters","outputOptions","compressionQuality"],h);const p=r(t,["enhancePrompt"]);e!==void 0&&p!=null&&a(e,["parameters","enhancePrompt"],p);const m=r(t,["labels"]);return e!==void 0&&m!=null&&a(e,["labels"],m),n}function Xl(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["source"]);i!=null&&jl(i,n);const s=r(e,["config"]);return s!=null&&Zl(s,n),n}function Ql(t){const e={},n=r(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Et(i))),a(e,["generatedImages"],o)}return e}function jl(t,e){const n={},o=r(t,["prompt"]);e!==void 0&&o!=null&&a(e,["instances[0]","prompt"],o);const i=r(t,["personImage"]);e!==void 0&&i!=null&&a(e,["instances[0]","personImage","image"],be(i));const s=r(t,["productImages"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>Yl(u))),a(e,["instances[0]","productImages"],l)}return n}function eu(t){const e={},n=r(t,["referenceImage"]);n!=null&&a(e,["referenceImage"],be(n));const o=r(t,["referenceId"]);o!=null&&a(e,["referenceId"],o);const i=r(t,["referenceType"]);i!=null&&a(e,["referenceType"],i);const s=r(t,["maskImageConfig"]);s!=null&&a(e,["maskImageConfig"],Wl(s));const l=r(t,["controlImageConfig"]);l!=null&&a(e,["controlImageConfig"],Va(l));const u=r(t,["styleImageConfig"]);u!=null&&a(e,["styleImageConfig"],u);const d=r(t,["subjectImageConfig"]);return d!=null&&a(e,["subjectImageConfig"],d),e}function oi(t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const o=r(t,["safetyAttributes","scores"]);o!=null&&a(e,["scores"],o);const i=r(t,["contentType"]);return i!=null&&a(e,["contentType"],i),e}function ii(t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const o=r(t,["safetyAttributes","scores"]);o!=null&&a(e,["scores"],o);const i=r(t,["contentType"]);return i!=null&&a(e,["contentType"],i),e}function tu(t){const e={},n=r(t,["category"]);if(n!=null&&a(e,["category"],n),r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=r(t,["threshold"]);return o!=null&&a(e,["threshold"],o),e}function nu(t){const e={},n=r(t,["image"]);return n!=null&&a(e,["image"],be(n)),e}function ou(t,e){const n={},o=r(t,["mode"]);e!==void 0&&o!=null&&a(e,["parameters","mode"],o);const i=r(t,["maxPredictions"]);e!==void 0&&i!=null&&a(e,["parameters","maxPredictions"],i);const s=r(t,["confidenceThreshold"]);e!==void 0&&s!=null&&a(e,["parameters","confidenceThreshold"],s);const l=r(t,["maskDilation"]);e!==void 0&&l!=null&&a(e,["parameters","maskDilation"],l);const u=r(t,["binaryColorThreshold"]);e!==void 0&&u!=null&&a(e,["parameters","binaryColorThreshold"],u);const d=r(t,["labels"]);return e!==void 0&&d!=null&&a(e,["labels"],d),n}function iu(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["source"]);i!=null&&su(i,n);const s=r(e,["config"]);return s!=null&&ou(s,n),n}function ru(t){const e={},n=r(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>xl(i))),a(e,["generatedMasks"],o)}return e}function su(t,e){const n={},o=r(t,["prompt"]);e!==void 0&&o!=null&&a(e,["instances[0]","prompt"],o);const i=r(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],be(i));const s=r(t,["scribbleImage"]);return e!==void 0&&s!=null&&a(e,["instances[0]","scribble"],nu(s)),n}function au(t){const e={},n=r(t,["retrievalConfig"]);n!=null&&a(e,["retrievalConfig"],n);const o=r(t,["functionCallingConfig"]);return o!=null&&a(e,["functionCallingConfig"],ul(o)),e}function lu(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&a(e,["computerUse"],n);const o=r(t,["fileSearch"]);o!=null&&a(e,["fileSearch"],o);const i=r(t,["codeExecution"]);if(i!=null&&a(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=r(t,["functionDeclarations"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(h=>h)),a(e,["functionDeclarations"],f)}const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],Ll(l));const u=r(t,["googleSearch"]);u!=null&&a(e,["googleSearch"],Fl(u));const d=r(t,["googleSearchRetrieval"]);d!=null&&a(e,["googleSearchRetrieval"],d);const c=r(t,["urlContext"]);return c!=null&&a(e,["urlContext"],c),e}function ri(t){const e={},n=r(t,["retrieval"]);n!=null&&a(e,["retrieval"],n);const o=r(t,["computerUse"]);if(o!=null&&a(e,["computerUse"],o),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(t,["codeExecution"]);i!=null&&a(e,["codeExecution"],i);const s=r(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],s);const l=r(t,["functionDeclarations"]);if(l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>dl(p))),a(e,["functionDeclarations"],h)}const u=r(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],u);const d=r(t,["googleSearch"]);d!=null&&a(e,["googleSearch"],d);const c=r(t,["googleSearchRetrieval"]);c!=null&&a(e,["googleSearchRetrieval"],c);const f=r(t,["urlContext"]);return f!=null&&a(e,["urlContext"],f),e}function uu(t){const e={},n=r(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const o=r(t,["createTime"]);o!=null&&a(e,["createTime"],o);const i=r(t,["updateTime"]);return i!=null&&a(e,["updateTime"],i),e}function du(t){const e={},n=r(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(e,["baseModel"],n);const o=r(t,["createTime"]);o!=null&&a(e,["createTime"],o);const i=r(t,["updateTime"]);return i!=null&&a(e,["updateTime"],i),e}function cu(t,e){const n={},o=r(t,["displayName"]);e!==void 0&&o!=null&&a(e,["displayName"],o);const i=r(t,["description"]);e!==void 0&&i!=null&&a(e,["description"],i);const s=r(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&a(e,["defaultCheckpointId"],s),n}function fu(t,e){const n={},o=r(t,["displayName"]);e!==void 0&&o!=null&&a(e,["displayName"],o);const i=r(t,["description"]);e!==void 0&&i!=null&&a(e,["description"],i);const s=r(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&a(e,["defaultCheckpointId"],s),n}function pu(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","name"],me(t,o));const i=r(e,["config"]);return i!=null&&cu(i,n),n}function hu(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["config"]);return i!=null&&fu(i,n),n}function mu(t,e){const n={},o=r(t,["outputGcsUri"]);e!==void 0&&o!=null&&a(e,["parameters","storageUri"],o);const i=r(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&a(e,["parameters","safetySetting"],i);const s=r(t,["personGeneration"]);e!==void 0&&s!=null&&a(e,["parameters","personGeneration"],s);const l=r(t,["includeRaiReason"]);e!==void 0&&l!=null&&a(e,["parameters","includeRaiReason"],l);const u=r(t,["outputMimeType"]);e!==void 0&&u!=null&&a(e,["parameters","outputOptions","mimeType"],u);const d=r(t,["outputCompressionQuality"]);e!==void 0&&d!=null&&a(e,["parameters","outputOptions","compressionQuality"],d);const c=r(t,["enhanceInputImage"]);e!==void 0&&c!=null&&a(e,["parameters","upscaleConfig","enhanceInputImage"],c);const f=r(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&a(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const h=r(t,["labels"]);e!==void 0&&h!=null&&a(e,["labels"],h);const p=r(t,["numberOfImages"]);e!==void 0&&p!=null&&a(e,["parameters","sampleCount"],p);const m=r(t,["mode"]);return e!==void 0&&m!=null&&a(e,["parameters","mode"],m),n}function gu(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["_url","model"],me(t,o));const i=r(e,["image"]);i!=null&&a(n,["instances[0]","image"],be(i));const s=r(e,["upscaleFactor"]);s!=null&&a(n,["parameters","upscaleConfig","upscaleFactor"],s);const l=r(e,["config"]);return l!=null&&mu(l,n),n}function vu(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>Et(s))),a(e,["generatedImages"],i)}return e}function yu(t){const e={},n=r(t,["uri"]);n!=null&&a(e,["uri"],n);const o=r(t,["encodedVideo"]);o!=null&&a(e,["videoBytes"],Be(o));const i=r(t,["encoding"]);return i!=null&&a(e,["mimeType"],i),e}function _u(t){const e={},n=r(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const o=r(t,["bytesBase64Encoded"]);o!=null&&a(e,["videoBytes"],Be(o));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Eu(t){const e={},n=r(t,["image"]);n!=null&&a(e,["_self"],be(n));const o=r(t,["maskMode"]);return o!=null&&a(e,["maskMode"],o),e}function Tu(t){const e={},n=r(t,["image"]);n!=null&&a(e,["image"],Tt(n));const o=r(t,["referenceType"]);return o!=null&&a(e,["referenceType"],o),e}function Cu(t){const e={},n=r(t,["image"]);n!=null&&a(e,["image"],be(n));const o=r(t,["referenceType"]);return o!=null&&a(e,["referenceType"],o),e}function si(t){const e={},n=r(t,["uri"]);n!=null&&a(e,["uri"],n);const o=r(t,["videoBytes"]);o!=null&&a(e,["encodedVideo"],Be(o));const i=r(t,["mimeType"]);return i!=null&&a(e,["encoding"],i),e}function ai(t){const e={},n=r(t,["uri"]);n!=null&&a(e,["gcsUri"],n);const o=r(t,["videoBytes"]);o!=null&&a(e,["bytesBase64Encoded"],Be(o));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Su(t,e){const n={},o=r(t,["displayName"]);return e!==void 0&&o!=null&&a(e,["displayName"],o),n}function Iu(t){const e={},n=r(t,["config"]);return n!=null&&Su(n,e),e}function wu(t,e){const n={},o=r(t,["force"]);return e!==void 0&&o!=null&&a(e,["_query","force"],o),n}function Au(t){const e={},n=r(t,["name"]);n!=null&&a(e,["_url","name"],n);const o=r(t,["config"]);return o!=null&&wu(o,e),e}function Ru(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function ku(t,e){const n={},o=r(t,["customMetadata"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>l)),a(e,["customMetadata"],s)}const i=r(t,["chunkingConfig"]);return e!==void 0&&i!=null&&a(e,["chunkingConfig"],i),n}function Pu(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const o=r(t,["metadata"]);o!=null&&a(e,["metadata"],o);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const s=r(t,["error"]);s!=null&&a(e,["error"],s);const l=r(t,["response"]);return l!=null&&a(e,["response"],Mu(l)),e}function xu(t){const e={},n=r(t,["fileSearchStoreName"]);n!=null&&a(e,["_url","file_search_store_name"],n);const o=r(t,["fileName"]);o!=null&&a(e,["fileName"],o);const i=r(t,["config"]);return i!=null&&ku(i,e),e}function Mu(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["parent"]);o!=null&&a(e,["parent"],o);const i=r(t,["documentName"]);return i!=null&&a(e,["documentName"],i),e}function Nu(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&a(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function bu(t){const e={},n=r(t,["config"]);return n!=null&&Nu(n,e),e}function Du(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),a(e,["fileSearchStores"],s)}return e}function li(t,e){const n={},o=r(t,["mimeType"]);e!==void 0&&o!=null&&a(e,["mimeType"],o);const i=r(t,["displayName"]);e!==void 0&&i!=null&&a(e,["displayName"],i);const s=r(t,["customMetadata"]);if(e!==void 0&&s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),a(e,["customMetadata"],u)}const l=r(t,["chunkingConfig"]);return e!==void 0&&l!=null&&a(e,["chunkingConfig"],l),n}function Uu(t){const e={},n=r(t,["fileSearchStoreName"]);n!=null&&a(e,["_url","file_search_store_name"],n);const o=r(t,["config"]);return o!=null&&li(o,e),e}function Lu(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fu="Content-Type",Gu="X-Server-Timeout",Bu="User-Agent",Ft="x-goog-api-client",Vu="1.38.0",Hu=`google-genai-sdk/${Vu}`,qu="v1beta1",zu="v1beta";class Ou{constructor(e){var n,o,i;this.clientOptions=Object.assign({},e),this.customBaseUrl=(n=e.httpOptions)===null||n===void 0?void 0:n.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const s={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const u=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!u?(s.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?s.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(s.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),s.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:qu}else{if(!this.clientOptions.apiKey)throw new tt({message:"API key must be set when using the Gemini API.",status:403});s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:zu,s.baseUrl="https://generativelanguage.googleapis.com/"}s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const o=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&o.push(e.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,o){const i=[this.getRequestUrlInternal(n)];return o&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e,n){return!(n.baseUrl&&n.baseUrlResourceScope===Mt.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e,n),i=this.constructUrl(e.path,n,o);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))i.searchParams.append(l,String(u));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const o=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?o[i]=Object.assign(Object.assign({},o[i]),s):s!==void 0&&(o[i]=s);return o}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e,n),i=this.constructUrl(e.path,n,o);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,o,i){if(n&&n.timeout||i){const s=new AbortController,l=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const u=setTimeout(()=>s.abort(),n.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=l}return n&&n.extraBody!==null&&Ju(e,n.extraBody),e.headers=await this.getHeadersInternal(n,o),e}async unaryApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async i=>(await Io(i),new Nt(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async i=>(await Io(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return Me(this,arguments,function*(){var o;const i=(o=e==null?void 0:e.body)===null||o===void 0?void 0:o.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";const u="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:c,value:f}=yield ue(i.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=s.decode(f,{stream:!0});try{const T=JSON.parse(h);if("error"in T){const v=JSON.parse(JSON.stringify(T.error)),_=v.status,E=v.code,S=`got status: ${_}. ${JSON.stringify(T)}`;if(E>=400&&E<600)throw new tt({message:S,status:E})}}catch(T){if(T.name==="ApiError")throw T}l+=h;let p=-1,m=0;for(;;){p=-1,m=0;for(const _ of d){const E=l.indexOf(_);E!==-1&&(p===-1||E<p)&&(p=E,m=_.length)}if(p===-1)break;const T=l.substring(0,p);l=l.substring(p+m);const v=T.trim();if(v.startsWith(u)){const _=v.substring(u.length).trim();try{const E=new Response(_,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ue(new Nt(E))}catch(E){throw new Error(`exception parsing stream chunk ${_}. ${E}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(o=>{throw new Error(`exception ${o} sending request`)})}getDefaultHeaders(){const e={},n=Hu+" "+this.clientOptions.userAgentExtra;return e[Bu]=n,e[Ft]=n,e[Fu]="application/json",e}async getHeadersInternal(e,n){const o=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))o.append(i,s);e.timeout&&e.timeout>0&&o.append(Gu,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(o,n),o}getFileName(e){var n;let o="";return typeof e=="string"&&(o=e.replace(/[/\\]+$/,""),o=(n=o.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),o}async uploadFile(e,n){var o;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,l=await s.stat(e);i.sizeBytes=String(l.size);const u=(o=n==null?void 0:n.mimeType)!==null&&o!==void 0?o:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const d={file:i},c=this.getFileName(e),f=ee("upload/v1beta/files",d._url),h=await this.fetchUploadUrl(f,i.sizeBytes,i.mimeType,c,d,n==null?void 0:n.httpOptions);return s.upload(e,h,this)}async uploadFileToFileSearchStore(e,n,o){var i;const s=this.clientOptions.uploader,l=await s.stat(n),u=String(l.size),d=(i=o==null?void 0:o.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const c=`upload/v1beta/${e}:uploadToFileSearchStore`,f=this.getFileName(n),h={};o!=null&&li(o,h);const p=await this.fetchUploadUrl(c,u,d,f,h,o==null?void 0:o.httpOptions);return s.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,o,i,s,l){var u;let d={};l?d=l:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${o}`},i?{"X-Goog-Upload-File-Name":i}:{})};const c=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:d});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(u=c==null?void 0:c.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function Io(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let o;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?o=await t.json():o={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(o);throw n>=400&&n<600?new tt({message:i,status:n}):new Error(i)}}function Ju(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function o(s,l){const u=Object.assign({},s);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const c=l[d],f=u[d];c&&typeof c=="object"&&!Array.isArray(c)&&f&&typeof f=="object"&&!Array.isArray(f)?u[d]=o(f,c):(f&&c&&typeof f!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof f}, New type: ${typeof c}. Overwriting.`),u[d]=c)}return u}const i=o(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $u="mcp_used/unknown";let Wu=!1;function ui(t){for(const e of t)if(Ku(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Wu}function di(t){var e;const n=(e=t[Ft])!==null&&e!==void 0?e:"";t[Ft]=(n+` ${$u}`).trimStart()}function Ku(t){return t!==null&&typeof t=="object"&&t instanceof Xt}function Yu(t){return Me(this,arguments,function*(n,o=100){let i,s=0;for(;s<o;){const l=yield ue(n.listTools({cursor:i}));for(const u of l.tools)yield yield ue(u),s++;if(!l.nextCursor)break;i=l.nextCursor}})}class Xt{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Xt(e,n)}async initialize(){var e,n,o,i;if(this.mcpTools.length>0)return;const s={},l=[];for(const f of this.mcpClients)try{for(var u=!0,d=(n=void 0,Ne(Yu(f))),c;c=await d.next(),e=c.done,!e;u=!0){i=c.value,u=!1;const h=i;l.push(h);const p=h.name;if(s[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);s[p]=f}}catch(h){n={error:h}}finally{try{!u&&!e&&(o=d.return)&&await o.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),Ar(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const o of e)if(o.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[o.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const l=await i.callTool({name:o.name,arguments:o.args},void 0,s);n.push({functionResponse:{name:o.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Zu(t,e,n){const o=new yr;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(o,i),e(o)}class Xu{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o}async connect(e){var n,o;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),l=ed(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${u}`;let c=()=>{};const f=new Promise(R=>{c=R}),h=e.callbacks,p=function(){c({})},m=this.apiClient,T={onopen:p,onmessage:R=>{Zu(m,h.onmessage,R)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(R){},onclose:(o=h==null?void 0:h.onclose)!==null&&o!==void 0?o:function(R){}},v=this.webSocketFactory.create(d,ju(l),T);v.connect(),await f;const S={setup:{model:me(this.apiClient,e.model)}};return v.send(JSON.stringify(S)),new Qu(v,this.apiClient)}}class Qu{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Sa(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=Ca(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Oe.PLAY)}pause(){this.sendPlaybackControl(Oe.PAUSE)}stop(){this.sendPlaybackControl(Oe.STOP)}resetContext(){this.sendPlaybackControl(Oe.RESET_CONTEXT)}close(){this.conn.close()}}function ju(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function ed(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const td="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function nd(t,e,n){const o=new vr;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const l=Aa(s);Object.assign(o,l)}else Object.assign(o,s);e(o)}class od{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o,this.music=new Xu(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,o,i,s,l,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let f;const h=this.apiClient.getHeaders();e.config&&e.config.tools&&ui(e.config.tools)&&di(h);const p=ad(h);if(this.apiClient.isVertexAI()){const C=this.apiClient.getProject(),M=this.apiClient.getLocation(),z=this.apiClient.getApiKey(),w=!!C&&!!M||!!z;this.apiClient.getCustomBaseUrl()&&!w?f=d:(f=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,f))}else{const C=this.apiClient.getApiKey();let M="BidiGenerateContent",z="key";C!=null&&C.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),M="BidiGenerateContentConstrained",z="access_token"),f=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.${M}?${z}=${C}`}let m=()=>{};const T=new Promise(C=>{m=C}),v=e.callbacks,_=function(){var C;(C=v==null?void 0:v.onopen)===null||C===void 0||C.call(v),m({})},E=this.apiClient,S={onopen:_,onmessage:C=>{nd(E,v.onmessage,C)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(C){},onclose:(o=v==null?void 0:v.onclose)!==null&&o!==void 0?o:function(C){}},R=this.webSocketFactory.create(f,sd(p),S);R.connect(),await T;let P=me(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const C=this.apiClient.getProject(),M=this.apiClient.getLocation();C&&M&&(P=`projects/${C}/locations/${M}/`+P)}let x={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[pt.AUDIO]}:e.config.responseModalities=[pt.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const B=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],U=[];for(const C of B)if(this.isCallableTool(C)){const M=C;U.push(await M.tool())}else U.push(C);U.length>0&&(e.config.tools=U);const A={model:P,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?x=Ta(this.apiClient,A):x=Ea(this.apiClient,A),delete x.config,R.send(JSON.stringify(x)),new rd(R,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const id={turnComplete:!0};class rd{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let o=[];try{o=Pe(n.turns),e.isVertexAI()||(o=o.map(i=>_t(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:o,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let o=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?o=n.functionResponses:o=[n.functionResponses],o.length===0)throw new Error("functionResponses is required.");for(const s of o){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(td)}return{toolResponse:{functionResponses:o}}}sendClientContent(e){e=Object.assign(Object.assign({},id),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:wa(e)}:n={realtimeInput:Ia(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function sd(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function ad(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wo=10;function Ao(t){var e,n,o;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(We(l)){i=!0;break}if(!i)return!0;const s=(o=t==null?void 0:t.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function We(t){return"callTool"in t&&typeof t.callTool=="function"}function ld(t){var e,n,o;return(o=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>We(i)))!==null&&o!==void 0?o:!1}function Ro(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((o,i)=>{if(We(o))return;const s=o;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(i)}),n}function ko(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ud extends Ue{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var o,i,s,l,u;const d=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!ld(n)||Ao(n.config))return await this.generateContentInternal(d);const c=Ro(n);if(c.length>0){const v=c.map(_=>`tools[${_}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${v}.`)}let f,h;const p=Pe(d.contents),m=(s=(i=(o=d.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:wo;let T=0;for(;T<m&&(f=await this.generateContentInternal(d),!(!f.functionCalls||f.functionCalls.length===0));){const v=f.candidates[0].content,_=[];for(const E of(u=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(We(E)){const R=await E.callTool(f.functionCalls);_.push(...R)}T++,h={role:"user",parts:_},d.contents=Pe(d.contents),d.contents.push(v),d.contents.push(h),ko(d.config)&&(p.push(v),p.push(h))}return ko(d.config)&&(f.automaticFunctionCallingHistory=p),f},this.generateContentStream=async n=>{var o,i,s,l,u;if(this.maybeMoveToResponseJsonSchem(n),Ao(n.config)){const h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}const d=Ro(n);if(d.length>0){const h=d.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const c=(s=(i=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,f=(u=(l=n==null?void 0:n.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(c&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(o=>{var i;let s;const l=[];if(o!=null&&o.generatedImages)for(const d of o.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:l.push(d);let u;return s?u={generatedImages:l,positivePromptSafetyAttributes:s,sdkHttpResponse:o.sdkHttpResponse}:u={generatedImages:l,sdkHttpResponse:o.sdkHttpResponse},u}),this.list=async n=>{var o;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((o=l.config)===null||o===void 0)&&o.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new He(De.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async n=>{const o={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(o.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(o)},this.upscaleImage=async n=>{let o={numberOfImages:1,mode:"upscale"};n.config&&(o=Object.assign(Object.assign({},o),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:o};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var o,i,s,l,u,d;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((o=n.video)===null||o===void 0)&&o.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((l=(s=n.source)===null||s===void 0?void 0:s.video)===null||l===void 0)&&l.uri&&(!((d=(u=n.source)===null||u===void 0?void 0:u.video)===null||d===void 0)&&d.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,o,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const l=await Promise.all(s.map(async d=>We(d)?await d.tool():d)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(u.config.tools=l,e.config&&e.config.tools&&ui(e.config.tools)){const d=(i=(o=e.config.httpOptions)===null||o===void 0?void 0:o.headers)!==null&&i!==void 0?i:{};let c=Object.assign({},d);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),di(c),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return u}async initAfcToolsMap(e){var n,o,i;const s=new Map;for(const l of(o=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&o!==void 0?o:[])if(We(l)){const u=l,d=await u.tool();for(const c of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!c.name)throw new Error("Function declaration name is required.");if(s.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);s.set(c.name,u)}}return s}async processAfcStream(e){var n,o,i;const s=(i=(o=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&i!==void 0?i:wo;let l=!1,u=0;const d=await this.initAfcToolsMap(e);return(function(c,f,h){return Me(this,arguments,function*(){for(var p,m,T,v,_,E;u<s;){l&&(u++,l=!1);const x=yield ue(c.processParamsMaybeAddMcpUsage(h)),B=yield ue(c.generateContentStreamInternal(x)),U=[],A=[];try{for(var S=!0,R=(m=void 0,Ne(B)),P;P=yield ue(R.next()),p=P.done,!p;S=!0){v=P.value,S=!1;const C=v;if(yield yield ue(C),C.candidates&&(!((_=C.candidates[0])===null||_===void 0)&&_.content)){A.push(C.candidates[0].content);for(const M of(E=C.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(u<s&&M.functionCall){if(!M.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(M.functionCall.name)){const z=yield ue(f.get(M.functionCall.name).callTool([M.functionCall]));U.push(...z)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${M.functionCall.name}`)}}}}catch(C){m={error:C}}finally{try{!S&&!p&&(T=R.return)&&(yield ue(T.call(R)))}finally{if(m)throw m.error}}if(U.length>0){l=!0;const C=new Qe;C.candidates=[{content:{role:"user",parts:U}}],yield yield ue(C);const M=[];M.push(...A),M.push({role:"user",parts:U});const z=Pe(h.contents).concat(M);h.contents=z}else break}})})(this,d,e)}async generateContentInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=To(this.apiClient,e);return u=ee("{model}:generateContent",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=So(f),p=new Qe;return Object.assign(p,h),p})}else{const c=Eo(this.apiClient,e);return u=ee("{model}:generateContent",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=Co(f),p=new Qe;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=To(this.apiClient,e);return u=ee("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(h){return Me(this,arguments,function*(){var p,m,T,v;try{for(var _=!0,E=Ne(h),S;S=yield ue(E.next()),p=S.done,!p;_=!0){v=S.value,_=!1;const R=v,P=So(yield ue(R.json()));P.sdkHttpResponse={headers:R.headers};const x=new Qe;Object.assign(x,P),yield yield ue(x)}}catch(R){m={error:R}}finally{try{!_&&!p&&(T=E.return)&&(yield ue(T.call(E)))}finally{if(m)throw m.error}}})})}else{const c=Eo(this.apiClient,e);return u=ee("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(h){return Me(this,arguments,function*(){var p,m,T,v;try{for(var _=!0,E=Ne(h),S;S=yield ue(E.next()),p=S.done,!p;_=!0){v=S.value,_=!1;const R=v,P=Co(yield ue(R.json()));P.sdkHttpResponse={headers:R.headers};const x=new Qe;Object.assign(x,P),yield yield ue(x)}}catch(R){m={error:R}}finally{try{!_&&!p&&(T=E.return)&&(yield ue(T.call(E)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ol(this.apiClient,e);return u=ee("{model}:predict",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=rl(f),p=new no;return Object.assign(p,h),p})}else{const c=nl(this.apiClient,e);return u=ee("{model}:batchEmbedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=il(f),p=new no;return Object.assign(p,h),p})}}async generateImagesInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=gl(this.apiClient,e);return u=ee("{model}:predict",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=yl(f),p=new oo;return Object.assign(p,h),p})}else{const c=ml(this.apiClient,e);return u=ee("{model}:predict",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=vl(f),p=new oo;return Object.assign(p,h),p})}}async editImageInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Qa(this.apiClient,e);return s=ee("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:d.headers},f})),i.then(d=>{const c=ja(d),f=new sr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=gu(this.apiClient,e);return s=ee("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:d.headers},f})),i.then(d=>{const c=vu(d),f=new ar;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Xl(this.apiClient,e);return s=ee("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Ql(d),f=new lr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=iu(this.apiClient,e);return s=ee("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=ru(d),f=new ur;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ul(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>Lt(f))}else{const c=Dl(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>Ut(f))}}async listInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ol(this.apiClient,e);return u=ee("{models_url}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=$l(f),p=new io;return Object.assign(p,h),p})}else{const c=zl(this.apiClient,e);return u=ee("{models_url}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=Jl(f),p=new io;return Object.assign(p,h),p})}}async update(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=hu(this.apiClient,e);return u=ee("{model}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>Lt(f))}else{const c=pu(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>Ut(f))}}async delete(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ka(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=Za(f),p=new ro;return Object.assign(p,h),p})}else{const c=Wa(this.apiClient,e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=Ya(f),p=new ro;return Object.assign(p,h),p})}}async countTokens(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Oa(this.apiClient,e);return u=ee("{model}:countTokens",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=$a(f),p=new so;return Object.assign(p,h),p})}else{const c=za(this.apiClient,e);return u=ee("{model}:countTokens",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=Ja(f),p=new so;return Object.assign(p,h),p})}}async computeTokens(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=La(this.apiClient,e);return s=ee("{model}:computeTokens",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:d.headers},f})),i.then(d=>{const c=Fa(d),f=new dr;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Il(this.apiClient,e);return u=ee("{model}:predictLongRunning",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Cl(f),p=new ht;return Object.assign(p,h),p})}else{const c=Sl(this.apiClient,e);return u=ee("{model}:predictLongRunning",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l.then(f=>{const h=Tl(f),p=new ht;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dd extends Ue{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;o&&"httpOptions"in o&&(s=o.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;o&&"httpOptions"in o&&(s=o.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=er(e);return u=ee("{operationName}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l}else{const c=ji(e);return u=ee("{operationName}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),l}}async fetchPredictVideosOperationInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=$i(e);return s=ee("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cd(t){const e={},n=r(t,["data"]);if(n!=null&&a(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function fd(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Td(s))),a(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&a(e,["role"],o),e}function pd(t,e,n){const o={},i=r(e,["expireTime"]);n!==void 0&&i!=null&&a(n,["expireTime"],i);const s=r(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&a(n,["newSessionExpireTime"],s);const l=r(e,["uses"]);n!==void 0&&l!=null&&a(n,["uses"],l);const u=r(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&a(n,["bidiGenerateContentSetup"],Ed(t,u));const d=r(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&a(n,["fieldMask"],d),o}function hd(t,e){const n={},o=r(e,["config"]);return o!=null&&a(n,["config"],pd(t,o,n)),n}function md(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&a(e,["mimeType"],o),e}function gd(t){const e={},n=r(t,["id"]);n!=null&&a(e,["id"],n);const o=r(t,["args"]);o!=null&&a(e,["args"],o);const i=r(t,["name"]);if(i!=null&&a(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function vd(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function yd(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&a(e,["timeRangeFilter"],n),e}function _d(t,e){const n={},o=r(t,["generationConfig"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig"],o);const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const s=r(t,["temperature"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","temperature"],s);const l=r(t,["topP"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","topP"],l);const u=r(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const d=r(t,["maxOutputTokens"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","maxOutputTokens"],d);const c=r(t,["mediaResolution"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","mediaResolution"],c);const f=r(t,["seed"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","seed"],f);const h=r(t,["speechConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","speechConfig"],Zt(h));const p=r(t,["thinkingConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","thinkingConfig"],p);const m=r(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const T=r(t,["systemInstruction"]);e!==void 0&&T!=null&&a(e,["setup","systemInstruction"],fd(Ie(T)));const v=r(t,["tools"]);if(e!==void 0&&v!=null){let B=Ye(v);Array.isArray(B)&&(B=B.map(U=>Sd(Ke(U)))),a(e,["setup","tools"],B)}const _=r(t,["sessionResumption"]);e!==void 0&&_!=null&&a(e,["setup","sessionResumption"],Cd(_));const E=r(t,["inputAudioTranscription"]);e!==void 0&&E!=null&&a(e,["setup","inputAudioTranscription"],E);const S=r(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&a(e,["setup","outputAudioTranscription"],S);const R=r(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&a(e,["setup","realtimeInputConfig"],R);const P=r(t,["contextWindowCompression"]);e!==void 0&&P!=null&&a(e,["setup","contextWindowCompression"],P);const x=r(t,["proactivity"]);if(e!==void 0&&x!=null&&a(e,["setup","proactivity"],x),r(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function Ed(t,e){const n={},o=r(e,["model"]);o!=null&&a(n,["setup","model"],me(t,o));const i=r(e,["config"]);return i!=null&&a(n,["config"],_d(i,n)),n}function Td(t){const e={},n=r(t,["mediaResolution"]);n!=null&&a(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&a(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&a(e,["executableCode"],i);const s=r(t,["fileData"]);s!=null&&a(e,["fileData"],md(s));const l=r(t,["functionCall"]);l!=null&&a(e,["functionCall"],gd(l));const u=r(t,["functionResponse"]);u!=null&&a(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&a(e,["inlineData"],cd(d));const c=r(t,["text"]);c!=null&&a(e,["text"],c);const f=r(t,["thought"]);f!=null&&a(e,["thought"],f);const h=r(t,["thoughtSignature"]);h!=null&&a(e,["thoughtSignature"],h);const p=r(t,["videoMetadata"]);return p!=null&&a(e,["videoMetadata"],p),e}function Cd(t){const e={},n=r(t,["handle"]);if(n!=null&&a(e,["handle"],n),r(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Sd(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&a(e,["computerUse"],n);const o=r(t,["fileSearch"]);o!=null&&a(e,["fileSearch"],o);const i=r(t,["codeExecution"]);if(i!=null&&a(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=r(t,["functionDeclarations"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(h=>h)),a(e,["functionDeclarations"],f)}const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],vd(l));const u=r(t,["googleSearch"]);u!=null&&a(e,["googleSearch"],yd(u));const d=r(t,["googleSearchRetrieval"]);d!=null&&a(e,["googleSearchRetrieval"],d);const c=r(t,["urlContext"]);return c!=null&&a(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Id(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const o=t[n];if(typeof o=="object"&&o!=null&&Object.keys(o).length>0){const i=Object.keys(o).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function wd(t,e){let n=null;const o=t.bidiGenerateContentSetup;if(typeof o=="object"&&o!==null&&"setup"in o){const s=o.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else o!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=Id(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];i.length>0&&(u=i.map(c=>l.includes(c)?`generationConfig.${c}`:c));const d=[];s&&d.push(s),u.length>0&&d.push(...u),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class Ad extends Ue{constructor(e){super(),this.apiClient=e}async create(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=hd(this.apiClient,e);s=ee("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const d=wd(u,e.config);return i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),i.then(c=>c)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rd(t,e){const n={},o=r(t,["force"]);return e!==void 0&&o!=null&&a(e,["_query","force"],o),n}function kd(t){const e={},n=r(t,["name"]);n!=null&&a(e,["_url","name"],n);const o=r(t,["config"]);return o!=null&&Rd(o,e),e}function Pd(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function xd(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&a(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function Md(t){const e={},n=r(t,["parent"]);n!=null&&a(e,["_url","parent"],n);const o=r(t,["config"]);return o!=null&&xd(o,e),e}function Nd(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&a(e,["nextPageToken"],o);const i=r(t,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),a(e,["documents"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bd extends Ue{constructor(e){super(),this.apiClient=e,this.list=async n=>new He(De.PAGED_ITEM_DOCUMENTS,o=>this.listInternal({parent:n.parent,config:o.config}),await this.listInternal(n),n)}async get(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Pd(e);return s=ee("{name}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var n,o;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=kd(e);i=ee("{name}",l._url),s=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Md(e);return s=ee("{parent}/documents",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Nd(d),f=new cr;return Object.assign(f,c),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Dd extends Ue{constructor(e,n=new bd(e)){super(),this.apiClient=e,this.documents=n,this.list=async(o={})=>new He(De.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(o),o)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Iu(e);return s=ee("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async get(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ru(e);return s=ee("{name}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var n,o;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Au(e);i=ee("{name}",l._url),s=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=bu(e);return s=ee("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Du(d),f=new fr;return Object.assign(f,c),f})}}async uploadToFileSearchStoreInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Uu(e);return s=ee("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Lu(d),f=new pr;return Object.assign(f,c),f})}}async importFile(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=xu(e);return s=ee("{file_search_store_name}:importFile",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Pu(d),f=new Jt;return Object.assign(f,c),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let ci=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return ci=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,o=>(+o^n()&15>>+o/4).toString(16))};const Ud=()=>ci();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gt(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Bt=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xe extends Error{}class Ae extends xe{constructor(e,n,o,i){super(`${Ae.makeMessage(e,n,o)}`),this.status=e,this.headers=i,this.error=n}static makeMessage(e,n,o){const i=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):o;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,o,i){if(!e||!i)return new Ct({message:o,cause:Bt(n)});const s=n;return e===400?new pi(e,s,o,i):e===401?new hi(e,s,o,i):e===403?new mi(e,s,o,i):e===404?new gi(e,s,o,i):e===409?new vi(e,s,o,i):e===422?new yi(e,s,o,i):e===429?new _i(e,s,o,i):e>=500?new Ei(e,s,o,i):new Ae(e,s,o,i)}}class Vt extends Ae{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Ct extends Ae{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class fi extends Ct{constructor({message:e}={}){super({message:e??"Request timed out."})}}class pi extends Ae{}class hi extends Ae{}class mi extends Ae{}class gi extends Ae{}class vi extends Ae{}class yi extends Ae{}class _i extends Ae{}class Ei extends Ae{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ld=/^[a-z][a-z0-9+.-]*:/i,Fd=t=>Ld.test(t);let Ht=t=>(Ht=Array.isArray,Ht(t));const Gd=Ht;let Bd=Gd;const Po=Bd;function Vd(t){if(!t)return!0;for(const e in t)return!1;return!0}function Hd(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const qd=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new xe(`${t} must be an integer`);if(e<0)throw new xe(`${t} must be a positive integer`);return e},zd=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Od=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ze="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jd(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const $d=()=>{var t,e,n,o,i;const s=Jd();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":Mo(Deno.build.os),"X-Stainless-Arch":xo(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":Mo((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":xo((o=globalThis.process.arch)!==null&&o!==void 0?o:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const l=Wd();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ze,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Wd(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const o=n.exec(navigator.userAgent);if(o){const i=o[1]||0,s=o[2]||0,l=o[3]||0;return{browser:e,version:`${i}.${s}.${l}`}}}return null}const xo=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Mo=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let ot;const Kd=()=>ot??(ot=$d());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yd(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Ti(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function Zd(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return Ti({start(){},async pull(n){const{done:o,value:i}=await e.next();o?n.close():n.enqueue(i)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function Ci(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Xd(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const o=t.getReader(),i=o.cancel();o.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qd=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Si=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function wt(t,e,n){return Si(),new File(t,e??"unknown_file",n)}function jd(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const ec=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ii=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",tc=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Ii(t),nc=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function oc(t,e,n){if(Si(),t=await t,tc(t))return t instanceof File?t:wt([await t.arrayBuffer()],t.name);if(nc(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),wt(await qt(i),e,n)}const o=await qt(t);if(e||(e=jd(t)),!(n!=null&&n.type)){const i=o.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof i=="string"&&(n=Object.assign(Object.assign({},n),{type:i}))}return wt(o,e,n)}async function qt(t){var e,n,o,i,s;let l=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)l.push(t);else if(Ii(t))l.push(t instanceof Blob?t:await t.arrayBuffer());else if(ec(t))try{for(var u=!0,d=Ne(t),c;c=await d.next(),e=c.done,!e;u=!0){i=c.value,u=!1;const f=i;l.push(...await qt(f))}}catch(f){n={error:f}}finally{try{!u&&!e&&(o=d.return)&&await o.call(d)}finally{if(n)throw n.error}}else{const f=(s=t==null?void 0:t.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof t}${f?`; constructor: ${f}`:""}${ic(t)}`)}return l}function ic(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wi{constructor(e){this._client=e}}wi._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ai(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const No=Object.freeze(Object.create(null)),rc=(t=Ai)=>(function(n,...o){if(n.length===1)return n[0];let i=!1;const s=[],l=n.reduce((f,h,p)=>{var m,T,v;/[?#]/.test(h)&&(i=!0);const _=o[p];let E=(i?encodeURIComponent:t)(""+_);return p!==o.length&&(_==null||typeof _=="object"&&_.toString===((v=Object.getPrototypeOf((T=Object.getPrototypeOf((m=_.hasOwnProperty)!==null&&m!==void 0?m:No))!==null&&T!==void 0?T:No))===null||v===void 0?void 0:v.toString))&&(E=_+"",s.push({start:f.length+h.length,length:E.length,error:`Value of type ${Object.prototype.toString.call(_).slice(8,-1)} is not a valid path parameter`})),f+h+(p===o.length?"":E)},""),u=l.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=d.exec(u))!==null;)s.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(s.sort((f,h)=>f.start-h.start),s.length>0){let f=0;const h=s.reduce((p,m)=>{const T=" ".repeat(m.start-f),v="^".repeat(m.length);return f=m.start+m.length,p+T+v},"");throw new xe(`Path parameters result in path with invalid segments:
${s.map(p=>p.error).join(`
`)}
${l}
${h}`)}return l}),it=rc(Ai);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ri extends wi{create(e,n){var o;const{api_version:i=this._client.apiVersion}=e,s=gt(e,["api_version"]);if("model"in s&&"agent_config"in s)throw new xe("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new xe("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(it`/${i}/interactions`,Object.assign(Object.assign({body:s},n),{stream:(o=e.stream)!==null&&o!==void 0?o:!1}))}delete(e,n={},o){const{api_version:i=this._client.apiVersion}=n??{};return this._client.delete(it`/${i}/interactions/${e}`,o)}cancel(e,n={},o){const{api_version:i=this._client.apiVersion}=n??{};return this._client.post(it`/${i}/interactions/${e}/cancel`,o)}get(e,n={},o){var i;const s=n??{},{api_version:l=this._client.apiVersion}=s,u=gt(s,["api_version"]);return this._client.get(it`/${l}/interactions/${e}`,Object.assign(Object.assign({query:u},o),{stream:(i=n==null?void 0:n.stream)!==null&&i!==void 0?i:!1}))}}Ri._key=Object.freeze(["interactions"]);class ki extends Ri{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sc(t){let e=0;for(const i of t)e+=i.length;const n=new Uint8Array(e);let o=0;for(const i of t)n.set(i,o),o+=i.length;return n}let rt;function Qt(t){let e;return(rt??(e=new globalThis.TextEncoder,rt=e.encode.bind(e)))(t)}let st;function bo(t){let e;return(st??(e=new globalThis.TextDecoder,st=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class St{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Qt(e):e;this.buffer=sc([this.buffer,n]);const o=[];let i;for(;(i=ac(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){o.push(bo(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,l=bo(this.buffer.subarray(0,s));o.push(l),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return o}flush(){return this.buffer.length?this.decode(`
`):[]}}St.NEWLINE_CHARS=new Set([`
`,"\r"]);St.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ac(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function lc(t){for(let o=0;o<t.length-1;o++){if(t[o]===10&&t[o+1]===10||t[o]===13&&t[o+1]===13)return o+2;if(t[o]===13&&t[o+1]===10&&o+3<t.length&&t[o+2]===13&&t[o+3]===10)return o+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vt={off:0,error:200,warn:300,info:400,debug:500},Do=(t,e,n)=>{if(t){if(Hd(vt,t))return t;we(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(vt))}`)}};function et(){}function at(t,e,n){return!e||vt[t]>vt[n]?et:e[t].bind(e)}const uc={error:et,warn:et,info:et,debug:et};let Uo=new WeakMap;function we(t){var e;const n=t.logger,o=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return uc;const i=Uo.get(n);if(i&&i[0]===o)return i[1];const s={error:at("error",n,o),warn:at("warn",n,o),info:at("info",n,o),debug:at("debug",n,o)};return Uo.set(n,[o,s]),s}const Ve=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Je{constructor(e,n,o){this.iterator=e,this.controller=n,this.client=o}static fromSSEResponse(e,n,o){let i=!1;const s=o?we(o):console;function l(){return Me(this,arguments,function*(){var d,c,f,h;if(i)throw new xe("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let p=!1;try{try{for(var m=!0,T=Ne(dc(e,n)),v;v=yield ue(T.next()),d=v.done,!d;m=!0){h=v.value,m=!1;const _=h;if(!p)if(_.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield ue(JSON.parse(_.data))}catch(E){throw s.error("Could not parse message into JSON:",_.data),s.error("From chunk:",_.raw),E}}}catch(_){c={error:_}}finally{try{!m&&!d&&(f=T.return)&&(yield ue(f.call(T)))}finally{if(c)throw c.error}}p=!0}catch(_){if(Gt(_))return yield ue(void 0);throw _}finally{p||n.abort()}})}return new Je(l,n,o)}static fromReadableStream(e,n,o){let i=!1;function s(){return Me(this,arguments,function*(){var d,c,f,h;const p=new St,m=Ci(e);try{for(var T=!0,v=Ne(m),_;_=yield ue(v.next()),d=_.done,!d;T=!0){h=_.value,T=!1;const E=h;for(const S of p.decode(E))yield yield ue(S)}}catch(E){c={error:E}}finally{try{!T&&!d&&(f=v.return)&&(yield ue(f.call(v)))}finally{if(c)throw c.error}}for(const E of p.flush())yield yield ue(E)})}function l(){return Me(this,arguments,function*(){var d,c,f,h;if(i)throw new xe("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let p=!1;try{try{for(var m=!0,T=Ne(s()),v;v=yield ue(T.next()),d=v.done,!d;m=!0){h=v.value,m=!1;const _=h;p||_&&(yield yield ue(JSON.parse(_)))}}catch(_){c={error:_}}finally{try{!m&&!d&&(f=T.return)&&(yield ue(f.call(T)))}finally{if(c)throw c.error}}p=!0}catch(_){if(Gt(_))return yield ue(void 0);throw _}finally{p||n.abort()}})}return new Je(l,n,o)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],o=this.iterator(),i=s=>({next:()=>{if(s.length===0){const l=o.next();e.push(l),n.push(l)}return s.shift()}});return[new Je(()=>i(e),this.controller,this.client),new Je(()=>i(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return Ti({async start(){n=e[Symbol.asyncIterator]()},async pull(o){try{const{value:i,done:s}=await n.next();if(s)return o.close();const l=Qt(JSON.stringify(i)+`
`);o.enqueue(l)}catch(i){o.error(i)}},async cancel(){var o;await((o=n.return)===null||o===void 0?void 0:o.call(n))}})}}function dc(t,e){return Me(this,arguments,function*(){var o,i,s,l;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new xe("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new xe("Attempted to iterate over a response with no body");const u=new fc,d=new St,c=Ci(t.body);try{for(var f=!0,h=Ne(cc(c)),p;p=yield ue(h.next()),o=p.done,!o;f=!0){l=p.value,f=!1;const m=l;for(const T of d.decode(m)){const v=u.decode(T);v&&(yield yield ue(v))}}}catch(m){i={error:m}}finally{try{!f&&!o&&(s=h.return)&&(yield ue(s.call(h)))}finally{if(i)throw i.error}}for(const m of d.flush()){const T=u.decode(m);T&&(yield yield ue(T))}})}function cc(t){return Me(this,arguments,function*(){var n,o,i,s;let l=new Uint8Array;try{for(var u=!0,d=Ne(t),c;c=yield ue(d.next()),n=c.done,!n;u=!0){s=c.value,u=!1;const f=s;if(f==null)continue;const h=f instanceof ArrayBuffer?new Uint8Array(f):typeof f=="string"?Qt(f):f;let p=new Uint8Array(l.length+h.length);p.set(l),p.set(h,l.length),l=p;let m;for(;(m=lc(l))!==-1;)yield yield ue(l.slice(0,m)),l=l.slice(m)}}catch(f){o={error:f}}finally{try{!u&&!n&&(i=d.return)&&(yield ue(i.call(d)))}finally{if(o)throw o.error}}l.length>0&&(yield yield ue(l))})}class fc{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,o,i]=pc(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}function pc(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function hc(t,e){const{response:n,requestLogID:o,retryOfRequestLogID:i,startTime:s}=e,l=await(async()=>{var u;if(e.options.stream)return we(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Je.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const d=n.headers.get("content-type"),c=(u=d==null?void 0:d.split(";")[0])===null||u===void 0?void 0:u.trim();return(c==null?void 0:c.includes("application/json"))||(c==null?void 0:c.endsWith("+json"))?await n.json():await n.text()})();return we(t).debug(`[${o}] response parsed`,Ve({retryOfRequestLogID:i,url:n.url,status:n.status,body:l,durationMs:Date.now()-s})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jt extends Promise{constructor(e,n,o=hc){super(i=>{i(null)}),this.responsePromise=n,this.parseResponse=o,this.client=e}_thenUnwrap(e){return new jt(this.client,this.responsePromise,async(n,o)=>e(await this.parseResponse(n,o),o))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Pi=Symbol("brand.privateNullableHeaders");function*mc(t){if(!t)return;if(Pi in t){const{values:o,nulls:i}=t;yield*o.entries();for(const s of i)yield[s,null];return}let e=!1,n;t instanceof Headers?n=t.entries():Po(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let o of n){const i=o[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const s=Po(o[1])?o[1]:[o[1]];let l=!1;for(const u of s)u!==void 0&&(e&&!l&&(l=!0,yield[i,null]),yield[i,u])}}const je=t=>{const e=new Headers,n=new Set;for(const o of t){const i=new Set;for(const[s,l]of mc(o)){const u=s.toLowerCase();i.has(u)||(e.delete(s),i.add(u)),l===null?(e.delete(s),n.add(u)):(e.append(s,l),n.delete(u))}}return{[Pi]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const At=t=>{var e,n,o,i,s,l;if(typeof globalThis.process<"u")return(o=(n=(e=Vi)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&o!==void 0?o:void 0;if(typeof globalThis.Deno<"u")return(l=(s=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||s===void 0?void 0:s.call(i,t))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var xi;class It{constructor(e){var n,o,i,s,l,u,d,{baseURL:c=At("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:f=(n=At("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:h="v1beta"}=e,p=gt(e,["baseURL","apiKey","apiVersion"]);const m=Object.assign(Object.assign({apiKey:f,apiVersion:h},p),{baseURL:c||"https://generativelanguage.googleapis.com"});this.baseURL=m.baseURL,this.timeout=(o=m.timeout)!==null&&o!==void 0?o:It.DEFAULT_TIMEOUT,this.logger=(i=m.logger)!==null&&i!==void 0?i:console;const T="warn";this.logLevel=T,this.logLevel=(l=(s=Do(m.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:Do(At("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:T,this.fetchOptions=m.fetchOptions,this.maxRetries=(u=m.maxRetries)!==null&&u!==void 0?u:2,this.fetch=(d=m.fetch)!==null&&d!==void 0?d:Yd(),this.encoder=Qd,this._options=m,this.apiKey=f,this.apiVersion=h,this.clientAdapter=m.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=je([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return je([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return je([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,o])=>typeof o<"u").map(([n,o])=>{if(typeof o=="string"||typeof o=="number"||typeof o=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(o)}`;if(o===null)return`${encodeURIComponent(n)}=`;throw new xe(`Cannot stringify type ${typeof o}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${ze}`}defaultIdempotencyKey(){return`stainless-node-retry-${Ud()}`}makeStatusError(e,n,o,i){return Ae.generate(e,n,o,i)}buildURL(e,n,o){const i=!this.baseURLOverridden()&&o||this.baseURL,s=Fd(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return Vd(l)||(n=Object.assign(Object.assign({},l),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(s.search=this.stringifyQuery(n)),s.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:o}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,o){return this.request(Promise.resolve(o).then(i=>Object.assign({method:e,path:n},i)))}request(e,n=null){return new jt(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,o){var i,s,l;const u=await e,d=(i=u.maxRetries)!==null&&i!==void 0?i:this.maxRetries;n==null&&(n=d),await this.prepareOptions(u);const{req:c,url:f,timeout:h}=await this.buildRequest(u,{retryCount:d-n});await this.prepareRequest(c,{url:f,options:u});const p="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=o===void 0?"":`, retryOf: ${o}`,T=Date.now();if(we(this).debug(`[${p}] sending request`,Ve({retryOfRequestLogID:o,method:u.method,url:f,options:u,headers:c.headers})),!((s=u.signal)===null||s===void 0)&&s.aborted)throw new Vt;const v=new AbortController,_=await this.fetchWithTimeout(f,c,h,v).catch(Bt),E=Date.now();if(_ instanceof globalThis.Error){const R=`retrying, ${n} attempts remaining`;if(!((l=u.signal)===null||l===void 0)&&l.aborted)throw new Vt;const P=Gt(_)||/timed? ?out/i.test(String(_)+("cause"in _?String(_.cause):""));if(n)return we(this).info(`[${p}] connection ${P?"timed out":"failed"} - ${R}`),we(this).debug(`[${p}] connection ${P?"timed out":"failed"} (${R})`,Ve({retryOfRequestLogID:o,url:f,durationMs:E-T,message:_.message})),this.retryRequest(u,n,o??p);throw we(this).info(`[${p}] connection ${P?"timed out":"failed"} - error; no more retries left`),we(this).debug(`[${p}] connection ${P?"timed out":"failed"} (error; no more retries left)`,Ve({retryOfRequestLogID:o,url:f,durationMs:E-T,message:_.message})),P?new fi:new Ct({cause:_})}const S=`[${p}${m}] ${c.method} ${f} ${_.ok?"succeeded":"failed"} with status ${_.status} in ${E-T}ms`;if(!_.ok){const R=await this.shouldRetry(_);if(n&&R){const C=`retrying, ${n} attempts remaining`;return await Xd(_.body),we(this).info(`${S} - ${C}`),we(this).debug(`[${p}] response error (${C})`,Ve({retryOfRequestLogID:o,url:_.url,status:_.status,headers:_.headers,durationMs:E-T})),this.retryRequest(u,n,o??p,_.headers)}const P=R?"error; no more retries left":"error; not retryable";we(this).info(`${S} - ${P}`);const x=await _.text().catch(C=>Bt(C).message),B=zd(x),U=B?void 0:x;throw we(this).debug(`[${p}] response error (${P})`,Ve({retryOfRequestLogID:o,url:_.url,status:_.status,headers:_.headers,message:U,durationMs:Date.now()-T})),this.makeStatusError(_.status,B,U,_.headers)}return we(this).info(S),we(this).debug(`[${p}] response start`,Ve({retryOfRequestLogID:o,url:_.url,status:_.status,headers:_.headers,durationMs:E-T})),{response:_,options:u,controller:v,requestLogID:p,retryOfRequestLogID:o,startTime:T}}async fetchWithTimeout(e,n,o,i){const s=n||{},{signal:l,method:u}=s,d=gt(s,["signal","method"]);l&&l.addEventListener("abort",()=>i.abort());const c=setTimeout(()=>i.abort(),o),f=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,h=Object.assign(Object.assign(Object.assign({signal:i.signal},f?{duplex:"half"}:{}),{method:"GET"}),d);u&&(h.method=u.toUpperCase());try{return await this.fetch.call(void 0,e,h)}finally{clearTimeout(c)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,o,i){var s;let l;const u=i==null?void 0:i.get("retry-after-ms");if(u){const c=parseFloat(u);Number.isNaN(c)||(l=c)}const d=i==null?void 0:i.get("retry-after");if(d&&!l){const c=parseFloat(d);Number.isNaN(c)?l=Date.parse(d)-Date.now():l=c*1e3}if(!(l&&0<=l&&l<60*1e3)){const c=(s=e.maxRetries)!==null&&s!==void 0?s:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(n,c)}return await Od(l),this.makeRequest(e,n-1,o)}calculateDefaultRetryTimeoutMillis(e,n){const s=n-e,l=Math.min(.5*Math.pow(2,s),8),u=1-Math.random()*.25;return l*u*1e3}async buildRequest(e,{retryCount:n=0}={}){var o,i,s;const l=Object.assign({},e),{method:u,path:d,query:c,defaultBaseURL:f}=l,h=this.buildURL(d,c,f);"timeout"in l&&qd("timeout",l.timeout),l.timeout=(o=l.timeout)!==null&&o!==void 0?o:this.timeout;const{bodyHeaders:p,body:m}=this.buildBody({options:l}),T=await this.buildHeaders({options:e,method:u,bodyHeaders:p,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:u,headers:T},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"}),m&&{body:m}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(s=l.fetchOptions)!==null&&s!==void 0?s:{}),url:h,timeout:l.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:o,retryCount:i}){let s={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let u=je([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),Kd()),this._options.defaultHeaders,o,e.headers,l]);return this.validateHeaders(u),u.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const o=je([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&o.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Zd(e)}:this.encoder({body:e,headers:o})}}It.DEFAULT_TIMEOUT=6e4;class Ce extends It{constructor(){super(...arguments),this.interactions=new ki(this)}}xi=Ce;Ce.GeminiNextGenAPIClient=xi;Ce.GeminiNextGenAPIClientError=xe;Ce.APIError=Ae;Ce.APIConnectionError=Ct;Ce.APIConnectionTimeoutError=fi;Ce.APIUserAbortError=Vt;Ce.NotFoundError=gi;Ce.ConflictError=vi;Ce.RateLimitError=_i;Ce.BadRequestError=pi;Ce.AuthenticationError=hi;Ce.InternalServerError=Ei;Ce.PermissionDeniedError=mi;Ce.UnprocessableEntityError=yi;Ce.toFile=oc;Ce.Interactions=ki;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gc(t,e){const n={},o=r(t,["name"]);return o!=null&&a(n,["_url","name"],o),n}function vc(t,e){const n={},o=r(t,["name"]);return o!=null&&a(n,["_url","name"],o),n}function yc(t,e){const n={},o=r(t,["sdkHttpResponse"]);return o!=null&&a(n,["sdkHttpResponse"],o),n}function _c(t,e){const n={},o=r(t,["sdkHttpResponse"]);return o!=null&&a(n,["sdkHttpResponse"],o),n}function Ec(t,e,n){const o={};if(r(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=r(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&a(e,["displayName"],i),r(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=r(t,["epochCount"]);e!==void 0&&s!=null&&a(e,["tuningTask","hyperparameters","epochCount"],s);const l=r(t,["learningRateMultiplier"]);if(l!=null&&a(o,["tuningTask","hyperparameters","learningRateMultiplier"],l),r(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(r(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(r(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=r(t,["batchSize"]);e!==void 0&&u!=null&&a(e,["tuningTask","hyperparameters","batchSize"],u);const d=r(t,["learningRate"]);if(e!==void 0&&d!=null&&a(e,["tuningTask","hyperparameters","learningRate"],d),r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(r(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return o}function Tc(t,e,n){const o={};let i=r(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const m=r(t,["validationDataset"]);e!==void 0&&m!=null&&a(e,["supervisedTuningSpec"],Lo(m))}else if(i==="PREFERENCE_TUNING"){const m=r(t,["validationDataset"]);e!==void 0&&m!=null&&a(e,["preferenceOptimizationSpec"],Lo(m))}const s=r(t,["tunedModelDisplayName"]);e!==void 0&&s!=null&&a(e,["tunedModelDisplayName"],s);const l=r(t,["description"]);e!==void 0&&l!=null&&a(e,["description"],l);let u=r(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const m=r(t,["epochCount"]);e!==void 0&&m!=null&&a(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(u==="PREFERENCE_TUNING"){const m=r(t,["epochCount"]);e!==void 0&&m!=null&&a(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let d=r(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const m=r(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&a(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(d==="PREFERENCE_TUNING"){const m=r(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&a(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let c=r(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const m=r(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&a(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(c==="PREFERENCE_TUNING"){const m=r(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&a(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let f=r(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const m=r(t,["adapterSize"]);e!==void 0&&m!=null&&a(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(f==="PREFERENCE_TUNING"){const m=r(t,["adapterSize"]);e!==void 0&&m!=null&&a(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(r(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(r(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=r(t,["labels"]);e!==void 0&&h!=null&&a(e,["labels"],h);const p=r(t,["beta"]);return e!==void 0&&p!=null&&a(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),o}function Cc(t,e){const n={},o=r(t,["baseModel"]);o!=null&&a(n,["baseModel"],o);const i=r(t,["preTunedModel"]);i!=null&&a(n,["preTunedModel"],i);const s=r(t,["trainingDataset"]);s!=null&&bc(s);const l=r(t,["config"]);return l!=null&&Ec(l,n),n}function Sc(t,e){const n={},o=r(t,["baseModel"]);o!=null&&a(n,["baseModel"],o);const i=r(t,["preTunedModel"]);i!=null&&a(n,["preTunedModel"],i);const s=r(t,["trainingDataset"]);s!=null&&Dc(s,n,e);const l=r(t,["config"]);return l!=null&&Tc(l,n,e),n}function Ic(t,e){const n={},o=r(t,["name"]);return o!=null&&a(n,["_url","name"],o),n}function wc(t,e){const n={},o=r(t,["name"]);return o!=null&&a(n,["_url","name"],o),n}function Ac(t,e,n){const o={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const s=r(t,["pageToken"]);e!==void 0&&s!=null&&a(e,["_query","pageToken"],s);const l=r(t,["filter"]);return e!==void 0&&l!=null&&a(e,["_query","filter"],l),o}function Rc(t,e,n){const o={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&a(e,["_query","pageSize"],i);const s=r(t,["pageToken"]);e!==void 0&&s!=null&&a(e,["_query","pageToken"],s);const l=r(t,["filter"]);return e!==void 0&&l!=null&&a(e,["_query","filter"],l),o}function kc(t,e){const n={},o=r(t,["config"]);return o!=null&&Ac(o,n),n}function Pc(t,e){const n={},o=r(t,["config"]);return o!=null&&Rc(o,n),n}function xc(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&a(n,["sdkHttpResponse"],o);const i=r(t,["nextPageToken"]);i!=null&&a(n,["nextPageToken"],i);const s=r(t,["tunedModels"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>Mi(u))),a(n,["tuningJobs"],l)}return n}function Mc(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&a(n,["sdkHttpResponse"],o);const i=r(t,["nextPageToken"]);i!=null&&a(n,["nextPageToken"],i);const s=r(t,["tuningJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>zt(u))),a(n,["tuningJobs"],l)}return n}function Nc(t,e){const n={},o=r(t,["name"]);o!=null&&a(n,["model"],o);const i=r(t,["name"]);return i!=null&&a(n,["endpoint"],i),n}function bc(t,e){const n={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(r(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const o=r(t,["examples"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),a(n,["examples","examples"],i)}return n}function Dc(t,e,n){const o={};let i=r(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const l=r(t,["gcsUri"]);e!==void 0&&l!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(i==="PREFERENCE_TUNING"){const l=r(t,["gcsUri"]);e!==void 0&&l!=null&&a(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let s=r(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=r(t,["vertexDatasetResource"]);e!==void 0&&l!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=r(t,["vertexDatasetResource"]);e!==void 0&&l!=null&&a(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(r(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return o}function Mi(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&a(n,["sdkHttpResponse"],o);const i=r(t,["name"]);i!=null&&a(n,["name"],i);const s=r(t,["state"]);s!=null&&a(n,["state"],Wo(s));const l=r(t,["createTime"]);l!=null&&a(n,["createTime"],l);const u=r(t,["tuningTask","startTime"]);u!=null&&a(n,["startTime"],u);const d=r(t,["tuningTask","completeTime"]);d!=null&&a(n,["endTime"],d);const c=r(t,["updateTime"]);c!=null&&a(n,["updateTime"],c);const f=r(t,["description"]);f!=null&&a(n,["description"],f);const h=r(t,["baseModel"]);h!=null&&a(n,["baseModel"],h);const p=r(t,["_self"]);return p!=null&&a(n,["tunedModel"],Nc(p)),n}function zt(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&a(n,["sdkHttpResponse"],o);const i=r(t,["name"]);i!=null&&a(n,["name"],i);const s=r(t,["state"]);s!=null&&a(n,["state"],Wo(s));const l=r(t,["createTime"]);l!=null&&a(n,["createTime"],l);const u=r(t,["startTime"]);u!=null&&a(n,["startTime"],u);const d=r(t,["endTime"]);d!=null&&a(n,["endTime"],d);const c=r(t,["updateTime"]);c!=null&&a(n,["updateTime"],c);const f=r(t,["error"]);f!=null&&a(n,["error"],f);const h=r(t,["description"]);h!=null&&a(n,["description"],h);const p=r(t,["baseModel"]);p!=null&&a(n,["baseModel"],p);const m=r(t,["tunedModel"]);m!=null&&a(n,["tunedModel"],m);const T=r(t,["preTunedModel"]);T!=null&&a(n,["preTunedModel"],T);const v=r(t,["supervisedTuningSpec"]);v!=null&&a(n,["supervisedTuningSpec"],v);const _=r(t,["preferenceOptimizationSpec"]);_!=null&&a(n,["preferenceOptimizationSpec"],_);const E=r(t,["tuningDataStats"]);E!=null&&a(n,["tuningDataStats"],E);const S=r(t,["encryptionSpec"]);S!=null&&a(n,["encryptionSpec"],S);const R=r(t,["partnerModelTuningSpec"]);R!=null&&a(n,["partnerModelTuningSpec"],R);const P=r(t,["customBaseModel"]);P!=null&&a(n,["customBaseModel"],P);const x=r(t,["experiment"]);x!=null&&a(n,["experiment"],x);const B=r(t,["labels"]);B!=null&&a(n,["labels"],B);const U=r(t,["outputUri"]);U!=null&&a(n,["outputUri"],U);const A=r(t,["pipelineJob"]);A!=null&&a(n,["pipelineJob"],A);const C=r(t,["serviceAccount"]);C!=null&&a(n,["serviceAccount"],C);const M=r(t,["tunedModelDisplayName"]);M!=null&&a(n,["tunedModelDisplayName"],M);const z=r(t,["veoTuningSpec"]);return z!=null&&a(n,["veoTuningSpec"],z),n}function Uc(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&a(n,["sdkHttpResponse"],o);const i=r(t,["name"]);i!=null&&a(n,["name"],i);const s=r(t,["metadata"]);s!=null&&a(n,["metadata"],s);const l=r(t,["done"]);l!=null&&a(n,["done"],l);const u=r(t,["error"]);return u!=null&&a(n,["error"],u),n}function Lo(t,e){const n={},o=r(t,["gcsUri"]);o!=null&&a(n,["validationDatasetUri"],o);const i=r(t,["vertexDatasetResource"]);return i!=null&&a(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lc extends Ue{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new He(De.PAGED_ITEM_TUNING_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var o;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((o=n.config)===null||o===void 0)&&o.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let l="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?l=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(l=s.name.split("/operations/")[0]),{name:l,state:xt.JOB_STATE_QUEUED}}}}async getInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=wc(e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>zt(f))}else{const c=Ic(e);return u=ee("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>Mi(f))}}async listInternal(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Pc(e);return u=ee("tuningJobs",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=Mc(f),p=new ao;return Object.assign(p,h),p})}else{const c=kc(e);return u=ee("tunedModels",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=xc(f),p=new ao;return Object.assign(p,h),p})}}async cancel(e){var n,o,i,s;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=vc(e);return u=ee("{name}:cancel",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=_c(f),p=new lo;return Object.assign(p,h),p})}else{const c=gc(e);return u=ee("{name}:cancel",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),l.then(f=>{const h=yc(f),p=new lo;return Object.assign(p,h),p})}}async tuneInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI()){const u=Sc(e,e);return s=ee("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:d.headers},f})),i.then(d=>zt(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,o;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Cc(e);return s=ee("tunedModels",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:d.headers},f})),i.then(d=>Uc(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fc{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Gc=1024*1024*8,Bc=3,Vc=1e3,Hc=2,yt="x-goog-upload-status";async function qc(t,e,n){var o;const i=await Ni(t,e,n),s=await(i==null?void 0:i.json());if(((o=i==null?void 0:i.headers)===null||o===void 0?void 0:o[yt])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function zc(t,e,n){var o;const i=await Ni(t,e,n),s=await(i==null?void 0:i.json());if(((o=i==null?void 0:i.headers)===null||o===void 0?void 0:o[yt])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=Ho(s),u=new $t;return Object.assign(u,l),u}async function Ni(t,e,n){var o,i;let s=0,l=0,u=new Nt(new Response),d="upload";for(s=t.size;l<s;){const c=Math.min(Gc,s-l),f=t.slice(l,l+c);l+c>=s&&(d+=", finalize");let h=0,p=Vc;for(;h<Bc&&(u=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(c)}}}),!(!((o=u==null?void 0:u.headers)===null||o===void 0)&&o[yt]));)h++,await Jc(p),p=p*Hc;if(l+=c,((i=u==null?void 0:u.headers)===null||i===void 0?void 0:i[yt])!=="active")break;if(s<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function Oc(t){return{size:t.size,type:t.type}}function Jc(t){return new Promise(e=>setTimeout(e,t))}class $c{async upload(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await qc(e,n,o)}async uploadToFileSearchStore(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await zc(e,n,o)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Oc(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wc{create(e,n,o){return new Kc(e,n,o)}}class Kc{constructor(e,n,o){this.url=e,this.headers=n,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fo="x-goog-api-key";class Yc{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(Fo)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Fo,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Zc="gl-node/";class Xc{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new Ce({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const o=Oi(e.httpOptions,e.vertexai,void 0,void 0);o&&(e.httpOptions?e.httpOptions.baseUrl=o:e.httpOptions={baseUrl:o}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new Yc(this.apiKey);this.apiClient=new Ou({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:Zc+"web",uploader:new $c,downloader:new Fc}),this.models=new ud(this.apiClient),this.live=new od(this.apiClient,i,new Wc),this.batches=new _s(this.apiClient),this.chats=new ea(this.models,this.apiClient),this.caches=new Xs(this.apiClient),this.files=new da(this.apiClient),this.operations=new dd(this.apiClient),this.authTokens=new Ad(this.apiClient),this.tunings=new Lc(this.apiClient),this.fileSearchStores=new Dd(this.apiClient)}}var Ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ct={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/var Qc=ct.exports,Go;function jc(){return Go||(Go=1,(function(t,e){(function(n,o){t.exports=o()})(Qc,function n(){var o=typeof self<"u"?self:typeof window<"u"?window:o!==void 0?o:{},i=!o.document&&!!o.postMessage,s=o.IS_PAPA_WORKER||!1,l={},u=0,d={parse:function(A,C){var M=(C=C||{}).dynamicTyping||!1;if(U(M)&&(C.dynamicTypingFunction=M,M={}),C.dynamicTyping=M,C.transform=!!U(C.transform)&&C.transform,C.worker&&d.WORKERS_SUPPORTED){var z=(function(){if(!d.WORKERS_SUPPORTED)return!1;var D=(O=o.URL||o.webkitURL||null,te=n.toString(),d.BLOB_URL||(d.BLOB_URL=O.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",te,")();"],{type:"text/javascript"})))),y=new o.Worker(D),O,te;return y.onmessage=S,y.id=u++,l[y.id]=y})();return z.userStep=C.step,z.userChunk=C.chunk,z.userComplete=C.complete,z.userError=C.error,C.step=U(C.step),C.chunk=U(C.chunk),C.complete=U(C.complete),C.error=U(C.error),delete C.worker,void z.postMessage({input:A,config:C,workerId:z.id})}var w=null;return d.NODE_STREAM_INPUT,typeof A=="string"?(A=(function(D){return D.charCodeAt(0)===65279?D.slice(1):D})(A),w=C.download?new h(C):new m(C)):A.readable===!0&&U(A.read)&&U(A.on)?w=new T(C):(o.File&&A instanceof File||A instanceof Object)&&(w=new p(C)),w.stream(A)},unparse:function(A,C){var M=!1,z=!0,w=",",D=`\r
`,y='"',O=y+y,te=!1,F=null,ne=!1;(function(){if(typeof C=="object"){if(typeof C.delimiter!="string"||d.BAD_DELIMITERS.filter(function(N){return C.delimiter.indexOf(N)!==-1}).length||(w=C.delimiter),(typeof C.quotes=="boolean"||typeof C.quotes=="function"||Array.isArray(C.quotes))&&(M=C.quotes),typeof C.skipEmptyLines!="boolean"&&typeof C.skipEmptyLines!="string"||(te=C.skipEmptyLines),typeof C.newline=="string"&&(D=C.newline),typeof C.quoteChar=="string"&&(y=C.quoteChar),typeof C.header=="boolean"&&(z=C.header),Array.isArray(C.columns)){if(C.columns.length===0)throw new Error("Option columns is empty");F=C.columns}C.escapeChar!==void 0&&(O=C.escapeChar+y),(typeof C.escapeFormulae=="boolean"||C.escapeFormulae instanceof RegExp)&&(ne=C.escapeFormulae instanceof RegExp?C.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var H=new RegExp(_(y),"g");if(typeof A=="string"&&(A=JSON.parse(A)),Array.isArray(A)){if(!A.length||Array.isArray(A[0]))return ie(null,A,te);if(typeof A[0]=="object")return ie(F||Object.keys(A[0]),A,te)}else if(typeof A=="object")return typeof A.data=="string"&&(A.data=JSON.parse(A.data)),Array.isArray(A.data)&&(A.fields||(A.fields=A.meta&&A.meta.fields||F),A.fields||(A.fields=Array.isArray(A.data[0])?A.fields:typeof A.data[0]=="object"?Object.keys(A.data[0]):[]),Array.isArray(A.data[0])||typeof A.data[0]=="object"||(A.data=[A.data])),ie(A.fields||[],A.data||[],te);throw new Error("Unable to serialize unrecognized input");function ie(N,Q,Z){var Y="";typeof N=="string"&&(N=JSON.parse(N)),typeof Q=="string"&&(Q=JSON.parse(Q));var ce=Array.isArray(N)&&0<N.length,he=!Array.isArray(Q[0]);if(ce&&z){for(var re=0;re<N.length;re++)0<re&&(Y+=w),Y+=V(N[re],re);0<Q.length&&(Y+=D)}for(var X=0;X<Q.length;X++){var ae=ce?N.length:Q[X].length,le=!1,ge=ce?Object.keys(Q[X]).length===0:Q[X].length===0;if(Z&&!ce&&(le=Z==="greedy"?Q[X].join("").trim()==="":Q[X].length===1&&Q[X][0].length===0),Z==="greedy"&&ce){for(var fe=[],g=0;g<ae;g++){var q=he?N[g]:g;fe.push(Q[X][q])}le=fe.join("").trim()===""}if(!le){for(var G=0;G<ae;G++){0<G&&!ge&&(Y+=w);var k=ce&&he?N[G]:G;Y+=V(Q[X][k],G)}X<Q.length-1&&(!Z||0<ae&&!ge)&&(Y+=D)}}return Y}function V(N,Q){if(N==null)return"";if(N.constructor===Date)return JSON.stringify(N).slice(1,25);var Z=!1;ne&&typeof N=="string"&&ne.test(N)&&(N="'"+N,Z=!0);var Y=N.toString().replace(H,O);return(Z=Z||M===!0||typeof M=="function"&&M(N,Q)||Array.isArray(M)&&M[Q]||(function(ce,he){for(var re=0;re<he.length;re++)if(-1<ce.indexOf(he[re]))return!0;return!1})(Y,d.BAD_DELIMITERS)||-1<Y.indexOf(w)||Y.charAt(0)===" "||Y.charAt(Y.length-1)===" ")?y+Y+y:Y}}};if(d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!i&&!!o.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=E,d.ParserHandle=v,d.NetworkStreamer=h,d.FileStreamer=p,d.StringStreamer=m,d.ReadableStreamStreamer=T,o.jQuery){var c=o.jQuery;c.fn.parse=function(A){var C=A.config||{},M=[];return this.each(function(D){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&o.FileReader)||!this.files||this.files.length===0)return!0;for(var y=0;y<this.files.length;y++)M.push({file:this.files[y],inputElem:this,instanceConfig:c.extend({},C)})}),z(),this;function z(){if(M.length!==0){var D,y,O,te,F=M[0];if(U(A.before)){var ne=A.before(F.file,F.inputElem);if(typeof ne=="object"){if(ne.action==="abort")return D="AbortError",y=F.file,O=F.inputElem,te=ne.reason,void(U(A.error)&&A.error({name:D},y,O,te));if(ne.action==="skip")return void w();typeof ne.config=="object"&&(F.instanceConfig=c.extend(F.instanceConfig,ne.config))}else if(ne==="skip")return void w()}var H=F.instanceConfig.complete;F.instanceConfig.complete=function(ie){U(H)&&H(ie,F.file,F.inputElem),w()},d.parse(F.file,F.instanceConfig)}else U(A.complete)&&A.complete()}function w(){M.splice(0,1),z()}}}function f(A){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(C){var M=x(C);M.chunkSize=parseInt(M.chunkSize),C.step||C.chunk||(M.chunkSize=null),this._handle=new v(M),(this._handle.streamer=this)._config=M}).call(this,A),this.parseChunk=function(C,M){if(this.isFirstChunk&&U(this._config.beforeFirstChunk)){var z=this._config.beforeFirstChunk(C);z!==void 0&&(C=z)}this.isFirstChunk=!1,this._halted=!1;var w=this._partialLine+C;this._partialLine="";var D=this._handle.parse(w,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var y=D.meta.cursor;this._finished||(this._partialLine=w.substring(y-this._baseIndex),this._baseIndex=y),D&&D.data&&(this._rowCount+=D.data.length);var O=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)o.postMessage({results:D,workerId:d.WORKER_ID,finished:O});else if(U(this._config.chunk)&&!M){if(this._config.chunk(D,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);D=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(D.data),this._completeResults.errors=this._completeResults.errors.concat(D.errors),this._completeResults.meta=D.meta),this._completed||!O||!U(this._config.complete)||D&&D.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),O||D&&D.meta.paused||this._nextChunk(),D}this._halted=!0},this._sendError=function(C){U(this._config.error)?this._config.error(C):s&&this._config.error&&o.postMessage({workerId:d.WORKER_ID,error:C,finished:!1})}}function h(A){var C;(A=A||{}).chunkSize||(A.chunkSize=d.RemoteChunkSize),f.call(this,A),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(M){this._input=M,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(C=new XMLHttpRequest,this._config.withCredentials&&(C.withCredentials=this._config.withCredentials),i||(C.onload=B(this._chunkLoaded,this),C.onerror=B(this._chunkError,this)),C.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var M=this._config.downloadRequestHeaders;for(var z in M)C.setRequestHeader(z,M[z])}if(this._config.chunkSize){var w=this._start+this._config.chunkSize-1;C.setRequestHeader("Range","bytes="+this._start+"-"+w)}try{C.send(this._config.downloadRequestBody)}catch(D){this._chunkError(D.message)}i&&C.status===0&&this._chunkError()}},this._chunkLoaded=function(){C.readyState===4&&(C.status<200||400<=C.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:C.responseText.length,this._finished=!this._config.chunkSize||this._start>=(function(M){var z=M.getResponseHeader("Content-Range");return z===null?-1:parseInt(z.substring(z.lastIndexOf("/")+1))})(C),this.parseChunk(C.responseText)))},this._chunkError=function(M){var z=C.statusText||M;this._sendError(new Error(z))}}function p(A){var C,M;(A=A||{}).chunkSize||(A.chunkSize=d.LocalChunkSize),f.call(this,A);var z=typeof FileReader<"u";this.stream=function(w){this._input=w,M=w.slice||w.webkitSlice||w.mozSlice,z?((C=new FileReader).onload=B(this._chunkLoaded,this),C.onerror=B(this._chunkError,this)):C=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var w=this._input;if(this._config.chunkSize){var D=Math.min(this._start+this._config.chunkSize,this._input.size);w=M.call(w,this._start,D)}var y=C.readAsText(w,this._config.encoding);z||this._chunkLoaded({target:{result:y}})},this._chunkLoaded=function(w){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(w.target.result)},this._chunkError=function(){this._sendError(C.error)}}function m(A){var C;f.call(this,A=A||{}),this.stream=function(M){return C=M,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var M,z=this._config.chunkSize;return z?(M=C.substring(0,z),C=C.substring(z)):(M=C,C=""),this._finished=!C,this.parseChunk(M)}}}function T(A){f.call(this,A=A||{});var C=[],M=!0,z=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(w){this._input=w,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){z&&C.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),C.length?this.parseChunk(C.shift()):M=!0},this._streamData=B(function(w){try{C.push(typeof w=="string"?w:w.toString(this._config.encoding)),M&&(M=!1,this._checkIsFinished(),this.parseChunk(C.shift()))}catch(D){this._streamError(D)}},this),this._streamError=B(function(w){this._streamCleanUp(),this._sendError(w)},this),this._streamEnd=B(function(){this._streamCleanUp(),z=!0,this._streamData("")},this),this._streamCleanUp=B(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function v(A){var C,M,z,w=Math.pow(2,53),D=-w,y=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,O=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,te=this,F=0,ne=0,H=!1,ie=!1,V=[],N={data:[],errors:[],meta:{}};if(U(A.step)){var Q=A.step;A.step=function(X){if(N=X,ce())Y();else{if(Y(),N.data.length===0)return;F+=X.data.length,A.preview&&F>A.preview?M.abort():(N.data=N.data[0],Q(N,te))}}}function Z(X){return A.skipEmptyLines==="greedy"?X.join("").trim()==="":X.length===1&&X[0].length===0}function Y(){return N&&z&&(re("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),z=!1),A.skipEmptyLines&&(N.data=N.data.filter(function(X){return!Z(X)})),ce()&&(function(){if(!N)return;function X(le,ge){U(A.transformHeader)&&(le=A.transformHeader(le,ge)),V.push(le)}if(Array.isArray(N.data[0])){for(var ae=0;ce()&&ae<N.data.length;ae++)N.data[ae].forEach(X);N.data.splice(0,1)}else N.data.forEach(X)})(),(function(){if(!N||!A.header&&!A.dynamicTyping&&!A.transform)return N;function X(le,ge){var fe,g=A.header?{}:[];for(fe=0;fe<le.length;fe++){var q=fe,G=le[fe];A.header&&(q=fe>=V.length?"__parsed_extra":V[fe]),A.transform&&(G=A.transform(G,q)),G=he(q,G),q==="__parsed_extra"?(g[q]=g[q]||[],g[q].push(G)):g[q]=G}return A.header&&(fe>V.length?re("FieldMismatch","TooManyFields","Too many fields: expected "+V.length+" fields but parsed "+fe,ne+ge):fe<V.length&&re("FieldMismatch","TooFewFields","Too few fields: expected "+V.length+" fields but parsed "+fe,ne+ge)),g}var ae=1;return!N.data.length||Array.isArray(N.data[0])?(N.data=N.data.map(X),ae=N.data.length):N.data=X(N.data,0),A.header&&N.meta&&(N.meta.fields=V),ne+=ae,N})()}function ce(){return A.header&&V.length===0}function he(X,ae){return le=X,A.dynamicTypingFunction&&A.dynamicTyping[le]===void 0&&(A.dynamicTyping[le]=A.dynamicTypingFunction(le)),(A.dynamicTyping[le]||A.dynamicTyping)===!0?ae==="true"||ae==="TRUE"||ae!=="false"&&ae!=="FALSE"&&((function(ge){if(y.test(ge)){var fe=parseFloat(ge);if(D<fe&&fe<w)return!0}return!1})(ae)?parseFloat(ae):O.test(ae)?new Date(ae):ae===""?null:ae):ae;var le}function re(X,ae,le,ge){var fe={type:X,code:ae,message:le};ge!==void 0&&(fe.row=ge),N.errors.push(fe)}this.parse=function(X,ae,le){var ge=A.quoteChar||'"';if(A.newline||(A.newline=(function(q,G){q=q.substring(0,1048576);var k=new RegExp(_(G)+"([^]*?)"+_(G),"gm"),I=(q=q.replace(k,"")).split("\r"),b=q.split(`
`),J=1<b.length&&b[0].length<I[0].length;if(I.length===1||J)return`
`;for(var $=0,L=0;L<I.length;L++)I[L][0]===`
`&&$++;return $>=I.length/2?`\r
`:"\r"})(X,ge)),z=!1,A.delimiter)U(A.delimiter)&&(A.delimiter=A.delimiter(X),N.meta.delimiter=A.delimiter);else{var fe=(function(q,G,k,I,b){var J,$,L,K;b=b||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var j=0;j<b.length;j++){var W=b[j],oe=0,pe=0,de=0;L=void 0;for(var _e=new E({comments:I,delimiter:W,newline:G,preview:10}).parse(q),Re=0;Re<_e.data.length;Re++)if(k&&Z(_e.data[Re]))de++;else{var Ee=_e.data[Re].length;pe+=Ee,L!==void 0?0<Ee&&(oe+=Math.abs(Ee-L),L=Ee):L=Ee}0<_e.data.length&&(pe/=_e.data.length-de),($===void 0||oe<=$)&&(K===void 0||K<pe)&&1.99<pe&&($=oe,J=W,K=pe)}return{successful:!!(A.delimiter=J),bestDelimiter:J}})(X,A.newline,A.skipEmptyLines,A.comments,A.delimitersToGuess);fe.successful?A.delimiter=fe.bestDelimiter:(z=!0,A.delimiter=d.DefaultDelimiter),N.meta.delimiter=A.delimiter}var g=x(A);return A.preview&&A.header&&g.preview++,C=X,M=new E(g),N=M.parse(C,ae,le),Y(),H?{meta:{paused:!0}}:N||{meta:{paused:!1}}},this.paused=function(){return H},this.pause=function(){H=!0,M.abort(),C=U(A.chunk)?"":C.substring(M.getCharIndex())},this.resume=function(){te.streamer._halted?(H=!1,te.streamer.parseChunk(C,!0)):setTimeout(te.resume,3)},this.aborted=function(){return ie},this.abort=function(){ie=!0,M.abort(),N.meta.aborted=!0,U(A.complete)&&A.complete(N),C=""}}function _(A){return A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function E(A){var C,M=(A=A||{}).delimiter,z=A.newline,w=A.comments,D=A.step,y=A.preview,O=A.fastMode,te=C=A.quoteChar===void 0||A.quoteChar===null?'"':A.quoteChar;if(A.escapeChar!==void 0&&(te=A.escapeChar),(typeof M!="string"||-1<d.BAD_DELIMITERS.indexOf(M))&&(M=","),w===M)throw new Error("Comment character same as delimiter");w===!0?w="#":(typeof w!="string"||-1<d.BAD_DELIMITERS.indexOf(w))&&(w=!1),z!==`
`&&z!=="\r"&&z!==`\r
`&&(z=`
`);var F=0,ne=!1;this.parse=function(H,ie,V){if(typeof H!="string")throw new Error("Input must be a string");var N=H.length,Q=M.length,Z=z.length,Y=w.length,ce=U(D),he=[],re=[],X=[],ae=F=0;if(!H)return Te();if(A.header&&!ie){var le=H.split(z)[0].split(M),ge=[],fe={},g=!1;for(var q in le){var G=le[q];U(A.transformHeader)&&(G=A.transformHeader(G,q));var k=G,I=fe[G]||0;for(0<I&&(g=!0,k=G+"_"+I),fe[G]=I+1;ge.includes(k);)k=k+"_"+I;ge.push(k)}if(g){var b=H.split(z);b[0]=ge.join(M),H=b.join(z)}}if(O||O!==!1&&H.indexOf(C)===-1){for(var J=H.split(z),$=0;$<J.length;$++){if(X=J[$],F+=X.length,$!==J.length-1)F+=z.length;else if(V)return Te();if(!w||X.substring(0,Y)!==w){if(ce){if(he=[],de(X.split(M)),ye(),ne)return Te()}else de(X.split(M));if(y&&y<=$)return he=he.slice(0,y),Te(!0)}}return Te()}for(var L=H.indexOf(M,F),K=H.indexOf(z,F),j=new RegExp(_(te)+_(C),"g"),W=H.indexOf(C,F);;)if(H[F]!==C)if(w&&X.length===0&&H.substring(F,F+Y)===w){if(K===-1)return Te();F=K+Z,K=H.indexOf(z,F),L=H.indexOf(M,F)}else if(L!==-1&&(L<K||K===-1))X.push(H.substring(F,L)),F=L+Q,L=H.indexOf(M,F);else{if(K===-1)break;if(X.push(H.substring(F,K)),Ee(K+Z),ce&&(ye(),ne))return Te();if(y&&he.length>=y)return Te(!0)}else for(W=F,F++;;){if((W=H.indexOf(C,W+1))===-1)return V||re.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:he.length,index:F}),Re();if(W===N-1)return Re(H.substring(F,W).replace(j,C));if(C!==te||H[W+1]!==te){if(C===te||W===0||H[W-1]!==te){L!==-1&&L<W+1&&(L=H.indexOf(M,W+1)),K!==-1&&K<W+1&&(K=H.indexOf(z,W+1));var oe=_e(K===-1?L:Math.min(L,K));if(H.substr(W+1+oe,Q)===M){X.push(H.substring(F,W).replace(j,C)),H[F=W+1+oe+Q]!==C&&(W=H.indexOf(C,F)),L=H.indexOf(M,F),K=H.indexOf(z,F);break}var pe=_e(K);if(H.substring(W+1+pe,W+1+pe+Z)===z){if(X.push(H.substring(F,W).replace(j,C)),Ee(W+1+pe+Z),L=H.indexOf(M,F),W=H.indexOf(C,F),ce&&(ye(),ne))return Te();if(y&&he.length>=y)return Te(!0);break}re.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:he.length,index:F}),W++}}else W++}return Re();function de(Se){he.push(Se),ae=F}function _e(Se){var qe=0;if(Se!==-1){var ke=H.substring(W+1,Se);ke&&ke.trim()===""&&(qe=ke.length)}return qe}function Re(Se){return V||(Se===void 0&&(Se=H.substring(F)),X.push(Se),F=N,de(X),ce&&ye()),Te()}function Ee(Se){F=Se,de(X),X=[],K=H.indexOf(z,F)}function Te(Se){return{data:he,errors:re,meta:{delimiter:M,linebreak:z,aborted:ne,truncated:!!Se,cursor:ae+(ie||0)}}}function ye(){D(Te()),he=[],re=[]}},this.abort=function(){ne=!0},this.getCharIndex=function(){return F}}function S(A){var C=A.data,M=l[C.workerId],z=!1;if(C.error)M.userError(C.error,C.file);else if(C.results&&C.results.data){var w={abort:function(){z=!0,R(C.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:P,resume:P};if(U(M.userStep)){for(var D=0;D<C.results.data.length&&(M.userStep({data:C.results.data[D],errors:C.results.errors,meta:C.results.meta},w),!z);D++);delete C.results}else U(M.userChunk)&&(M.userChunk(C.results,w,C.file),delete C.results)}C.finished&&!z&&R(C.workerId,C.results)}function R(A,C){var M=l[A];U(M.userComplete)&&M.userComplete(C),M.terminate(),delete l[A]}function P(){throw new Error("Not implemented.")}function x(A){if(typeof A!="object"||A===null)return A;var C=Array.isArray(A)?[]:{};for(var M in A)C[M]=x(A[M]);return C}function B(A,C){return function(){A.apply(C,arguments)}}function U(A){return typeof A=="function"}return s&&(o.onmessage=function(A){var C=A.data;if(d.WORKER_ID===void 0&&C&&(d.WORKER_ID=C.workerId),typeof C.input=="string")o.postMessage({workerId:d.WORKER_ID,results:d.parse(C.input,C.config),finished:!0});else if(o.File&&C.input instanceof File||C.input instanceof Object){var M=d.parse(C.input,C.config);M&&o.postMessage({workerId:d.WORKER_ID,results:M,finished:!0})}}),(h.prototype=Object.create(f.prototype)).constructor=h,(p.prototype=Object.create(f.prototype)).constructor=p,(m.prototype=Object.create(m.prototype)).constructor=m,(T.prototype=Object.create(f.prototype)).constructor=T,d})})(ct)),ct.exports}var ef=jc();const Di=bi(ef);function lt(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Rt={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Bo;function tf(){return Bo||(Bo=1,(function(t,e){(function(n){t.exports=n()})(function(){return(function n(o,i,s){function l(c,f){if(!i[c]){if(!o[c]){var h=typeof lt=="function"&&lt;if(!f&&h)return h(c,!0);if(u)return u(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var m=i[c]={exports:{}};o[c][0].call(m.exports,function(T){var v=o[c][1][T];return l(v||T)},m,m.exports,n,o,i,s)}return i[c].exports}for(var u=typeof lt=="function"&&lt,d=0;d<s.length;d++)l(s[d]);return l})({1:[function(n,o,i){var s=n("./utils"),l=n("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(d){for(var c,f,h,p,m,T,v,_=[],E=0,S=d.length,R=S,P=s.getTypeOf(d)!=="string";E<d.length;)R=S-E,h=P?(c=d[E++],f=E<S?d[E++]:0,E<S?d[E++]:0):(c=d.charCodeAt(E++),f=E<S?d.charCodeAt(E++):0,E<S?d.charCodeAt(E++):0),p=c>>2,m=(3&c)<<4|f>>4,T=1<R?(15&f)<<2|h>>6:64,v=2<R?63&h:64,_.push(u.charAt(p)+u.charAt(m)+u.charAt(T)+u.charAt(v));return _.join("")},i.decode=function(d){var c,f,h,p,m,T,v=0,_=0,E="data:";if(d.substr(0,E.length)===E)throw new Error("Invalid base64 input, it looks like a data url.");var S,R=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===u.charAt(64)&&R--,d.charAt(d.length-2)===u.charAt(64)&&R--,R%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=l.uint8array?new Uint8Array(0|R):new Array(0|R);v<d.length;)c=u.indexOf(d.charAt(v++))<<2|(p=u.indexOf(d.charAt(v++)))>>4,f=(15&p)<<4|(m=u.indexOf(d.charAt(v++)))>>2,h=(3&m)<<6|(T=u.indexOf(d.charAt(v++))),S[_++]=c,m!==64&&(S[_++]=f),T!==64&&(S[_++]=h);return S}},{"./support":30,"./utils":32}],2:[function(n,o,i){var s=n("./external"),l=n("./stream/DataWorker"),u=n("./stream/Crc32Probe"),d=n("./stream/DataLengthProbe");function c(f,h,p,m,T){this.compressedSize=f,this.uncompressedSize=h,this.crc32=p,this.compression=m,this.compressedContent=T}c.prototype={getContentWorker:function(){var f=new l(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),h=this;return f.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),f},getCompressedWorker:function(){return new l(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(f,h,p){return f.pipe(new u).pipe(new d("uncompressedSize")).pipe(h.compressWorker(p)).pipe(new d("compressedSize")).withStreamInfo("compression",h)},o.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,o,i){var s=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,o,i){var s=n("./utils"),l=(function(){for(var u,d=[],c=0;c<256;c++){u=c;for(var f=0;f<8;f++)u=1&u?3988292384^u>>>1:u>>>1;d[c]=u}return d})();o.exports=function(u,d){return u!==void 0&&u.length?s.getTypeOf(u)!=="string"?(function(c,f,h,p){var m=l,T=p+h;c^=-1;for(var v=p;v<T;v++)c=c>>>8^m[255&(c^f[v])];return-1^c})(0|d,u,u.length,0):(function(c,f,h,p){var m=l,T=p+h;c^=-1;for(var v=p;v<T;v++)c=c>>>8^m[255&(c^f.charCodeAt(v))];return-1^c})(0|d,u,u.length,0):0}},{"./utils":32}],5:[function(n,o,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,o,i){var s=null;s=typeof Promise<"u"?Promise:n("lie"),o.exports={Promise:s}},{lie:37}],7:[function(n,o,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=n("pako"),u=n("./utils"),d=n("./stream/GenericWorker"),c=s?"uint8array":"array";function f(h,p){d.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=p,this.meta={}}i.magic="\b\0",u.inherits(f,d),f.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(c,h.data),!1)},f.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},f.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},f.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(p){h.push({data:p,meta:h.meta})}},i.compressWorker=function(h){return new f("Deflate",h)},i.uncompressWorker=function(){return new f("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,o,i){function s(m,T){var v,_="";for(v=0;v<T;v++)_+=String.fromCharCode(255&m),m>>>=8;return _}function l(m,T,v,_,E,S){var R,P,x=m.file,B=m.compression,U=S!==c.utf8encode,A=u.transformTo("string",S(x.name)),C=u.transformTo("string",c.utf8encode(x.name)),M=x.comment,z=u.transformTo("string",S(M)),w=u.transformTo("string",c.utf8encode(M)),D=C.length!==x.name.length,y=w.length!==M.length,O="",te="",F="",ne=x.dir,H=x.date,ie={crc32:0,compressedSize:0,uncompressedSize:0};T&&!v||(ie.crc32=m.crc32,ie.compressedSize=m.compressedSize,ie.uncompressedSize=m.uncompressedSize);var V=0;T&&(V|=8),U||!D&&!y||(V|=2048);var N=0,Q=0;ne&&(N|=16),E==="UNIX"?(Q=798,N|=(function(Y,ce){var he=Y;return Y||(he=ce?16893:33204),(65535&he)<<16})(x.unixPermissions,ne)):(Q=20,N|=(function(Y){return 63&(Y||0)})(x.dosPermissions)),R=H.getUTCHours(),R<<=6,R|=H.getUTCMinutes(),R<<=5,R|=H.getUTCSeconds()/2,P=H.getUTCFullYear()-1980,P<<=4,P|=H.getUTCMonth()+1,P<<=5,P|=H.getUTCDate(),D&&(te=s(1,1)+s(f(A),4)+C,O+="up"+s(te.length,2)+te),y&&(F=s(1,1)+s(f(z),4)+w,O+="uc"+s(F.length,2)+F);var Z="";return Z+=`
\0`,Z+=s(V,2),Z+=B.magic,Z+=s(R,2),Z+=s(P,2),Z+=s(ie.crc32,4),Z+=s(ie.compressedSize,4),Z+=s(ie.uncompressedSize,4),Z+=s(A.length,2),Z+=s(O.length,2),{fileRecord:h.LOCAL_FILE_HEADER+Z+A+O,dirRecord:h.CENTRAL_FILE_HEADER+s(Q,2)+Z+s(z.length,2)+"\0\0\0\0"+s(N,4)+s(_,4)+A+O+z}}var u=n("../utils"),d=n("../stream/GenericWorker"),c=n("../utf8"),f=n("../crc32"),h=n("../signature");function p(m,T,v,_){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=T,this.zipPlatform=v,this.encodeFileName=_,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(p,d),p.prototype.push=function(m){var T=m.meta.percent||0,v=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,d.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:v?(T+100*(v-_-1))/v:100}}))},p.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var T=this.streamFiles&&!m.file.dir;if(T){var v=l(m,T,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(m){this.accumulate=!1;var T=this.streamFiles&&!m.file.dir,v=l(m,T,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),T)this.push({data:(function(_){return h.DATA_DESCRIPTOR+s(_.crc32,4)+s(_.compressedSize,4)+s(_.uncompressedSize,4)})(m),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var m=this.bytesWritten,T=0;T<this.dirRecords.length;T++)this.push({data:this.dirRecords[T],meta:{percent:100}});var v=this.bytesWritten-m,_=(function(E,S,R,P,x){var B=u.transformTo("string",x(P));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(E,2)+s(E,2)+s(S,4)+s(R,4)+s(B.length,2)+B})(this.dirRecords.length,v,m,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(m){this._sources.push(m);var T=this;return m.on("data",function(v){T.processChunk(v)}),m.on("end",function(){T.closedSource(T.previous.streamInfo),T._sources.length?T.prepareNextSource():T.end()}),m.on("error",function(v){T.error(v)}),this},p.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(m){var T=this._sources;if(!d.prototype.error.call(this,m))return!1;for(var v=0;v<T.length;v++)try{T[v].error(m)}catch{}return!0},p.prototype.lock=function(){d.prototype.lock.call(this);for(var m=this._sources,T=0;T<m.length;T++)m[T].lock()},o.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,o,i){var s=n("../compressions"),l=n("./ZipFileWorker");i.generateWorker=function(u,d,c){var f=new l(d.streamFiles,c,d.platform,d.encodeFileName),h=0;try{u.forEach(function(p,m){h++;var T=(function(S,R){var P=S||R,x=s[P];if(!x)throw new Error(P+" is not a valid compression method !");return x})(m.options.compression,d.compression),v=m.options.compressionOptions||d.compressionOptions||{},_=m.dir,E=m.date;m._compressWorker(T,v).withStreamInfo("file",{name:p,dir:_,date:E,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(f)}),f.entriesCount=h}catch(p){f.error(p)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,o,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new s;for(var u in this)typeof this[u]!="function"&&(l[u]=this[u]);return l}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(l,u){return new s().loadAsync(l,u)},s.external=n("./external"),o.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,o,i){var s=n("./utils"),l=n("./external"),u=n("./utf8"),d=n("./zipEntries"),c=n("./stream/Crc32Probe"),f=n("./nodejsUtils");function h(p){return new l.Promise(function(m,T){var v=p.decompressed.getContentWorker().pipe(new c);v.on("error",function(_){T(_)}).on("end",function(){v.streamInfo.crc32!==p.decompressed.crc32?T(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}o.exports=function(p,m){var T=this;return m=s.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),f.isNode&&f.isStream(p)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",p,!0,m.optimizedBinaryString,m.base64).then(function(v){var _=new d(m);return _.load(v),_}).then(function(v){var _=[l.Promise.resolve(v)],E=v.files;if(m.checkCRC32)for(var S=0;S<E.length;S++)_.push(h(E[S]));return l.Promise.all(_)}).then(function(v){for(var _=v.shift(),E=_.files,S=0;S<E.length;S++){var R=E[S],P=R.fileNameStr,x=s.resolve(R.fileNameStr);T.file(x,R.decompressed,{binary:!0,optimizedBinaryString:!0,date:R.date,dir:R.dir,comment:R.fileCommentStr.length?R.fileCommentStr:null,unixPermissions:R.unixPermissions,dosPermissions:R.dosPermissions,createFolders:m.createFolders}),R.dir||(T.file(x).unsafeOriginalName=P)}return _.zipComment.length&&(T.comment=_.zipComment),T})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,o,i){var s=n("../utils"),l=n("../stream/GenericWorker");function u(d,c){l.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(u,l),u.prototype._bindStream=function(d){var c=this;(this._stream=d).pause(),d.on("data",function(f){c.push({data:f,meta:{percent:0}})}).on("error",function(f){c.isPaused?this.generatedError=f:c.error(f)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},u.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},o.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,o,i){var s=n("readable-stream").Readable;function l(u,d,c){s.call(this,d),this._helper=u;var f=this;u.on("data",function(h,p){f.push(h)||f._helper.pause(),c&&c(p)}).on("error",function(h){f.emit("error",h)}).on("end",function(){f.push(null)})}n("../utils").inherits(l,s),l.prototype._read=function(){this._helper.resume()},o.exports=l},{"../utils":32,"readable-stream":16}],14:[function(n,o,i){o.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,l);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,l)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var l=new Buffer(s);return l.fill(0),l},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,o,i){function s(x,B,U){var A,C=u.getTypeOf(B),M=u.extend(U||{},f);M.date=M.date||new Date,M.compression!==null&&(M.compression=M.compression.toUpperCase()),typeof M.unixPermissions=="string"&&(M.unixPermissions=parseInt(M.unixPermissions,8)),M.unixPermissions&&16384&M.unixPermissions&&(M.dir=!0),M.dosPermissions&&16&M.dosPermissions&&(M.dir=!0),M.dir&&(x=E(x)),M.createFolders&&(A=_(x))&&S.call(this,A,!0);var z=C==="string"&&M.binary===!1&&M.base64===!1;U&&U.binary!==void 0||(M.binary=!z),(B instanceof h&&B.uncompressedSize===0||M.dir||!B||B.length===0)&&(M.base64=!1,M.binary=!0,B="",M.compression="STORE",C="string");var w=null;w=B instanceof h||B instanceof d?B:T.isNode&&T.isStream(B)?new v(x,B):u.prepareContent(x,B,M.binary,M.optimizedBinaryString,M.base64);var D=new p(x,w,M);this.files[x]=D}var l=n("./utf8"),u=n("./utils"),d=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),f=n("./defaults"),h=n("./compressedObject"),p=n("./zipObject"),m=n("./generate"),T=n("./nodejsUtils"),v=n("./nodejs/NodejsStreamInputAdapter"),_=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var B=x.lastIndexOf("/");return 0<B?x.substring(0,B):""},E=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},S=function(x,B){return B=B!==void 0?B:f.createFolders,x=E(x),this.files[x]||s.call(this,x,null,{dir:!0,createFolders:B}),this.files[x]};function R(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var P={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var B,U,A;for(B in this.files)A=this.files[B],(U=B.slice(this.root.length,B.length))&&B.slice(0,this.root.length)===this.root&&x(U,A)},filter:function(x){var B=[];return this.forEach(function(U,A){x(U,A)&&B.push(A)}),B},file:function(x,B,U){if(arguments.length!==1)return x=this.root+x,s.call(this,x,B,U),this;if(R(x)){var A=x;return this.filter(function(M,z){return!z.dir&&A.test(M)})}var C=this.files[this.root+x];return C&&!C.dir?C:null},folder:function(x){if(!x)return this;if(R(x))return this.filter(function(C,M){return M.dir&&x.test(C)});var B=this.root+x,U=S.call(this,B),A=this.clone();return A.root=U.name,A},remove:function(x){x=this.root+x;var B=this.files[x];if(B||(x.slice(-1)!=="/"&&(x+="/"),B=this.files[x]),B&&!B.dir)delete this.files[x];else for(var U=this.filter(function(C,M){return M.name.slice(0,x.length)===x}),A=0;A<U.length;A++)delete this.files[U[A].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var B,U={};try{if((U=u.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=U.type.toLowerCase(),U.compression=U.compression.toUpperCase(),U.type==="binarystring"&&(U.type="string"),!U.type)throw new Error("No output type specified.");u.checkSupport(U.type),U.platform!=="darwin"&&U.platform!=="freebsd"&&U.platform!=="linux"&&U.platform!=="sunos"||(U.platform="UNIX"),U.platform==="win32"&&(U.platform="DOS");var A=U.comment||this.comment||"";B=m.generateWorker(this,U,A)}catch(C){(B=new d("error")).error(C)}return new c(B,U.type||"string",U.mimeType)},generateAsync:function(x,B){return this.generateInternalStream(x).accumulate(B)},generateNodeStream:function(x,B){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(B)}};o.exports=P},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,o,i){o.exports=n("stream")},{stream:void 0}],17:[function(n,o,i){var s=n("./DataReader");function l(u){s.call(this,u);for(var d=0;d<this.data.length;d++)u[d]=255&u[d]}n("../utils").inherits(l,s),l.prototype.byteAt=function(u){return this.data[this.zero+u]},l.prototype.lastIndexOfSignature=function(u){for(var d=u.charCodeAt(0),c=u.charCodeAt(1),f=u.charCodeAt(2),h=u.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===d&&this.data[p+1]===c&&this.data[p+2]===f&&this.data[p+3]===h)return p-this.zero;return-1},l.prototype.readAndCheckSignature=function(u){var d=u.charCodeAt(0),c=u.charCodeAt(1),f=u.charCodeAt(2),h=u.charCodeAt(3),p=this.readData(4);return d===p[0]&&c===p[1]&&f===p[2]&&h===p[3]},l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},o.exports=l},{"../utils":32,"./DataReader":18}],18:[function(n,o,i){var s=n("../utils");function l(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var d,c=0;for(this.checkOffset(u),d=this.index+u-1;d>=this.index;d--)c=(c<<8)+this.byteAt(d);return this.index+=u,c},readString:function(u){return s.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},o.exports=l},{"../utils":32}],19:[function(n,o,i){var s=n("./Uint8ArrayReader");function l(u){s.call(this,u)}n("../utils").inherits(l,s),l.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},o.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,o,i){var s=n("./DataReader");function l(u){s.call(this,u)}n("../utils").inherits(l,s),l.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},l.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},l.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},l.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},o.exports=l},{"../utils":32,"./DataReader":18}],21:[function(n,o,i){var s=n("./ArrayReader");function l(u){s.call(this,u)}n("../utils").inherits(l,s),l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},o.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(n,o,i){var s=n("../utils"),l=n("../support"),u=n("./ArrayReader"),d=n("./StringReader"),c=n("./NodeBufferReader"),f=n("./Uint8ArrayReader");o.exports=function(h){var p=s.getTypeOf(h);return s.checkSupport(p),p!=="string"||l.uint8array?p==="nodebuffer"?new c(h):l.uint8array?new f(s.transformTo("uint8array",h)):new u(s.transformTo("array",h)):new d(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,o,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,o,i){var s=n("./GenericWorker"),l=n("../utils");function u(d){s.call(this,"ConvertWorker to "+d),this.destType=d}l.inherits(u,s),u.prototype.processChunk=function(d){this.push({data:l.transformTo(this.destType,d.data),meta:d.meta})},o.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(n,o,i){var s=n("./GenericWorker"),l=n("../crc32");function u(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(u,s),u.prototype.processChunk=function(d){this.streamInfo.crc32=l(d.data,this.streamInfo.crc32||0),this.push(d)},o.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,o,i){var s=n("../utils"),l=n("./GenericWorker");function u(d){l.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}s.inherits(u,l),u.prototype.processChunk=function(d){if(d){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+d.data.length}l.prototype.processChunk.call(this,d)},o.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(n,o,i){var s=n("../utils"),l=n("./GenericWorker");function u(d){l.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(f){c.dataIsReady=!0,c.data=f,c.max=f&&f.length||0,c.type=s.getTypeOf(f),c.isPaused||c._tickAndRepeat()},function(f){c.error(f)})}s.inherits(u,l),u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,c);break;case"uint8array":d=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":d=this.data.slice(this.index,c)}return this.index=c,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},o.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(n,o,i){function s(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,u){return this._listeners[l].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,u){if(this._listeners[l])for(var d=0;d<this._listeners[l].length;d++)this._listeners[l][d].call(this,u)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var u=this;return l.on("data",function(d){u.processChunk(d)}),l.on("end",function(){u.end()}),l.on("error",function(d){u.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,u){return this.extraStreamInfo[l]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},o.exports=s},{}],29:[function(n,o,i){var s=n("../utils"),l=n("./ConvertWorker"),u=n("./GenericWorker"),d=n("../base64"),c=n("../support"),f=n("../external"),h=null;if(c.nodestream)try{h=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(T,v){return new f.Promise(function(_,E){var S=[],R=T._internalType,P=T._outputType,x=T._mimeType;T.on("data",function(B,U){S.push(B),v&&v(U)}).on("error",function(B){S=[],E(B)}).on("end",function(){try{var B=(function(U,A,C){switch(U){case"blob":return s.newBlob(s.transformTo("arraybuffer",A),C);case"base64":return d.encode(A);default:return s.transformTo(U,A)}})(P,(function(U,A){var C,M=0,z=null,w=0;for(C=0;C<A.length;C++)w+=A[C].length;switch(U){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(z=new Uint8Array(w),C=0;C<A.length;C++)z.set(A[C],M),M+=A[C].length;return z;case"nodebuffer":return Buffer.concat(A);default:throw new Error("concat : unsupported type '"+U+"'")}})(R,S),x);_(B)}catch(U){E(U)}S=[]}).resume()})}function m(T,v,_){var E=v;switch(v){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string"}try{this._internalType=E,this._outputType=v,this._mimeType=_,s.checkSupport(E),this._worker=T.pipe(new l(E)),T.lock()}catch(S){this._worker=new u("error"),this._worker.error(S)}}m.prototype={accumulate:function(T){return p(this,T)},on:function(T,v){var _=this;return T==="data"?this._worker.on(T,function(E){v.call(_,E.data,E.meta)}):this._worker.on(T,function(){s.delay(v,arguments,_)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(T){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},T)}},o.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,o,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(s),i.blob=l.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,o,i){for(var s=n("./utils"),l=n("./support"),u=n("./nodejsUtils"),d=n("./stream/GenericWorker"),c=new Array(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;c[254]=c[254]=1;function h(){d.call(this,"utf-8 decode"),this.leftOver=null}function p(){d.call(this,"utf-8 encode")}i.utf8encode=function(m){return l.nodebuffer?u.newBufferFrom(m,"utf-8"):(function(T){var v,_,E,S,R,P=T.length,x=0;for(S=0;S<P;S++)(64512&(_=T.charCodeAt(S)))==55296&&S+1<P&&(64512&(E=T.charCodeAt(S+1)))==56320&&(_=65536+(_-55296<<10)+(E-56320),S++),x+=_<128?1:_<2048?2:_<65536?3:4;for(v=l.uint8array?new Uint8Array(x):new Array(x),S=R=0;R<x;S++)(64512&(_=T.charCodeAt(S)))==55296&&S+1<P&&(64512&(E=T.charCodeAt(S+1)))==56320&&(_=65536+(_-55296<<10)+(E-56320),S++),_<128?v[R++]=_:(_<2048?v[R++]=192|_>>>6:(_<65536?v[R++]=224|_>>>12:(v[R++]=240|_>>>18,v[R++]=128|_>>>12&63),v[R++]=128|_>>>6&63),v[R++]=128|63&_);return v})(m)},i.utf8decode=function(m){return l.nodebuffer?s.transformTo("nodebuffer",m).toString("utf-8"):(function(T){var v,_,E,S,R=T.length,P=new Array(2*R);for(v=_=0;v<R;)if((E=T[v++])<128)P[_++]=E;else if(4<(S=c[E]))P[_++]=65533,v+=S-1;else{for(E&=S===2?31:S===3?15:7;1<S&&v<R;)E=E<<6|63&T[v++],S--;1<S?P[_++]=65533:E<65536?P[_++]=E:(E-=65536,P[_++]=55296|E>>10&1023,P[_++]=56320|1023&E)}return P.length!==_&&(P.subarray?P=P.subarray(0,_):P.length=_),s.applyFromCharCode(P)})(m=s.transformTo(l.uint8array?"uint8array":"array",m))},s.inherits(h,d),h.prototype.processChunk=function(m){var T=s.transformTo(l.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var v=T;(T=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),T.set(v,this.leftOver.length)}else T=this.leftOver.concat(T);this.leftOver=null}var _=(function(S,R){var P;for((R=R||S.length)>S.length&&(R=S.length),P=R-1;0<=P&&(192&S[P])==128;)P--;return P<0||P===0?R:P+c[S[P]]>R?P:R})(T),E=T;_!==T.length&&(l.uint8array?(E=T.subarray(0,_),this.leftOver=T.subarray(_,T.length)):(E=T.slice(0,_),this.leftOver=T.slice(_,T.length))),this.push({data:i.utf8decode(E),meta:m.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=h,s.inherits(p,d),p.prototype.processChunk=function(m){this.push({data:i.utf8encode(m.data),meta:m.meta})},i.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,o,i){var s=n("./support"),l=n("./base64"),u=n("./nodejsUtils"),d=n("./external");function c(v){return v}function f(v,_){for(var E=0;E<v.length;++E)_[E]=255&v.charCodeAt(E);return _}n("setimmediate"),i.newBlob=function(v,_){i.checkSupport("blob");try{return new Blob([v],{type:_})}catch{try{var E=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return E.append(v),E.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(v,_,E){var S=[],R=0,P=v.length;if(P<=E)return String.fromCharCode.apply(null,v);for(;R<P;)_==="array"||_==="nodebuffer"?S.push(String.fromCharCode.apply(null,v.slice(R,Math.min(R+E,P)))):S.push(String.fromCharCode.apply(null,v.subarray(R,Math.min(R+E,P)))),R+=E;return S.join("")},stringifyByChar:function(v){for(var _="",E=0;E<v.length;E++)_+=String.fromCharCode(v[E]);return _},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}})()}};function p(v){var _=65536,E=i.getTypeOf(v),S=!0;if(E==="uint8array"?S=h.applyCanBeUsed.uint8array:E==="nodebuffer"&&(S=h.applyCanBeUsed.nodebuffer),S)for(;1<_;)try{return h.stringifyByChunk(v,E,_)}catch{_=Math.floor(_/2)}return h.stringifyByChar(v)}function m(v,_){for(var E=0;E<v.length;E++)_[E]=v[E];return _}i.applyFromCharCode=p;var T={};T.string={string:c,array:function(v){return f(v,new Array(v.length))},arraybuffer:function(v){return T.string.uint8array(v).buffer},uint8array:function(v){return f(v,new Uint8Array(v.length))},nodebuffer:function(v){return f(v,u.allocBuffer(v.length))}},T.array={string:p,array:c,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return u.newBufferFrom(v)}},T.arraybuffer={string:function(v){return p(new Uint8Array(v))},array:function(v){return m(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:c,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return u.newBufferFrom(new Uint8Array(v))}},T.uint8array={string:p,array:function(v){return m(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:c,nodebuffer:function(v){return u.newBufferFrom(v)}},T.nodebuffer={string:p,array:function(v){return m(v,new Array(v.length))},arraybuffer:function(v){return T.nodebuffer.uint8array(v).buffer},uint8array:function(v){return m(v,new Uint8Array(v.length))},nodebuffer:c},i.transformTo=function(v,_){if(_=_||"",!v)return _;i.checkSupport(v);var E=i.getTypeOf(_);return T[E][v](_)},i.resolve=function(v){for(var _=v.split("/"),E=[],S=0;S<_.length;S++){var R=_[S];R==="."||R===""&&S!==0&&S!==_.length-1||(R===".."?E.pop():E.push(R))}return E.join("/")},i.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":s.nodebuffer&&u.isBuffer(v)?"nodebuffer":s.uint8array&&v instanceof Uint8Array?"uint8array":s.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(v){if(!s[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(v){var _,E,S="";for(E=0;E<(v||"").length;E++)S+="\\x"+((_=v.charCodeAt(E))<16?"0":"")+_.toString(16).toUpperCase();return S},i.delay=function(v,_,E){setImmediate(function(){v.apply(E||null,_||[])})},i.inherits=function(v,_){function E(){}E.prototype=_.prototype,v.prototype=new E},i.extend=function(){var v,_,E={};for(v=0;v<arguments.length;v++)for(_ in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],_)&&E[_]===void 0&&(E[_]=arguments[v][_]);return E},i.prepareContent=function(v,_,E,S,R){return d.Promise.resolve(_).then(function(P){return s.blob&&(P instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(P))!==-1)&&typeof FileReader<"u"?new d.Promise(function(x,B){var U=new FileReader;U.onload=function(A){x(A.target.result)},U.onerror=function(A){B(A.target.error)},U.readAsArrayBuffer(P)}):P}).then(function(P){var x=i.getTypeOf(P);return x?(x==="arraybuffer"?P=i.transformTo("uint8array",P):x==="string"&&(R?P=l.decode(P):E&&S!==!0&&(P=(function(B){return f(B,s.uint8array?new Uint8Array(B.length):new Array(B.length))})(P))),P):d.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,o,i){var s=n("./reader/readerFor"),l=n("./utils"),u=n("./signature"),d=n("./zipEntry"),c=n("./support");function f(h){this.files=[],this.loadOptions=h}f.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(p)+", expected "+l.pretty(h)+")")}},isSignature:function(h,p){var m=this.reader.index;this.reader.setIndex(h);var T=this.reader.readString(4)===p;return this.reader.setIndex(m),T},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),p=c.uint8array?"uint8array":"array",m=l.transformTo(p,h);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,p,m,T=this.zip64EndOfCentralSize-44;0<T;)h=this.reader.readInt(2),p=this.reader.readInt(4),m=this.reader.readData(p),this.zip64ExtensibleData[h]={id:h,length:p,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,p;for(h=0;h<this.files.length;h++)p=this.files[h],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(h=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var p=h;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var T=p-m;if(0<T)this.isSignature(p,u.CENTRAL_FILE_HEADER)||(this.reader.zero=T);else if(T<0)throw new Error("Corrupted zip: missing "+Math.abs(T)+" bytes.")},prepareReader:function(h){this.reader=s(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},o.exports=f},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,o,i){var s=n("./reader/readerFor"),l=n("./utils"),u=n("./compressedObject"),d=n("./crc32"),c=n("./utf8"),f=n("./compressions"),h=n("./support");function p(m,T){this.options=m,this.loadOptions=T}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var T,v;if(m.skip(22),this.fileNameLength=m.readInt(2),v=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((T=(function(_){for(var E in f)if(Object.prototype.hasOwnProperty.call(f,E)&&f[E].magic===_)return f[E];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,T,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var T=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(T),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=s(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var T,v,_,E=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<E;)T=m.readInt(2),v=m.readInt(2),_=m.readData(v),this.extraFields[T]={id:T,length:v,value:_};m.setIndex(E)},handleUTF8:function(){var m=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var T=this.findExtraFieldUnicodePath();if(T!==null)this.fileNameStr=T;else{var v=l.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var E=l.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(E)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var T=s(m.value);return T.readInt(1)!==1||d(this.fileName)!==T.readInt(4)?null:c.utf8decode(T.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var T=s(m.value);return T.readInt(1)!==1||d(this.fileComment)!==T.readInt(4)?null:c.utf8decode(T.readData(m.length-5))}return null}},o.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,o,i){function s(T,v,_){this.name=T,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=v,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var l=n("./stream/StreamHelper"),u=n("./stream/DataWorker"),d=n("./utf8"),c=n("./compressedObject"),f=n("./stream/GenericWorker");s.prototype={internalStream:function(T){var v=null,_="string";try{if(!T)throw new Error("No output type specified.");var E=(_=T.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),v=this._decompressWorker();var S=!this._dataBinary;S&&!E&&(v=v.pipe(new d.Utf8EncodeWorker)),!S&&E&&(v=v.pipe(new d.Utf8DecodeWorker))}catch(R){(v=new f("error")).error(R)}return new l(v,_,"")},async:function(T,v){return this.internalStream(T).accumulate(v)},nodeStream:function(T,v){return this.internalStream(T||"nodebuffer").toNodejsStream(v)},_compressWorker:function(T,v){if(this._data instanceof c&&this._data.compression.magic===T.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new d.Utf8EncodeWorker)),c.createWorkerFrom(_,T,v)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof f?this._data:new u(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<h.length;m++)s.prototype[h[m]]=p;o.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,o,i){(function(s){var l,u,d=s.MutationObserver||s.WebKitMutationObserver;if(d){var c=0,f=new d(T),h=s.document.createTextNode("");f.observe(h,{characterData:!0}),l=function(){h.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)l="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var v=s.document.createElement("script");v.onreadystatechange=function(){T(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:function(){setTimeout(T,0)};else{var p=new s.MessageChannel;p.port1.onmessage=T,l=function(){p.port2.postMessage(0)}}var m=[];function T(){var v,_;u=!0;for(var E=m.length;E;){for(_=m,m=[],v=-1;++v<E;)_[v]();E=m.length}u=!1}o.exports=function(v){m.push(v)!==1||u||l()}}).call(this,typeof Ge<"u"?Ge:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,o,i){var s=n("immediate");function l(){}var u={},d=["REJECTED"],c=["FULFILLED"],f=["PENDING"];function h(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,E!==l&&v(this,E)}function p(E,S,R){this.promise=E,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}function m(E,S,R){s(function(){var P;try{P=S(R)}catch(x){return u.reject(E,x)}P===E?u.reject(E,new TypeError("Cannot resolve promise with itself")):u.resolve(E,P)})}function T(E){var S=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof S=="function")return function(){S.apply(E,arguments)}}function v(E,S){var R=!1;function P(U){R||(R=!0,u.reject(E,U))}function x(U){R||(R=!0,u.resolve(E,U))}var B=_(function(){S(x,P)});B.status==="error"&&P(B.value)}function _(E,S){var R={};try{R.value=E(S),R.status="success"}catch(P){R.status="error",R.value=P}return R}(o.exports=h).prototype.finally=function(E){if(typeof E!="function")return this;var S=this.constructor;return this.then(function(R){return S.resolve(E()).then(function(){return R})},function(R){return S.resolve(E()).then(function(){throw R})})},h.prototype.catch=function(E){return this.then(null,E)},h.prototype.then=function(E,S){if(typeof E!="function"&&this.state===c||typeof S!="function"&&this.state===d)return this;var R=new this.constructor(l);return this.state!==f?m(R,this.state===c?E:S,this.outcome):this.queue.push(new p(R,E,S)),R},p.prototype.callFulfilled=function(E){u.resolve(this.promise,E)},p.prototype.otherCallFulfilled=function(E){m(this.promise,this.onFulfilled,E)},p.prototype.callRejected=function(E){u.reject(this.promise,E)},p.prototype.otherCallRejected=function(E){m(this.promise,this.onRejected,E)},u.resolve=function(E,S){var R=_(T,S);if(R.status==="error")return u.reject(E,R.value);var P=R.value;if(P)v(E,P);else{E.state=c,E.outcome=S;for(var x=-1,B=E.queue.length;++x<B;)E.queue[x].callFulfilled(S)}return E},u.reject=function(E,S){E.state=d,E.outcome=S;for(var R=-1,P=E.queue.length;++R<P;)E.queue[R].callRejected(S);return E},h.resolve=function(E){return E instanceof this?E:u.resolve(new this(l),E)},h.reject=function(E){var S=new this(l);return u.reject(S,E)},h.all=function(E){var S=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=E.length,P=!1;if(!R)return this.resolve([]);for(var x=new Array(R),B=0,U=-1,A=new this(l);++U<R;)C(E[U],U);return A;function C(M,z){S.resolve(M).then(function(w){x[z]=w,++B!==R||P||(P=!0,u.resolve(A,x))},function(w){P||(P=!0,u.reject(A,w))})}},h.race=function(E){var S=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=E.length,P=!1;if(!R)return this.resolve([]);for(var x=-1,B=new this(l);++x<R;)U=E[x],S.resolve(U).then(function(A){P||(P=!0,u.resolve(B,A))},function(A){P||(P=!0,u.reject(B,A))});var U;return B}},{immediate:36}],38:[function(n,o,i){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),o.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,o,i){var s=n("./zlib/deflate"),l=n("./utils/common"),u=n("./utils/strings"),d=n("./zlib/messages"),c=n("./zlib/zstream"),f=Object.prototype.toString,h=0,p=-1,m=0,T=8;function v(E){if(!(this instanceof v))return new v(E);this.options=l.assign({level:p,method:T,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},E||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var R=s.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(R!==h)throw new Error(d[R]);if(S.header&&s.deflateSetHeader(this.strm,S.header),S.dictionary){var P;if(P=typeof S.dictionary=="string"?u.string2buf(S.dictionary):f.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(R=s.deflateSetDictionary(this.strm,P))!==h)throw new Error(d[R]);this._dict_set=!0}}function _(E,S){var R=new v(S);if(R.push(E,!0),R.err)throw R.msg||d[R.err];return R.result}v.prototype.push=function(E,S){var R,P,x=this.strm,B=this.options.chunkSize;if(this.ended)return!1;P=S===~~S?S:S===!0?4:0,typeof E=="string"?x.input=u.string2buf(E):f.call(E)==="[object ArrayBuffer]"?x.input=new Uint8Array(E):x.input=E,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new l.Buf8(B),x.next_out=0,x.avail_out=B),(R=s.deflate(x,P))!==1&&R!==h)return this.onEnd(R),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||P!==4&&P!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(l.shrinkBuf(x.output,x.next_out))):this.onData(l.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&R!==1);return P===4?(R=s.deflateEnd(this.strm),this.onEnd(R),this.ended=!0,R===h):P!==2||(this.onEnd(h),!(x.avail_out=0))},v.prototype.onData=function(E){this.chunks.push(E)},v.prototype.onEnd=function(E){E===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},i.Deflate=v,i.deflate=_,i.deflateRaw=function(E,S){return(S=S||{}).raw=!0,_(E,S)},i.gzip=function(E,S){return(S=S||{}).gzip=!0,_(E,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,o,i){var s=n("./zlib/inflate"),l=n("./utils/common"),u=n("./utils/strings"),d=n("./zlib/constants"),c=n("./zlib/messages"),f=n("./zlib/zstream"),h=n("./zlib/gzheader"),p=Object.prototype.toString;function m(v){if(!(this instanceof m))return new m(v);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},v||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||v&&v.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&(15&_.windowBits)==0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var E=s.inflateInit2(this.strm,_.windowBits);if(E!==d.Z_OK)throw new Error(c[E]);this.header=new h,s.inflateGetHeader(this.strm,this.header)}function T(v,_){var E=new m(_);if(E.push(v,!0),E.err)throw E.msg||c[E.err];return E.result}m.prototype.push=function(v,_){var E,S,R,P,x,B,U=this.strm,A=this.options.chunkSize,C=this.options.dictionary,M=!1;if(this.ended)return!1;S=_===~~_?_:_===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof v=="string"?U.input=u.binstring2buf(v):p.call(v)==="[object ArrayBuffer]"?U.input=new Uint8Array(v):U.input=v,U.next_in=0,U.avail_in=U.input.length;do{if(U.avail_out===0&&(U.output=new l.Buf8(A),U.next_out=0,U.avail_out=A),(E=s.inflate(U,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&C&&(B=typeof C=="string"?u.string2buf(C):p.call(C)==="[object ArrayBuffer]"?new Uint8Array(C):C,E=s.inflateSetDictionary(this.strm,B)),E===d.Z_BUF_ERROR&&M===!0&&(E=d.Z_OK,M=!1),E!==d.Z_STREAM_END&&E!==d.Z_OK)return this.onEnd(E),!(this.ended=!0);U.next_out&&(U.avail_out!==0&&E!==d.Z_STREAM_END&&(U.avail_in!==0||S!==d.Z_FINISH&&S!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(R=u.utf8border(U.output,U.next_out),P=U.next_out-R,x=u.buf2string(U.output,R),U.next_out=P,U.avail_out=A-P,P&&l.arraySet(U.output,U.output,R,P,0),this.onData(x)):this.onData(l.shrinkBuf(U.output,U.next_out)))),U.avail_in===0&&U.avail_out===0&&(M=!0)}while((0<U.avail_in||U.avail_out===0)&&E!==d.Z_STREAM_END);return E===d.Z_STREAM_END&&(S=d.Z_FINISH),S===d.Z_FINISH?(E=s.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===d.Z_OK):S!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(U.avail_out=0))},m.prototype.onData=function(v){this.chunks.push(v)},m.prototype.onEnd=function(v){v===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Inflate=m,i.inflate=T,i.inflateRaw=function(v,_){return(_=_||{}).raw=!0,T(v,_)},i.ungzip=T},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,o,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(d){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var f=c.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var h in f)f.hasOwnProperty(h)&&(d[h]=f[h])}}return d},i.shrinkBuf=function(d,c){return d.length===c?d:d.subarray?d.subarray(0,c):(d.length=c,d)};var l={arraySet:function(d,c,f,h,p){if(c.subarray&&d.subarray)d.set(c.subarray(f,f+h),p);else for(var m=0;m<h;m++)d[p+m]=c[f+m]},flattenChunks:function(d){var c,f,h,p,m,T;for(c=h=0,f=d.length;c<f;c++)h+=d[c].length;for(T=new Uint8Array(h),c=p=0,f=d.length;c<f;c++)m=d[c],T.set(m,p),p+=m.length;return T}},u={arraySet:function(d,c,f,h,p){for(var m=0;m<h;m++)d[p+m]=c[f+m]},flattenChunks:function(d){return[].concat.apply([],d)}};i.setTyped=function(d){d?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,l)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,u))},i.setTyped(s)},{}],42:[function(n,o,i){var s=n("./common"),l=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var d=new s.Buf8(256),c=0;c<256;c++)d[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function f(h,p){if(p<65537&&(h.subarray&&u||!h.subarray&&l))return String.fromCharCode.apply(null,s.shrinkBuf(h,p));for(var m="",T=0;T<p;T++)m+=String.fromCharCode(h[T]);return m}d[254]=d[254]=1,i.string2buf=function(h){var p,m,T,v,_,E=h.length,S=0;for(v=0;v<E;v++)(64512&(m=h.charCodeAt(v)))==55296&&v+1<E&&(64512&(T=h.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(T-56320),v++),S+=m<128?1:m<2048?2:m<65536?3:4;for(p=new s.Buf8(S),v=_=0;_<S;v++)(64512&(m=h.charCodeAt(v)))==55296&&v+1<E&&(64512&(T=h.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(T-56320),v++),m<128?p[_++]=m:(m<2048?p[_++]=192|m>>>6:(m<65536?p[_++]=224|m>>>12:(p[_++]=240|m>>>18,p[_++]=128|m>>>12&63),p[_++]=128|m>>>6&63),p[_++]=128|63&m);return p},i.buf2binstring=function(h){return f(h,h.length)},i.binstring2buf=function(h){for(var p=new s.Buf8(h.length),m=0,T=p.length;m<T;m++)p[m]=h.charCodeAt(m);return p},i.buf2string=function(h,p){var m,T,v,_,E=p||h.length,S=new Array(2*E);for(m=T=0;m<E;)if((v=h[m++])<128)S[T++]=v;else if(4<(_=d[v]))S[T++]=65533,m+=_-1;else{for(v&=_===2?31:_===3?15:7;1<_&&m<E;)v=v<<6|63&h[m++],_--;1<_?S[T++]=65533:v<65536?S[T++]=v:(v-=65536,S[T++]=55296|v>>10&1023,S[T++]=56320|1023&v)}return f(S,T)},i.utf8border=function(h,p){var m;for((p=p||h.length)>h.length&&(p=h.length),m=p-1;0<=m&&(192&h[m])==128;)m--;return m<0||m===0?p:m+d[h[m]]>p?m:p}},{"./common":41}],43:[function(n,o,i){o.exports=function(s,l,u,d){for(var c=65535&s|0,f=s>>>16&65535|0,h=0;u!==0;){for(u-=h=2e3<u?2e3:u;f=f+(c=c+l[d++]|0)|0,--h;);c%=65521,f%=65521}return c|f<<16|0}},{}],44:[function(n,o,i){o.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,o,i){var s=(function(){for(var l,u=[],d=0;d<256;d++){l=d;for(var c=0;c<8;c++)l=1&l?3988292384^l>>>1:l>>>1;u[d]=l}return u})();o.exports=function(l,u,d,c){var f=s,h=c+d;l^=-1;for(var p=c;p<h;p++)l=l>>>8^f[255&(l^u[p])];return-1^l}},{}],46:[function(n,o,i){var s,l=n("../utils/common"),u=n("./trees"),d=n("./adler32"),c=n("./crc32"),f=n("./messages"),h=0,p=4,m=0,T=-2,v=-1,_=4,E=2,S=8,R=9,P=286,x=30,B=19,U=2*P+1,A=15,C=3,M=258,z=M+C+1,w=42,D=113,y=1,O=2,te=3,F=4;function ne(g,q){return g.msg=f[q],q}function H(g){return(g<<1)-(4<g?9:0)}function ie(g){for(var q=g.length;0<=--q;)g[q]=0}function V(g){var q=g.state,G=q.pending;G>g.avail_out&&(G=g.avail_out),G!==0&&(l.arraySet(g.output,q.pending_buf,q.pending_out,G,g.next_out),g.next_out+=G,q.pending_out+=G,g.total_out+=G,g.avail_out-=G,q.pending-=G,q.pending===0&&(q.pending_out=0))}function N(g,q){u._tr_flush_block(g,0<=g.block_start?g.block_start:-1,g.strstart-g.block_start,q),g.block_start=g.strstart,V(g.strm)}function Q(g,q){g.pending_buf[g.pending++]=q}function Z(g,q){g.pending_buf[g.pending++]=q>>>8&255,g.pending_buf[g.pending++]=255&q}function Y(g,q){var G,k,I=g.max_chain_length,b=g.strstart,J=g.prev_length,$=g.nice_match,L=g.strstart>g.w_size-z?g.strstart-(g.w_size-z):0,K=g.window,j=g.w_mask,W=g.prev,oe=g.strstart+M,pe=K[b+J-1],de=K[b+J];g.prev_length>=g.good_match&&(I>>=2),$>g.lookahead&&($=g.lookahead);do if(K[(G=q)+J]===de&&K[G+J-1]===pe&&K[G]===K[b]&&K[++G]===K[b+1]){b+=2,G++;do;while(K[++b]===K[++G]&&K[++b]===K[++G]&&K[++b]===K[++G]&&K[++b]===K[++G]&&K[++b]===K[++G]&&K[++b]===K[++G]&&K[++b]===K[++G]&&K[++b]===K[++G]&&b<oe);if(k=M-(oe-b),b=oe-M,J<k){if(g.match_start=q,$<=(J=k))break;pe=K[b+J-1],de=K[b+J]}}while((q=W[q&j])>L&&--I!=0);return J<=g.lookahead?J:g.lookahead}function ce(g){var q,G,k,I,b,J,$,L,K,j,W=g.w_size;do{if(I=g.window_size-g.lookahead-g.strstart,g.strstart>=W+(W-z)){for(l.arraySet(g.window,g.window,W,W,0),g.match_start-=W,g.strstart-=W,g.block_start-=W,q=G=g.hash_size;k=g.head[--q],g.head[q]=W<=k?k-W:0,--G;);for(q=G=W;k=g.prev[--q],g.prev[q]=W<=k?k-W:0,--G;);I+=W}if(g.strm.avail_in===0)break;if(J=g.strm,$=g.window,L=g.strstart+g.lookahead,K=I,j=void 0,j=J.avail_in,K<j&&(j=K),G=j===0?0:(J.avail_in-=j,l.arraySet($,J.input,J.next_in,j,L),J.state.wrap===1?J.adler=d(J.adler,$,j,L):J.state.wrap===2&&(J.adler=c(J.adler,$,j,L)),J.next_in+=j,J.total_in+=j,j),g.lookahead+=G,g.lookahead+g.insert>=C)for(b=g.strstart-g.insert,g.ins_h=g.window[b],g.ins_h=(g.ins_h<<g.hash_shift^g.window[b+1])&g.hash_mask;g.insert&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[b+C-1])&g.hash_mask,g.prev[b&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=b,b++,g.insert--,!(g.lookahead+g.insert<C)););}while(g.lookahead<z&&g.strm.avail_in!==0)}function he(g,q){for(var G,k;;){if(g.lookahead<z){if(ce(g),g.lookahead<z&&q===h)return y;if(g.lookahead===0)break}if(G=0,g.lookahead>=C&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+C-1])&g.hash_mask,G=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),G!==0&&g.strstart-G<=g.w_size-z&&(g.match_length=Y(g,G)),g.match_length>=C)if(k=u._tr_tally(g,g.strstart-g.match_start,g.match_length-C),g.lookahead-=g.match_length,g.match_length<=g.max_lazy_match&&g.lookahead>=C){for(g.match_length--;g.strstart++,g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+C-1])&g.hash_mask,G=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart,--g.match_length!=0;);g.strstart++}else g.strstart+=g.match_length,g.match_length=0,g.ins_h=g.window[g.strstart],g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+1])&g.hash_mask;else k=u._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++;if(k&&(N(g,!1),g.strm.avail_out===0))return y}return g.insert=g.strstart<C-1?g.strstart:C-1,q===p?(N(g,!0),g.strm.avail_out===0?te:F):g.last_lit&&(N(g,!1),g.strm.avail_out===0)?y:O}function re(g,q){for(var G,k,I;;){if(g.lookahead<z){if(ce(g),g.lookahead<z&&q===h)return y;if(g.lookahead===0)break}if(G=0,g.lookahead>=C&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+C-1])&g.hash_mask,G=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),g.prev_length=g.match_length,g.prev_match=g.match_start,g.match_length=C-1,G!==0&&g.prev_length<g.max_lazy_match&&g.strstart-G<=g.w_size-z&&(g.match_length=Y(g,G),g.match_length<=5&&(g.strategy===1||g.match_length===C&&4096<g.strstart-g.match_start)&&(g.match_length=C-1)),g.prev_length>=C&&g.match_length<=g.prev_length){for(I=g.strstart+g.lookahead-C,k=u._tr_tally(g,g.strstart-1-g.prev_match,g.prev_length-C),g.lookahead-=g.prev_length-1,g.prev_length-=2;++g.strstart<=I&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+C-1])&g.hash_mask,G=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),--g.prev_length!=0;);if(g.match_available=0,g.match_length=C-1,g.strstart++,k&&(N(g,!1),g.strm.avail_out===0))return y}else if(g.match_available){if((k=u._tr_tally(g,0,g.window[g.strstart-1]))&&N(g,!1),g.strstart++,g.lookahead--,g.strm.avail_out===0)return y}else g.match_available=1,g.strstart++,g.lookahead--}return g.match_available&&(k=u._tr_tally(g,0,g.window[g.strstart-1]),g.match_available=0),g.insert=g.strstart<C-1?g.strstart:C-1,q===p?(N(g,!0),g.strm.avail_out===0?te:F):g.last_lit&&(N(g,!1),g.strm.avail_out===0)?y:O}function X(g,q,G,k,I){this.good_length=g,this.max_lazy=q,this.nice_length=G,this.max_chain=k,this.func=I}function ae(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*U),this.dyn_dtree=new l.Buf16(2*(2*x+1)),this.bl_tree=new l.Buf16(2*(2*B+1)),ie(this.dyn_ltree),ie(this.dyn_dtree),ie(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(A+1),this.heap=new l.Buf16(2*P+1),ie(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*P+1),ie(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function le(g){var q;return g&&g.state?(g.total_in=g.total_out=0,g.data_type=E,(q=g.state).pending=0,q.pending_out=0,q.wrap<0&&(q.wrap=-q.wrap),q.status=q.wrap?w:D,g.adler=q.wrap===2?0:1,q.last_flush=h,u._tr_init(q),m):ne(g,T)}function ge(g){var q=le(g);return q===m&&(function(G){G.window_size=2*G.w_size,ie(G.head),G.max_lazy_match=s[G.level].max_lazy,G.good_match=s[G.level].good_length,G.nice_match=s[G.level].nice_length,G.max_chain_length=s[G.level].max_chain,G.strstart=0,G.block_start=0,G.lookahead=0,G.insert=0,G.match_length=G.prev_length=C-1,G.match_available=0,G.ins_h=0})(g.state),q}function fe(g,q,G,k,I,b){if(!g)return T;var J=1;if(q===v&&(q=6),k<0?(J=0,k=-k):15<k&&(J=2,k-=16),I<1||R<I||G!==S||k<8||15<k||q<0||9<q||b<0||_<b)return ne(g,T);k===8&&(k=9);var $=new ae;return(g.state=$).strm=g,$.wrap=J,$.gzhead=null,$.w_bits=k,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=I+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+C-1)/C),$.window=new l.Buf8(2*$.w_size),$.head=new l.Buf16($.hash_size),$.prev=new l.Buf16($.w_size),$.lit_bufsize=1<<I+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new l.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=q,$.strategy=b,$.method=G,ge(g)}s=[new X(0,0,0,0,function(g,q){var G=65535;for(G>g.pending_buf_size-5&&(G=g.pending_buf_size-5);;){if(g.lookahead<=1){if(ce(g),g.lookahead===0&&q===h)return y;if(g.lookahead===0)break}g.strstart+=g.lookahead,g.lookahead=0;var k=g.block_start+G;if((g.strstart===0||g.strstart>=k)&&(g.lookahead=g.strstart-k,g.strstart=k,N(g,!1),g.strm.avail_out===0)||g.strstart-g.block_start>=g.w_size-z&&(N(g,!1),g.strm.avail_out===0))return y}return g.insert=0,q===p?(N(g,!0),g.strm.avail_out===0?te:F):(g.strstart>g.block_start&&(N(g,!1),g.strm.avail_out),y)}),new X(4,4,8,4,he),new X(4,5,16,8,he),new X(4,6,32,32,he),new X(4,4,16,16,re),new X(8,16,32,32,re),new X(8,16,128,128,re),new X(8,32,128,256,re),new X(32,128,258,1024,re),new X(32,258,258,4096,re)],i.deflateInit=function(g,q){return fe(g,q,S,15,8,0)},i.deflateInit2=fe,i.deflateReset=ge,i.deflateResetKeep=le,i.deflateSetHeader=function(g,q){return g&&g.state?g.state.wrap!==2?T:(g.state.gzhead=q,m):T},i.deflate=function(g,q){var G,k,I,b;if(!g||!g.state||5<q||q<0)return g?ne(g,T):T;if(k=g.state,!g.output||!g.input&&g.avail_in!==0||k.status===666&&q!==p)return ne(g,g.avail_out===0?-5:T);if(k.strm=g,G=k.last_flush,k.last_flush=q,k.status===w)if(k.wrap===2)g.adler=0,Q(k,31),Q(k,139),Q(k,8),k.gzhead?(Q(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),Q(k,255&k.gzhead.time),Q(k,k.gzhead.time>>8&255),Q(k,k.gzhead.time>>16&255),Q(k,k.gzhead.time>>24&255),Q(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),Q(k,255&k.gzhead.os),k.gzhead.extra&&k.gzhead.extra.length&&(Q(k,255&k.gzhead.extra.length),Q(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(g.adler=c(g.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(Q(k,0),Q(k,0),Q(k,0),Q(k,0),Q(k,0),Q(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),Q(k,3),k.status=D);else{var J=S+(k.w_bits-8<<4)<<8;J|=(2<=k.strategy||k.level<2?0:k.level<6?1:k.level===6?2:3)<<6,k.strstart!==0&&(J|=32),J+=31-J%31,k.status=D,Z(k,J),k.strstart!==0&&(Z(k,g.adler>>>16),Z(k,65535&g.adler)),g.adler=1}if(k.status===69)if(k.gzhead.extra){for(I=k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>I&&(g.adler=c(g.adler,k.pending_buf,k.pending-I,I)),V(g),I=k.pending,k.pending!==k.pending_buf_size));)Q(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>I&&(g.adler=c(g.adler,k.pending_buf,k.pending-I,I)),k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(k.status===73)if(k.gzhead.name){I=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>I&&(g.adler=c(g.adler,k.pending_buf,k.pending-I,I)),V(g),I=k.pending,k.pending===k.pending_buf_size)){b=1;break}b=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0,Q(k,b)}while(b!==0);k.gzhead.hcrc&&k.pending>I&&(g.adler=c(g.adler,k.pending_buf,k.pending-I,I)),b===0&&(k.gzindex=0,k.status=91)}else k.status=91;if(k.status===91)if(k.gzhead.comment){I=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>I&&(g.adler=c(g.adler,k.pending_buf,k.pending-I,I)),V(g),I=k.pending,k.pending===k.pending_buf_size)){b=1;break}b=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0,Q(k,b)}while(b!==0);k.gzhead.hcrc&&k.pending>I&&(g.adler=c(g.adler,k.pending_buf,k.pending-I,I)),b===0&&(k.status=103)}else k.status=103;if(k.status===103&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&V(g),k.pending+2<=k.pending_buf_size&&(Q(k,255&g.adler),Q(k,g.adler>>8&255),g.adler=0,k.status=D)):k.status=D),k.pending!==0){if(V(g),g.avail_out===0)return k.last_flush=-1,m}else if(g.avail_in===0&&H(q)<=H(G)&&q!==p)return ne(g,-5);if(k.status===666&&g.avail_in!==0)return ne(g,-5);if(g.avail_in!==0||k.lookahead!==0||q!==h&&k.status!==666){var $=k.strategy===2?(function(L,K){for(var j;;){if(L.lookahead===0&&(ce(L),L.lookahead===0)){if(K===h)return y;break}if(L.match_length=0,j=u._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,j&&(N(L,!1),L.strm.avail_out===0))return y}return L.insert=0,K===p?(N(L,!0),L.strm.avail_out===0?te:F):L.last_lit&&(N(L,!1),L.strm.avail_out===0)?y:O})(k,q):k.strategy===3?(function(L,K){for(var j,W,oe,pe,de=L.window;;){if(L.lookahead<=M){if(ce(L),L.lookahead<=M&&K===h)return y;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=C&&0<L.strstart&&(W=de[oe=L.strstart-1])===de[++oe]&&W===de[++oe]&&W===de[++oe]){pe=L.strstart+M;do;while(W===de[++oe]&&W===de[++oe]&&W===de[++oe]&&W===de[++oe]&&W===de[++oe]&&W===de[++oe]&&W===de[++oe]&&W===de[++oe]&&oe<pe);L.match_length=M-(pe-oe),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=C?(j=u._tr_tally(L,1,L.match_length-C),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(j=u._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),j&&(N(L,!1),L.strm.avail_out===0))return y}return L.insert=0,K===p?(N(L,!0),L.strm.avail_out===0?te:F):L.last_lit&&(N(L,!1),L.strm.avail_out===0)?y:O})(k,q):s[k.level].func(k,q);if($!==te&&$!==F||(k.status=666),$===y||$===te)return g.avail_out===0&&(k.last_flush=-1),m;if($===O&&(q===1?u._tr_align(k):q!==5&&(u._tr_stored_block(k,0,0,!1),q===3&&(ie(k.head),k.lookahead===0&&(k.strstart=0,k.block_start=0,k.insert=0))),V(g),g.avail_out===0))return k.last_flush=-1,m}return q!==p?m:k.wrap<=0?1:(k.wrap===2?(Q(k,255&g.adler),Q(k,g.adler>>8&255),Q(k,g.adler>>16&255),Q(k,g.adler>>24&255),Q(k,255&g.total_in),Q(k,g.total_in>>8&255),Q(k,g.total_in>>16&255),Q(k,g.total_in>>24&255)):(Z(k,g.adler>>>16),Z(k,65535&g.adler)),V(g),0<k.wrap&&(k.wrap=-k.wrap),k.pending!==0?m:1)},i.deflateEnd=function(g){var q;return g&&g.state?(q=g.state.status)!==w&&q!==69&&q!==73&&q!==91&&q!==103&&q!==D&&q!==666?ne(g,T):(g.state=null,q===D?ne(g,-3):m):T},i.deflateSetDictionary=function(g,q){var G,k,I,b,J,$,L,K,j=q.length;if(!g||!g.state||(b=(G=g.state).wrap)===2||b===1&&G.status!==w||G.lookahead)return T;for(b===1&&(g.adler=d(g.adler,q,j,0)),G.wrap=0,j>=G.w_size&&(b===0&&(ie(G.head),G.strstart=0,G.block_start=0,G.insert=0),K=new l.Buf8(G.w_size),l.arraySet(K,q,j-G.w_size,G.w_size,0),q=K,j=G.w_size),J=g.avail_in,$=g.next_in,L=g.input,g.avail_in=j,g.next_in=0,g.input=q,ce(G);G.lookahead>=C;){for(k=G.strstart,I=G.lookahead-(C-1);G.ins_h=(G.ins_h<<G.hash_shift^G.window[k+C-1])&G.hash_mask,G.prev[k&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=k,k++,--I;);G.strstart=k,G.lookahead=C-1,ce(G)}return G.strstart+=G.lookahead,G.block_start=G.strstart,G.insert=G.lookahead,G.lookahead=0,G.match_length=G.prev_length=C-1,G.match_available=0,g.next_in=$,g.input=L,g.avail_in=J,G.wrap=b,m},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,o,i){o.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,o,i){o.exports=function(s,l){var u,d,c,f,h,p,m,T,v,_,E,S,R,P,x,B,U,A,C,M,z,w,D,y,O;u=s.state,d=s.next_in,y=s.input,c=d+(s.avail_in-5),f=s.next_out,O=s.output,h=f-(l-s.avail_out),p=f+(s.avail_out-257),m=u.dmax,T=u.wsize,v=u.whave,_=u.wnext,E=u.window,S=u.hold,R=u.bits,P=u.lencode,x=u.distcode,B=(1<<u.lenbits)-1,U=(1<<u.distbits)-1;e:do{R<15&&(S+=y[d++]<<R,R+=8,S+=y[d++]<<R,R+=8),A=P[S&B];t:for(;;){if(S>>>=C=A>>>24,R-=C,(C=A>>>16&255)===0)O[f++]=65535&A;else{if(!(16&C)){if((64&C)==0){A=P[(65535&A)+(S&(1<<C)-1)];continue t}if(32&C){u.mode=12;break e}s.msg="invalid literal/length code",u.mode=30;break e}M=65535&A,(C&=15)&&(R<C&&(S+=y[d++]<<R,R+=8),M+=S&(1<<C)-1,S>>>=C,R-=C),R<15&&(S+=y[d++]<<R,R+=8,S+=y[d++]<<R,R+=8),A=x[S&U];n:for(;;){if(S>>>=C=A>>>24,R-=C,!(16&(C=A>>>16&255))){if((64&C)==0){A=x[(65535&A)+(S&(1<<C)-1)];continue n}s.msg="invalid distance code",u.mode=30;break e}if(z=65535&A,R<(C&=15)&&(S+=y[d++]<<R,(R+=8)<C&&(S+=y[d++]<<R,R+=8)),m<(z+=S&(1<<C)-1)){s.msg="invalid distance too far back",u.mode=30;break e}if(S>>>=C,R-=C,(C=f-h)<z){if(v<(C=z-C)&&u.sane){s.msg="invalid distance too far back",u.mode=30;break e}if(D=E,(w=0)===_){if(w+=T-C,C<M){for(M-=C;O[f++]=E[w++],--C;);w=f-z,D=O}}else if(_<C){if(w+=T+_-C,(C-=_)<M){for(M-=C;O[f++]=E[w++],--C;);if(w=0,_<M){for(M-=C=_;O[f++]=E[w++],--C;);w=f-z,D=O}}}else if(w+=_-C,C<M){for(M-=C;O[f++]=E[w++],--C;);w=f-z,D=O}for(;2<M;)O[f++]=D[w++],O[f++]=D[w++],O[f++]=D[w++],M-=3;M&&(O[f++]=D[w++],1<M&&(O[f++]=D[w++]))}else{for(w=f-z;O[f++]=O[w++],O[f++]=O[w++],O[f++]=O[w++],2<(M-=3););M&&(O[f++]=O[w++],1<M&&(O[f++]=O[w++]))}break}}break}}while(d<c&&f<p);d-=M=R>>3,S&=(1<<(R-=M<<3))-1,s.next_in=d,s.next_out=f,s.avail_in=d<c?c-d+5:5-(d-c),s.avail_out=f<p?p-f+257:257-(f-p),u.hold=S,u.bits=R}},{}],49:[function(n,o,i){var s=n("../utils/common"),l=n("./adler32"),u=n("./crc32"),d=n("./inffast"),c=n("./inftrees"),f=1,h=2,p=0,m=-2,T=1,v=852,_=592;function E(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function R(w){var D;return w&&w.state?(D=w.state,w.total_in=w.total_out=D.total=0,w.msg="",D.wrap&&(w.adler=1&D.wrap),D.mode=T,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new s.Buf32(v),D.distcode=D.distdyn=new s.Buf32(_),D.sane=1,D.back=-1,p):m}function P(w){var D;return w&&w.state?((D=w.state).wsize=0,D.whave=0,D.wnext=0,R(w)):m}function x(w,D){var y,O;return w&&w.state?(O=w.state,D<0?(y=0,D=-D):(y=1+(D>>4),D<48&&(D&=15)),D&&(D<8||15<D)?m:(O.window!==null&&O.wbits!==D&&(O.window=null),O.wrap=y,O.wbits=D,P(w))):m}function B(w,D){var y,O;return w?(O=new S,(w.state=O).window=null,(y=x(w,D))!==p&&(w.state=null),y):m}var U,A,C=!0;function M(w){if(C){var D;for(U=new s.Buf32(512),A=new s.Buf32(32),D=0;D<144;)w.lens[D++]=8;for(;D<256;)w.lens[D++]=9;for(;D<280;)w.lens[D++]=7;for(;D<288;)w.lens[D++]=8;for(c(f,w.lens,0,288,U,0,w.work,{bits:9}),D=0;D<32;)w.lens[D++]=5;c(h,w.lens,0,32,A,0,w.work,{bits:5}),C=!1}w.lencode=U,w.lenbits=9,w.distcode=A,w.distbits=5}function z(w,D,y,O){var te,F=w.state;return F.window===null&&(F.wsize=1<<F.wbits,F.wnext=0,F.whave=0,F.window=new s.Buf8(F.wsize)),O>=F.wsize?(s.arraySet(F.window,D,y-F.wsize,F.wsize,0),F.wnext=0,F.whave=F.wsize):(O<(te=F.wsize-F.wnext)&&(te=O),s.arraySet(F.window,D,y-O,te,F.wnext),(O-=te)?(s.arraySet(F.window,D,y-O,O,0),F.wnext=O,F.whave=F.wsize):(F.wnext+=te,F.wnext===F.wsize&&(F.wnext=0),F.whave<F.wsize&&(F.whave+=te))),0}i.inflateReset=P,i.inflateReset2=x,i.inflateResetKeep=R,i.inflateInit=function(w){return B(w,15)},i.inflateInit2=B,i.inflate=function(w,D){var y,O,te,F,ne,H,ie,V,N,Q,Z,Y,ce,he,re,X,ae,le,ge,fe,g,q,G,k,I=0,b=new s.Buf8(4),J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&w.avail_in!==0)return m;(y=w.state).mode===12&&(y.mode=13),ne=w.next_out,te=w.output,ie=w.avail_out,F=w.next_in,O=w.input,H=w.avail_in,V=y.hold,N=y.bits,Q=H,Z=ie,q=p;e:for(;;)switch(y.mode){case T:if(y.wrap===0){y.mode=13;break}for(;N<16;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if(2&y.wrap&&V===35615){b[y.check=0]=255&V,b[1]=V>>>8&255,y.check=u(y.check,b,2,0),N=V=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&V)<<8)+(V>>8))%31){w.msg="incorrect header check",y.mode=30;break}if((15&V)!=8){w.msg="unknown compression method",y.mode=30;break}if(N-=4,g=8+(15&(V>>>=4)),y.wbits===0)y.wbits=g;else if(g>y.wbits){w.msg="invalid window size",y.mode=30;break}y.dmax=1<<g,w.adler=y.check=1,y.mode=512&V?10:12,N=V=0;break;case 2:for(;N<16;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if(y.flags=V,(255&y.flags)!=8){w.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){w.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=V>>8&1),512&y.flags&&(b[0]=255&V,b[1]=V>>>8&255,y.check=u(y.check,b,2,0)),N=V=0,y.mode=3;case 3:for(;N<32;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}y.head&&(y.head.time=V),512&y.flags&&(b[0]=255&V,b[1]=V>>>8&255,b[2]=V>>>16&255,b[3]=V>>>24&255,y.check=u(y.check,b,4,0)),N=V=0,y.mode=4;case 4:for(;N<16;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}y.head&&(y.head.xflags=255&V,y.head.os=V>>8),512&y.flags&&(b[0]=255&V,b[1]=V>>>8&255,y.check=u(y.check,b,2,0)),N=V=0,y.mode=5;case 5:if(1024&y.flags){for(;N<16;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}y.length=V,y.head&&(y.head.extra_len=V),512&y.flags&&(b[0]=255&V,b[1]=V>>>8&255,y.check=u(y.check,b,2,0)),N=V=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&(H<(Y=y.length)&&(Y=H),Y&&(y.head&&(g=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),s.arraySet(y.head.extra,O,F,Y,g)),512&y.flags&&(y.check=u(y.check,O,Y,F)),H-=Y,F+=Y,y.length-=Y),y.length))break e;y.length=0,y.mode=7;case 7:if(2048&y.flags){if(H===0)break e;for(Y=0;g=O[F+Y++],y.head&&g&&y.length<65536&&(y.head.name+=String.fromCharCode(g)),g&&Y<H;);if(512&y.flags&&(y.check=u(y.check,O,Y,F)),H-=Y,F+=Y,g)break e}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if(H===0)break e;for(Y=0;g=O[F+Y++],y.head&&g&&y.length<65536&&(y.head.comment+=String.fromCharCode(g)),g&&Y<H;);if(512&y.flags&&(y.check=u(y.check,O,Y,F)),H-=Y,F+=Y,g)break e}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;N<16;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if(V!==(65535&y.check)){w.msg="header crc mismatch",y.mode=30;break}N=V=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),w.adler=y.check=0,y.mode=12;break;case 10:for(;N<32;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}w.adler=y.check=E(V),N=V=0,y.mode=11;case 11:if(y.havedict===0)return w.next_out=ne,w.avail_out=ie,w.next_in=F,w.avail_in=H,y.hold=V,y.bits=N,2;w.adler=y.check=1,y.mode=12;case 12:if(D===5||D===6)break e;case 13:if(y.last){V>>>=7&N,N-=7&N,y.mode=27;break}for(;N<3;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}switch(y.last=1&V,N-=1,3&(V>>>=1)){case 0:y.mode=14;break;case 1:if(M(y),y.mode=20,D!==6)break;V>>>=2,N-=2;break e;case 2:y.mode=17;break;case 3:w.msg="invalid block type",y.mode=30}V>>>=2,N-=2;break;case 14:for(V>>>=7&N,N-=7&N;N<32;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if((65535&V)!=(V>>>16^65535)){w.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&V,N=V=0,y.mode=15,D===6)break e;case 15:y.mode=16;case 16:if(Y=y.length){if(H<Y&&(Y=H),ie<Y&&(Y=ie),Y===0)break e;s.arraySet(te,O,F,Y,ne),H-=Y,F+=Y,ie-=Y,ne+=Y,y.length-=Y;break}y.mode=12;break;case 17:for(;N<14;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if(y.nlen=257+(31&V),V>>>=5,N-=5,y.ndist=1+(31&V),V>>>=5,N-=5,y.ncode=4+(15&V),V>>>=4,N-=4,286<y.nlen||30<y.ndist){w.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;N<3;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}y.lens[J[y.have++]]=7&V,V>>>=3,N-=3}for(;y.have<19;)y.lens[J[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,G={bits:y.lenbits},q=c(0,y.lens,0,19,y.lencode,0,y.work,G),y.lenbits=G.bits,q){w.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;X=(I=y.lencode[V&(1<<y.lenbits)-1])>>>16&255,ae=65535&I,!((re=I>>>24)<=N);){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if(ae<16)V>>>=re,N-=re,y.lens[y.have++]=ae;else{if(ae===16){for(k=re+2;N<k;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if(V>>>=re,N-=re,y.have===0){w.msg="invalid bit length repeat",y.mode=30;break}g=y.lens[y.have-1],Y=3+(3&V),V>>>=2,N-=2}else if(ae===17){for(k=re+3;N<k;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}N-=re,g=0,Y=3+(7&(V>>>=re)),V>>>=3,N-=3}else{for(k=re+7;N<k;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}N-=re,g=0,Y=11+(127&(V>>>=re)),V>>>=7,N-=7}if(y.have+Y>y.nlen+y.ndist){w.msg="invalid bit length repeat",y.mode=30;break}for(;Y--;)y.lens[y.have++]=g}}if(y.mode===30)break;if(y.lens[256]===0){w.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,G={bits:y.lenbits},q=c(f,y.lens,0,y.nlen,y.lencode,0,y.work,G),y.lenbits=G.bits,q){w.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,G={bits:y.distbits},q=c(h,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,G),y.distbits=G.bits,q){w.msg="invalid distances set",y.mode=30;break}if(y.mode=20,D===6)break e;case 20:y.mode=21;case 21:if(6<=H&&258<=ie){w.next_out=ne,w.avail_out=ie,w.next_in=F,w.avail_in=H,y.hold=V,y.bits=N,d(w,Z),ne=w.next_out,te=w.output,ie=w.avail_out,F=w.next_in,O=w.input,H=w.avail_in,V=y.hold,N=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;X=(I=y.lencode[V&(1<<y.lenbits)-1])>>>16&255,ae=65535&I,!((re=I>>>24)<=N);){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if(X&&(240&X)==0){for(le=re,ge=X,fe=ae;X=(I=y.lencode[fe+((V&(1<<le+ge)-1)>>le)])>>>16&255,ae=65535&I,!(le+(re=I>>>24)<=N);){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}V>>>=le,N-=le,y.back+=le}if(V>>>=re,N-=re,y.back+=re,y.length=ae,X===0){y.mode=26;break}if(32&X){y.back=-1,y.mode=12;break}if(64&X){w.msg="invalid literal/length code",y.mode=30;break}y.extra=15&X,y.mode=22;case 22:if(y.extra){for(k=y.extra;N<k;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}y.length+=V&(1<<y.extra)-1,V>>>=y.extra,N-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;X=(I=y.distcode[V&(1<<y.distbits)-1])>>>16&255,ae=65535&I,!((re=I>>>24)<=N);){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if((240&X)==0){for(le=re,ge=X,fe=ae;X=(I=y.distcode[fe+((V&(1<<le+ge)-1)>>le)])>>>16&255,ae=65535&I,!(le+(re=I>>>24)<=N);){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}V>>>=le,N-=le,y.back+=le}if(V>>>=re,N-=re,y.back+=re,64&X){w.msg="invalid distance code",y.mode=30;break}y.offset=ae,y.extra=15&X,y.mode=24;case 24:if(y.extra){for(k=y.extra;N<k;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}y.offset+=V&(1<<y.extra)-1,V>>>=y.extra,N-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){w.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(ie===0)break e;if(Y=Z-ie,y.offset>Y){if((Y=y.offset-Y)>y.whave&&y.sane){w.msg="invalid distance too far back",y.mode=30;break}ce=Y>y.wnext?(Y-=y.wnext,y.wsize-Y):y.wnext-Y,Y>y.length&&(Y=y.length),he=y.window}else he=te,ce=ne-y.offset,Y=y.length;for(ie<Y&&(Y=ie),ie-=Y,y.length-=Y;te[ne++]=he[ce++],--Y;);y.length===0&&(y.mode=21);break;case 26:if(ie===0)break e;te[ne++]=y.length,ie--,y.mode=21;break;case 27:if(y.wrap){for(;N<32;){if(H===0)break e;H--,V|=O[F++]<<N,N+=8}if(Z-=ie,w.total_out+=Z,y.total+=Z,Z&&(w.adler=y.check=y.flags?u(y.check,te,Z,ne-Z):l(y.check,te,Z,ne-Z)),Z=ie,(y.flags?V:E(V))!==y.check){w.msg="incorrect data check",y.mode=30;break}N=V=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;N<32;){if(H===0)break e;H--,V+=O[F++]<<N,N+=8}if(V!==(4294967295&y.total)){w.msg="incorrect length check",y.mode=30;break}N=V=0}y.mode=29;case 29:q=1;break e;case 30:q=-3;break e;case 31:return-4;case 32:default:return m}return w.next_out=ne,w.avail_out=ie,w.next_in=F,w.avail_in=H,y.hold=V,y.bits=N,(y.wsize||Z!==w.avail_out&&y.mode<30&&(y.mode<27||D!==4))&&z(w,w.output,w.next_out,Z-w.avail_out)?(y.mode=31,-4):(Q-=w.avail_in,Z-=w.avail_out,w.total_in+=Q,w.total_out+=Z,y.total+=Z,y.wrap&&Z&&(w.adler=y.check=y.flags?u(y.check,te,Z,w.next_out-Z):l(y.check,te,Z,w.next_out-Z)),w.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(Q==0&&Z===0||D===4)&&q===p&&(q=-5),q)},i.inflateEnd=function(w){if(!w||!w.state)return m;var D=w.state;return D.window&&(D.window=null),w.state=null,p},i.inflateGetHeader=function(w,D){var y;return w&&w.state?(2&(y=w.state).wrap)==0?m:((y.head=D).done=!1,p):m},i.inflateSetDictionary=function(w,D){var y,O=D.length;return w&&w.state?(y=w.state).wrap!==0&&y.mode!==11?m:y.mode===11&&l(1,D,O,0)!==y.check?-3:z(w,D,O,O)?(y.mode=31,-4):(y.havedict=1,p):m},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,o,i){var s=n("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];o.exports=function(f,h,p,m,T,v,_,E){var S,R,P,x,B,U,A,C,M,z=E.bits,w=0,D=0,y=0,O=0,te=0,F=0,ne=0,H=0,ie=0,V=0,N=null,Q=0,Z=new s.Buf16(16),Y=new s.Buf16(16),ce=null,he=0;for(w=0;w<=15;w++)Z[w]=0;for(D=0;D<m;D++)Z[h[p+D]]++;for(te=z,O=15;1<=O&&Z[O]===0;O--);if(O<te&&(te=O),O===0)return T[v++]=20971520,T[v++]=20971520,E.bits=1,0;for(y=1;y<O&&Z[y]===0;y++);for(te<y&&(te=y),w=H=1;w<=15;w++)if(H<<=1,(H-=Z[w])<0)return-1;if(0<H&&(f===0||O!==1))return-1;for(Y[1]=0,w=1;w<15;w++)Y[w+1]=Y[w]+Z[w];for(D=0;D<m;D++)h[p+D]!==0&&(_[Y[h[p+D]]++]=D);if(U=f===0?(N=ce=_,19):f===1?(N=l,Q-=257,ce=u,he-=257,256):(N=d,ce=c,-1),w=y,B=v,ne=D=V=0,P=-1,x=(ie=1<<(F=te))-1,f===1&&852<ie||f===2&&592<ie)return 1;for(;;){for(A=w-ne,M=_[D]<U?(C=0,_[D]):_[D]>U?(C=ce[he+_[D]],N[Q+_[D]]):(C=96,0),S=1<<w-ne,y=R=1<<F;T[B+(V>>ne)+(R-=S)]=A<<24|C<<16|M|0,R!==0;);for(S=1<<w-1;V&S;)S>>=1;if(S!==0?(V&=S-1,V+=S):V=0,D++,--Z[w]==0){if(w===O)break;w=h[p+_[D]]}if(te<w&&(V&x)!==P){for(ne===0&&(ne=te),B+=y,H=1<<(F=w-ne);F+ne<O&&!((H-=Z[F+ne])<=0);)F++,H<<=1;if(ie+=1<<F,f===1&&852<ie||f===2&&592<ie)return 1;T[P=V&x]=te<<24|F<<16|B-v|0}}return V!==0&&(T[B+V]=w-ne<<24|64<<16|0),E.bits=te,0}},{"../utils/common":41}],51:[function(n,o,i){o.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,o,i){var s=n("../utils/common"),l=0,u=1;function d(I){for(var b=I.length;0<=--b;)I[b]=0}var c=0,f=29,h=256,p=h+1+f,m=30,T=19,v=2*p+1,_=15,E=16,S=7,R=256,P=16,x=17,B=18,U=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(p+2));d(z);var w=new Array(2*m);d(w);var D=new Array(512);d(D);var y=new Array(256);d(y);var O=new Array(f);d(O);var te,F,ne,H=new Array(m);function ie(I,b,J,$,L){this.static_tree=I,this.extra_bits=b,this.extra_base=J,this.elems=$,this.max_length=L,this.has_stree=I&&I.length}function V(I,b){this.dyn_tree=I,this.max_code=0,this.stat_desc=b}function N(I){return I<256?D[I]:D[256+(I>>>7)]}function Q(I,b){I.pending_buf[I.pending++]=255&b,I.pending_buf[I.pending++]=b>>>8&255}function Z(I,b,J){I.bi_valid>E-J?(I.bi_buf|=b<<I.bi_valid&65535,Q(I,I.bi_buf),I.bi_buf=b>>E-I.bi_valid,I.bi_valid+=J-E):(I.bi_buf|=b<<I.bi_valid&65535,I.bi_valid+=J)}function Y(I,b,J){Z(I,J[2*b],J[2*b+1])}function ce(I,b){for(var J=0;J|=1&I,I>>>=1,J<<=1,0<--b;);return J>>>1}function he(I,b,J){var $,L,K=new Array(_+1),j=0;for($=1;$<=_;$++)K[$]=j=j+J[$-1]<<1;for(L=0;L<=b;L++){var W=I[2*L+1];W!==0&&(I[2*L]=ce(K[W]++,W))}}function re(I){var b;for(b=0;b<p;b++)I.dyn_ltree[2*b]=0;for(b=0;b<m;b++)I.dyn_dtree[2*b]=0;for(b=0;b<T;b++)I.bl_tree[2*b]=0;I.dyn_ltree[2*R]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function X(I){8<I.bi_valid?Q(I,I.bi_buf):0<I.bi_valid&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function ae(I,b,J,$){var L=2*b,K=2*J;return I[L]<I[K]||I[L]===I[K]&&$[b]<=$[J]}function le(I,b,J){for(var $=I.heap[J],L=J<<1;L<=I.heap_len&&(L<I.heap_len&&ae(b,I.heap[L+1],I.heap[L],I.depth)&&L++,!ae(b,$,I.heap[L],I.depth));)I.heap[J]=I.heap[L],J=L,L<<=1;I.heap[J]=$}function ge(I,b,J){var $,L,K,j,W=0;if(I.last_lit!==0)for(;$=I.pending_buf[I.d_buf+2*W]<<8|I.pending_buf[I.d_buf+2*W+1],L=I.pending_buf[I.l_buf+W],W++,$===0?Y(I,L,b):(Y(I,(K=y[L])+h+1,b),(j=U[K])!==0&&Z(I,L-=O[K],j),Y(I,K=N(--$),J),(j=A[K])!==0&&Z(I,$-=H[K],j)),W<I.last_lit;);Y(I,R,b)}function fe(I,b){var J,$,L,K=b.dyn_tree,j=b.stat_desc.static_tree,W=b.stat_desc.has_stree,oe=b.stat_desc.elems,pe=-1;for(I.heap_len=0,I.heap_max=v,J=0;J<oe;J++)K[2*J]!==0?(I.heap[++I.heap_len]=pe=J,I.depth[J]=0):K[2*J+1]=0;for(;I.heap_len<2;)K[2*(L=I.heap[++I.heap_len]=pe<2?++pe:0)]=1,I.depth[L]=0,I.opt_len--,W&&(I.static_len-=j[2*L+1]);for(b.max_code=pe,J=I.heap_len>>1;1<=J;J--)le(I,K,J);for(L=oe;J=I.heap[1],I.heap[1]=I.heap[I.heap_len--],le(I,K,1),$=I.heap[1],I.heap[--I.heap_max]=J,I.heap[--I.heap_max]=$,K[2*L]=K[2*J]+K[2*$],I.depth[L]=(I.depth[J]>=I.depth[$]?I.depth[J]:I.depth[$])+1,K[2*J+1]=K[2*$+1]=L,I.heap[1]=L++,le(I,K,1),2<=I.heap_len;);I.heap[--I.heap_max]=I.heap[1],(function(de,_e){var Re,Ee,Te,ye,Se,qe,ke=_e.dyn_tree,tn=_e.max_code,Fi=_e.stat_desc.static_tree,Gi=_e.stat_desc.has_stree,Bi=_e.stat_desc.extra_bits,nn=_e.stat_desc.extra_base,Xe=_e.stat_desc.max_length,nt=0;for(ye=0;ye<=_;ye++)de.bl_count[ye]=0;for(ke[2*de.heap[de.heap_max]+1]=0,Re=de.heap_max+1;Re<v;Re++)Xe<(ye=ke[2*ke[2*(Ee=de.heap[Re])+1]+1]+1)&&(ye=Xe,nt++),ke[2*Ee+1]=ye,tn<Ee||(de.bl_count[ye]++,Se=0,nn<=Ee&&(Se=Bi[Ee-nn]),qe=ke[2*Ee],de.opt_len+=qe*(ye+Se),Gi&&(de.static_len+=qe*(Fi[2*Ee+1]+Se)));if(nt!==0){do{for(ye=Xe-1;de.bl_count[ye]===0;)ye--;de.bl_count[ye]--,de.bl_count[ye+1]+=2,de.bl_count[Xe]--,nt-=2}while(0<nt);for(ye=Xe;ye!==0;ye--)for(Ee=de.bl_count[ye];Ee!==0;)tn<(Te=de.heap[--Re])||(ke[2*Te+1]!==ye&&(de.opt_len+=(ye-ke[2*Te+1])*ke[2*Te],ke[2*Te+1]=ye),Ee--)}})(I,b),he(K,pe,I.bl_count)}function g(I,b,J){var $,L,K=-1,j=b[1],W=0,oe=7,pe=4;for(j===0&&(oe=138,pe=3),b[2*(J+1)+1]=65535,$=0;$<=J;$++)L=j,j=b[2*($+1)+1],++W<oe&&L===j||(W<pe?I.bl_tree[2*L]+=W:L!==0?(L!==K&&I.bl_tree[2*L]++,I.bl_tree[2*P]++):W<=10?I.bl_tree[2*x]++:I.bl_tree[2*B]++,K=L,pe=(W=0)===j?(oe=138,3):L===j?(oe=6,3):(oe=7,4))}function q(I,b,J){var $,L,K=-1,j=b[1],W=0,oe=7,pe=4;for(j===0&&(oe=138,pe=3),$=0;$<=J;$++)if(L=j,j=b[2*($+1)+1],!(++W<oe&&L===j)){if(W<pe)for(;Y(I,L,I.bl_tree),--W!=0;);else L!==0?(L!==K&&(Y(I,L,I.bl_tree),W--),Y(I,P,I.bl_tree),Z(I,W-3,2)):W<=10?(Y(I,x,I.bl_tree),Z(I,W-3,3)):(Y(I,B,I.bl_tree),Z(I,W-11,7));K=L,pe=(W=0)===j?(oe=138,3):L===j?(oe=6,3):(oe=7,4)}}d(H);var G=!1;function k(I,b,J,$){Z(I,(c<<1)+($?1:0),3),(function(L,K,j,W){X(L),Q(L,j),Q(L,~j),s.arraySet(L.pending_buf,L.window,K,j,L.pending),L.pending+=j})(I,b,J)}i._tr_init=function(I){G||((function(){var b,J,$,L,K,j=new Array(_+1);for(L=$=0;L<f-1;L++)for(O[L]=$,b=0;b<1<<U[L];b++)y[$++]=L;for(y[$-1]=L,L=K=0;L<16;L++)for(H[L]=K,b=0;b<1<<A[L];b++)D[K++]=L;for(K>>=7;L<m;L++)for(H[L]=K<<7,b=0;b<1<<A[L]-7;b++)D[256+K++]=L;for(J=0;J<=_;J++)j[J]=0;for(b=0;b<=143;)z[2*b+1]=8,b++,j[8]++;for(;b<=255;)z[2*b+1]=9,b++,j[9]++;for(;b<=279;)z[2*b+1]=7,b++,j[7]++;for(;b<=287;)z[2*b+1]=8,b++,j[8]++;for(he(z,p+1,j),b=0;b<m;b++)w[2*b+1]=5,w[2*b]=ce(b,5);te=new ie(z,U,h+1,p,_),F=new ie(w,A,0,m,_),ne=new ie(new Array(0),C,0,T,S)})(),G=!0),I.l_desc=new V(I.dyn_ltree,te),I.d_desc=new V(I.dyn_dtree,F),I.bl_desc=new V(I.bl_tree,ne),I.bi_buf=0,I.bi_valid=0,re(I)},i._tr_stored_block=k,i._tr_flush_block=function(I,b,J,$){var L,K,j=0;0<I.level?(I.strm.data_type===2&&(I.strm.data_type=(function(W){var oe,pe=4093624447;for(oe=0;oe<=31;oe++,pe>>>=1)if(1&pe&&W.dyn_ltree[2*oe]!==0)return l;if(W.dyn_ltree[18]!==0||W.dyn_ltree[20]!==0||W.dyn_ltree[26]!==0)return u;for(oe=32;oe<h;oe++)if(W.dyn_ltree[2*oe]!==0)return u;return l})(I)),fe(I,I.l_desc),fe(I,I.d_desc),j=(function(W){var oe;for(g(W,W.dyn_ltree,W.l_desc.max_code),g(W,W.dyn_dtree,W.d_desc.max_code),fe(W,W.bl_desc),oe=T-1;3<=oe&&W.bl_tree[2*M[oe]+1]===0;oe--);return W.opt_len+=3*(oe+1)+5+5+4,oe})(I),L=I.opt_len+3+7>>>3,(K=I.static_len+3+7>>>3)<=L&&(L=K)):L=K=J+5,J+4<=L&&b!==-1?k(I,b,J,$):I.strategy===4||K===L?(Z(I,2+($?1:0),3),ge(I,z,w)):(Z(I,4+($?1:0),3),(function(W,oe,pe,de){var _e;for(Z(W,oe-257,5),Z(W,pe-1,5),Z(W,de-4,4),_e=0;_e<de;_e++)Z(W,W.bl_tree[2*M[_e]+1],3);q(W,W.dyn_ltree,oe-1),q(W,W.dyn_dtree,pe-1)})(I,I.l_desc.max_code+1,I.d_desc.max_code+1,j+1),ge(I,I.dyn_ltree,I.dyn_dtree)),re(I),$&&X(I)},i._tr_tally=function(I,b,J){return I.pending_buf[I.d_buf+2*I.last_lit]=b>>>8&255,I.pending_buf[I.d_buf+2*I.last_lit+1]=255&b,I.pending_buf[I.l_buf+I.last_lit]=255&J,I.last_lit++,b===0?I.dyn_ltree[2*J]++:(I.matches++,b--,I.dyn_ltree[2*(y[J]+h+1)]++,I.dyn_dtree[2*N(b)]++),I.last_lit===I.lit_bufsize-1},i._tr_align=function(I){Z(I,2,3),Y(I,R,z),(function(b){b.bi_valid===16?(Q(b,b.bi_buf),b.bi_buf=0,b.bi_valid=0):8<=b.bi_valid&&(b.pending_buf[b.pending++]=255&b.bi_buf,b.bi_buf>>=8,b.bi_valid-=8)})(I)}},{"../utils/common":41}],53:[function(n,o,i){o.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,o,i){(function(s){(function(l,u){if(!l.setImmediate){var d,c,f,h,p=1,m={},T=!1,v=l.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(l);_=_&&_.setTimeout?_:l,d={}.toString.call(l.process)==="[object process]"?function(P){process.nextTick(function(){S(P)})}:(function(){if(l.postMessage&&!l.importScripts){var P=!0,x=l.onmessage;return l.onmessage=function(){P=!1},l.postMessage("","*"),l.onmessage=x,P}})()?(h="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",R,!1):l.attachEvent("onmessage",R),function(P){l.postMessage(h+P,"*")}):l.MessageChannel?((f=new MessageChannel).port1.onmessage=function(P){S(P.data)},function(P){f.port2.postMessage(P)}):v&&"onreadystatechange"in v.createElement("script")?(c=v.documentElement,function(P){var x=v.createElement("script");x.onreadystatechange=function(){S(P),x.onreadystatechange=null,c.removeChild(x),x=null},c.appendChild(x)}):function(P){setTimeout(S,0,P)},_.setImmediate=function(P){typeof P!="function"&&(P=new Function(""+P));for(var x=new Array(arguments.length-1),B=0;B<x.length;B++)x[B]=arguments[B+1];var U={callback:P,args:x};return m[p]=U,d(p),p++},_.clearImmediate=E}function E(P){delete m[P]}function S(P){if(T)setTimeout(S,0,P);else{var x=m[P];if(x){T=!0;try{(function(B){var U=B.callback,A=B.args;switch(A.length){case 0:U();break;case 1:U(A[0]);break;case 2:U(A[0],A[1]);break;case 3:U(A[0],A[1],A[2]);break;default:U.apply(u,A)}})(x)}finally{E(P),T=!1}}}}function R(P){P.source===l&&typeof P.data=="string"&&P.data.indexOf(h)===0&&S(+P.data.slice(h.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Ge<"u"?Ge:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Rt)),Rt.exports}var nf=tf();const of=bi(nf);var ft={exports:{}},rf=ft.exports,Vo;function sf(){return Vo||(Vo=1,(function(t,e){(function(n,o){o()})(rf,function(){function n(c,f){return typeof f>"u"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function o(c,f,h){var p=new XMLHttpRequest;p.open("GET",c),p.responseType="blob",p.onload=function(){d(p.response,f,h)},p.onerror=function(){console.error("could not download file")},p.send()}function i(c){var f=new XMLHttpRequest;f.open("HEAD",c,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(f)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ge=="object"&&Ge.global===Ge?Ge:void 0,u=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(c,f,h){var p=l.URL||l.webkitURL,m=document.createElement("a");f=f||c.name||"download",m.download=f,m.rel="noopener",typeof c=="string"?(m.href=c,m.origin===location.origin?s(m):i(m.href)?o(c,f,h):s(m,m.target="_blank")):(m.href=p.createObjectURL(c),setTimeout(function(){p.revokeObjectURL(m.href)},4e4),setTimeout(function(){s(m)},0))}:"msSaveOrOpenBlob"in navigator?function(c,f,h){if(f=f||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(n(c,h),f);else if(i(c))o(c,f,h);else{var p=document.createElement("a");p.href=c,p.target="_blank",setTimeout(function(){s(p)})}}:function(c,f,h,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof c=="string")return o(c,f,h);var m=c.type==="application/octet-stream",T=/constructor/i.test(l.HTMLElement)||l.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||m&&T||u)&&typeof FileReader<"u"){var _=new FileReader;_.onloadend=function(){var R=_.result;R=v?R:R.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=R:location=R,p=null},_.readAsDataURL(c)}else{var E=l.URL||l.webkitURL,S=E.createObjectURL(c);p?p.location=S:location.href=S,p=null,setTimeout(function(){E.revokeObjectURL(S)},4e4)}});l.saveAs=d.saveAs=d,t.exports=d})})(ft)),ft.exports}var Ui=sf();const ve={file:null,csvData:null,splitFiles:[],rowsPerFile:100},se={dropZone:document.getElementById("drop-zone"),fileInput:document.getElementById("file-input"),viewUpload:document.getElementById("view-upload"),viewWorkspace:document.getElementById("view-workspace"),fileName:document.getElementById("file-name"),fileStats:document.getElementById("file-stats"),previewHead:document.getElementById("preview-head"),previewBody:document.getElementById("preview-body"),inputRows:document.getElementById("input-rows"),estCount:document.getElementById("est-count"),btnSplit:document.getElementById("btn-split"),resultsCard:document.getElementById("results-card"),fileList:document.getElementById("file-list"),resultCount:document.getElementById("result-count"),btnDownloadAll:document.getElementById("btn-download-all"),btnReset:document.getElementById("btn-reset"),btnAnalyze:document.getElementById("btn-analyze"),aiLoading:document.getElementById("ai-loading"),aiResult:document.getElementById("ai-result"),aiPlaceholder:document.getElementById("ai-placeholder"),uploadError:document.getElementById("upload-error")};se.dropZone.addEventListener("dragover",t=>{t.preventDefault(),se.dropZone.classList.add("border-brand-500","bg-brand-50")});se.dropZone.addEventListener("dragleave",t=>{t.preventDefault(),se.dropZone.classList.remove("border-brand-500","bg-brand-50")});se.dropZone.addEventListener("drop",t=>{t.preventDefault(),se.dropZone.classList.remove("border-brand-500","bg-brand-50");const e=t.dataTransfer.files[0];Li(e)});se.dropZone.addEventListener("click",()=>se.fileInput.click());se.fileInput.addEventListener("change",t=>{t.target.files.length&&Li(t.target.files[0])});se.inputRows.addEventListener("input",t=>{const e=parseInt(t.target.value)||100;ve.rowsPerFile=e,en()});document.querySelectorAll(".preset-btn").forEach(t=>{t.addEventListener("click",()=>{const e=parseInt(t.dataset.val);ve.rowsPerFile=e,se.inputRows.value=e,en()})});se.btnSplit.addEventListener("click",lf);se.btnDownloadAll.addEventListener("click",df);se.btnReset.addEventListener("click",cf);se.btnAnalyze.addEventListener("click",ff);function Li(t){if(t){if(t.type!=="text/csv"&&!t.name.endsWith(".csv")){kt("Please upload a valid .csv file");return}ve.file=t,se.uploadError.classList.add("hidden"),Di.parse(t,{skipEmptyLines:!0,complete:e=>{if(e.data&&e.data.length>0){const n=e.data,o=n[0],i=n.slice(1);ve.csvData={header:o,rows:i,fileName:t.name},se.viewUpload.classList.add("hidden"),se.viewWorkspace.classList.remove("hidden"),af()}else kt("CSV file appears to be empty or invalid.")},error:e=>kt("Error parsing CSV: "+e.message)})}}function kt(t){se.uploadError.textContent=t,se.uploadError.classList.remove("hidden")}function af(){se.fileName.textContent=ve.csvData.fileName,se.fileStats.textContent=`${ve.csvData.rows.length.toLocaleString()} rows  ${ve.csvData.header.length} columns`,se.previewHead.innerHTML=`<tr>${ve.csvData.header.map(t=>`<th class="px-6 py-3 font-medium border-b">${t}</th>`).join("")}</tr>`,se.previewBody.innerHTML=ve.csvData.rows.slice(0,5).map(t=>`<tr class="border-b hover:bg-slate-50">${t.map(e=>`<td class="px-6 py-3 border-slate-50 max-w-xs truncate">${e}</td>`).join("")}</tr>`).join(""),en(),se.resultsCard.classList.add("opacity-50","pointer-events-none"),se.fileList.innerHTML='<div class="text-center py-8 text-slate-400"><p class="text-sm">Click "Split CSV" to generate files.</p></div>',se.resultCount.textContent="No files generated",se.aiResult.classList.add("hidden"),se.aiPlaceholder.classList.remove("hidden"),se.aiResult.innerHTML=""}function en(){if(!ve.csvData)return;const t=Math.ceil(ve.csvData.rows.length/ve.rowsPerFile);se.estCount.textContent=t.toLocaleString()}function lf(){if(!ve.csvData)return;const t=se.btnSplit.querySelector("span"),e=t.textContent;t.textContent="Processing...",se.btnSplit.disabled=!0,setTimeout(()=>{const{header:n,rows:o,fileName:i}=ve.csvData,s=[],l=Math.ceil(o.length/ve.rowsPerFile),u=i.replace(".csv","");for(let d=0;d<l;d++){const c=o.slice(d*ve.rowsPerFile,(d+1)*ve.rowsPerFile),f=Di.unparse([n,...c]),h=(d+1).toString().padStart(l.toString().length,"0"),p=`${u}_part_${h}.csv`;s.push({name:p,content:f,rowCount:c.length,size:new Blob([f]).size})}ve.splitFiles=s,uf(),t.textContent=e,se.btnSplit.disabled=!1},50)}function uf(){se.resultsCard.classList.remove("opacity-50","pointer-events-none"),se.resultCount.textContent=`${ve.splitFiles.length} files created`,se.fileList.innerHTML=ve.splitFiles.map((t,e)=>`
                <div class="flex items-center justify-between p-3 rounded-lg border border-slate-100 hover:border-brand-300 hover:bg-brand-50/50 transition-all bg-white group">
                    <div class="min-w-0 pr-2">
                        <p class="text-sm font-medium text-slate-700 truncate" title="${t.name}">${t.name}</p>
                        <p class="text-xs text-slate-500">${t.rowCount} rows  ${(t.size/1024).toFixed(1)} KB</p>
                    </div>
                    <button onclick="window.downloadSingle(${e})" class="p-2 text-slate-400 hover:text-brand-600 rounded hover:bg-brand-100 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                    </button>
                </div>
            `).join("")}window.downloadSingle=t=>{const e=ve.splitFiles[t],n=new Blob([e.content],{type:"text/csv;charset=utf-8;"});Ui.saveAs(n,e.name)};async function df(){if(ve.splitFiles.length===0)return;const t=new of;ve.splitFiles.forEach(o=>{t.file(o.name,o.content)});const e=await t.generateAsync({type:"blob"}),n=ve.csvData.fileName.replace(".csv","")+"_split.zip";Ui.saveAs(e,n)}function cf(){ve.file=null,ve.csvData=null,ve.splitFiles=[],se.fileInput.value="",se.viewWorkspace.classList.add("hidden"),se.viewUpload.classList.remove("hidden")}async function ff(){if(ve.csvData){se.aiLoading.classList.remove("hidden"),se.aiPlaceholder.classList.add("hidden"),se.btnAnalyze.disabled=!0,se.btnAnalyze.classList.add("opacity-50");try{throw new Error("API Key not found. Please configure process.env.API_KEY.")}catch(t){console.error(t),se.aiResult.innerHTML=`<p class="text-red-500">Analysis failed: ${t.message}</p>`,se.aiResult.classList.remove("hidden")}finally{se.aiLoading.classList.add("hidden"),se.btnAnalyze.disabled=!1,se.btnAnalyze.classList.remove("opacity-50")}}}
